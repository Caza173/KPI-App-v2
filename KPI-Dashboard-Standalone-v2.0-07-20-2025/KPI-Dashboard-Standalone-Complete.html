<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Estate KPI Dashboard - Standalone Edition v2.0</title>
    <meta name="description" content="Professional Real Estate KPI Dashboard - Track performance, manage properties, analyze deals, and optimize business efficiency">
    <meta name="author" content="Caza Real Estate Solutions">
    <meta name="version" content="2.0.0">
    <meta name="created" content="July 2025">
    
    <!-- React and Babel Libraries -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* Enhanced Professional Header */
        .app-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px 0;
            border-bottom: 3px solid transparent;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-clip: border-box;
            border-radius: 15px 15px 0 0;
            margin: -20px -20px 30px -20px;
            padding: 30px 20px;
            color: white;
        }
        
        .app-title {
            font-size: 2.8em;
            font-weight: 800;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            letter-spacing: -1px;
        }
        
        .app-subtitle {
            font-size: 1.2em;
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .app-version {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
            font-style: italic;
        }
        
        .download-notice {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            font-weight: 500;
            font-size: 0.95em;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }
        
        /* Light Theme (Default) */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            transition: all 0.3s ease;
            --wheel-bg: white;
            --wheel-text: #333;
        }
        
        /* Dark Theme */
        body.dark-theme {
            background-color: #1a1a1a;
            color: #e0e0e0;
            --wheel-bg: #333;
            --wheel-text: #e0e0e0;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .dark-theme .container {
            background: #2d2d2d;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        /* Theme Toggle Button */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .theme-toggle:hover {
            background: #0056b3;
            transform: scale(1.1);
        }
        
        .dark-theme .theme-toggle {
            background: #ffc107;
            color: #000;
        }
        
        .dark-theme .theme-toggle:hover {
            background: #ffca2c;
        }
        
        /* ROI Tile Special Styling */
        .roi-tile {
            background: linear-gradient(135deg, #e8f5e8, #d4edda) !important;
            border: 2px solid #28a745 !important;
        }
        
        .dark-theme .roi-tile {
            background: linear-gradient(135deg, #2d5a2d, #1e3a1e) !important;
            border: 2px solid #28a745 !important;
            color: #e0e0e0 !important;
        }
        
        /* Hourly Wage and Labor Value tiles */
        .hourly-wage-tile {
            background: #fff3cd !important;
            border-color: #ffc107 !important;
        }
        
        .dark-theme .hourly-wage-tile {
            background: #5a4a1e !important;
            border-color: #ffc107 !important;
            color: #e0e0e0 !important;
        }
        
        .labor-value-tile {
            background: #e8f5e8 !important;
            border-color: #28a745 !important;
        }
        
        .dark-theme .labor-value-tile {
            background: #2d5a2d !important;
            border-color: #28a745 !important;
            color: #e0e0e0 !important;
        }
        
        .dark-theme .dark-calculation-results {
            background: #404040 !important;
            color: #e0e0e0 !important;
        }
        
        .dark-theme .dark-calculation-results strong {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .dark-calculation-results small {
            color: #aaa !important;
        }
        
        /* Transaction Grid Responsive */
        @media (max-width: 1024px) {
            .transaction-grid {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }
        
        @media (max-width: 768px) {
            .transaction-grid {
                grid-template-columns: 1fr !important;
            }
        }
        
        /* Dark theme for transaction cards */
        .dark-theme .transaction-card {
            background: #404040 !important;
            border-color: #555 !important;
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card strong {
            color: #e0e0e0 !important;
        }
        
        /* Expense Modal Styles */
        .expense-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .expense-modal-content {
            background: white;
            border-radius: 8px;
            padding: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .dark-theme .expense-modal-content {
            background: #2d2d2d;
            color: #e0e0e0;
        }
        
        .expense-button {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 4px;
        }
        
        .expense-button:hover {
            background: #138496;
        }
        
        .dark-theme .expense-button {
            background: #17a2b8;
        }
        
        .dark-theme .expense-button:hover {
            background: #138496;
        }
        
        /* Comprehensive dark theme text color fixes */
        .dark-theme strong {
            color: #e0e0e0 !important;
        }
        
        .dark-theme span {
            color: #e0e0e0 !important;
        }
        
        .dark-theme div[style*="color: #333"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme div[style*="color: #495057"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme div[style*="color: #666"] {
            color: #aaa !important;
        }
        
        .dark-theme h4 {
            color: #e0e0e0 !important;
        }
        
        .dark-theme h5 {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .expense-modal-content h3 {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .mileage-calculator h4 {
            color: #e0e0e0 !important;
        }
        
        /* Additional dark theme improvements */
        .dark-theme .transaction-card span {
            color: #e0e0e0 !important;
        }
        
        /* Comprehensive transaction card text fixes for dark theme */
        .dark-theme .transaction-card div[style*="color: #666"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card div[style*="color: #333"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card div[style*="color: #aaa"] {
            color: #ccc !important;
        }
        
        .dark-theme .transaction-card strong {
            color: #e0e0e0 !important;
        }
        
        /* Override all inline color styles in transaction cards for dark theme */
        .dark-theme .transaction-card [style*="color: #666"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card [style*="color: #333"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card [style*="color: #aaa"] {
            color: #ccc !important;
        }
        
        /* Force all text in transaction cards to be white in dark theme */
        .dark-theme .transaction-card * {
            color: #e0e0e0 !important;
        }
        
        /* Preserve green/red colors for profit/loss indicators */
        .dark-theme .transaction-card [style*="color: #28a745"] {
            color: #28a745 !important;
        }
        
        .dark-theme .transaction-card [style*="color: #dc3545"] {
            color: #dc3545 !important;
        }
        
        /* Transaction card specific elements */
        .transaction-title {
            font-size: 16px;
            color: #333;
        }
        
        .dark-theme .transaction-title {
            color: #e0e0e0 !important;
        }
        
        .transaction-detail {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .dark-theme .transaction-detail {
            color: #e0e0e0 !important;
        }
        
        /* Special handling for disabled/muted text */
        .dark-theme .transaction-detail[style*="color: #aaa"] {
            color: #ccc !important;
        }
        
        .dark-theme .expense-modal-content div {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .expense-modal-content .expense-breakdown {
            background: #404040 !important;
        }
        
        /* Comprehensive expense modal dark theme fixes */
        .dark-theme .expense-modal-content [style*="color: #666"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .expense-modal-content [style*="color: #333"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .expense-modal-content [style*="color: #aaa"] {
            color: #ccc !important;
        }
        
        .dark-theme .expense-modal-content strong {
            color: #e0e0e0 !important;
        }
        
        /* Expense modal background fix */
        .dark-theme .expense-modal-content > div > div[style*="backgroundColor: #f8f9fa"] {
            background-color: #404040 !important;
        }
        
        .dark-theme select {
            background: #555 !important;
            color: #e0e0e0 !important;
            border-color: #666 !important;
        }
        
        .dark-theme #mileageCalculator {
            background: #404040 !important;
            border-color: #555 !important;
        }
        
        .dark-theme .info-note {
            background: #1e3a3e !important;
            border-color: #4a6b70 !important;
            color: #a6e9ed !important;
        }
        
        /* Expense Edit Form Styles */
        .expense-edit-form {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .dark-theme .expense-edit-form {
            background: #404040;
            border-color: #555;
        }
        
        .edit-form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .edit-form-field {
            flex: 1;
            min-width: 120px;
        }
        
        .edit-form-field label {
            display: block;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 3px;
            color: #555;
        }
        
        .dark-theme .edit-form-field label {
            color: #ccc;
        }
        
        .edit-form-field input, .edit-form-field select, .edit-form-field textarea {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .dark-theme .edit-form-field input, 
        .dark-theme .edit-form-field select, 
        .dark-theme .edit-form-field textarea {
            background: #555;
            border-color: #666;
            color: #e0e0e0;
        }
        
        .edit-buttons {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 15px;
        }
        
        .edit-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        .edit-btn.save {
            background: #28a745;
            color: white;
        }
        
        .edit-btn.cancel {
            background: #6c757d;
            color: white;
        }
        
        .edit-btn:hover {
            opacity: 0.9;
        }
        
        .expense-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .edit-expense-btn {
            background: #17a2b8;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .edit-expense-btn:hover {
            background: #138496;
        }
        
        /* House-shaped property tiles */
        .property-house-tiles {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .property-house-tile {
            position: relative;
            background: #f8f9fa;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px 10px 10px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 80px;
        }
        
        .property-house-tile:hover {
            border-color: #007bff;
            background: #e9f4ff;
            transform: translateY(-2px);
        }
        
        .property-house-tile.selected {
            border-color: #007bff;
            background: #e9f4ff;
            box-shadow: 0 2px 8px rgba(0,123,255,0.3);
        }
        
        .property-house-tile::before {
            content: 'PROP';
            font-size: 12px;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            color: #007bff;
        }
        
        .property-house-tile .address {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 3px;
            color: #333;
        }
        
        .property-house-tile .client {
            font-size: 11px;
            color: #666;
        }
        
        .dark-theme .property-house-tile {
            background: #404040;
            border-color: #555;
        }
        
        .dark-theme .property-house-tile:hover,
        .dark-theme .property-house-tile.selected {
            background: #505050;
            border-color: #007bff;
        }
        
        .dark-theme .property-house-tile .address {
            color: #e0e0e0;
        }
        
        .dark-theme .property-house-tile .client {
            color: #ccc;
        }
        
        /* Report Modal Styles */
        .report-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        
        .report-modal-content {
            background: white;
            width: 90%;
            max-width: 800px;
            max-height: 90%;
            overflow-y: auto;
            border-radius: 8px;
            padding: 20px;
            position: relative;
        }
        
        .dark-theme .report-modal-content {
            background: #2d2d2d;
            color: #e0e0e0;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .dark-theme .report-header {
            border-bottom-color: #555;
        }
        
        .report-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .report-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .report-btn.print {
            background: #007bff;
            color: white;
        }
        
        .report-btn.close {
            background: #6c757d;
            color: white;
        }
        
        .report-content {
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        
        .report-content h1, .report-content h2, .report-content h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .dark-theme .report-content h1, 
        .dark-theme .report-content h2, 
        .dark-theme .report-content h3 {
            color: #e0e0e0;
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .report-table th, .report-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        .report-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .dark-theme .report-table th, 
        .dark-theme .report-table td {
            border-color: #555;
        }
        
        .dark-theme .report-table th {
            background: #404040;
        }
        
        @media print {
            .report-actions {
                display: none;
            }
            
            .report-modal {
                position: static;
                background: none;
            }
            
            .report-modal-content {
                width: 100%;
                max-width: none;
                box-shadow: none;
                padding: 0;
            }
        }
        .tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
        }
        .tab {
            padding: 12px 16px;
            cursor: pointer;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px 8px 0 0;
            font-size: 14px;
            font-weight: 500;
            min-width: 100px;
            text-align: center;
            white-space: nowrap;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        /* Individual tab colors */
        .tab[data-tab="goals"] {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            border-color: #28a745;
            color: #155724;
        }
        
        .tab[data-tab="transactions"] {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-color: #2196f3;
            color: #0d47a1;
        }
        
        .tab[data-tab="dashboard"] {
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            border-color: #9c27b0;
            color: #4a148c;
        }
        
        .tab[data-tab="expenses"] {
            background: linear-gradient(135deg, #fff3e0, #ffcc02);
            border-color: #ff9800;
            color: #e65100;
        }
        
        .tab[data-tab="reports"] {
            background: linear-gradient(135deg, #fce4ec, #f8bbd9);
            border-color: #e91e63;
            color: #880e4f;
        }
        
        .tab[data-tab="gci"] {
            background: linear-gradient(135deg, #e0f2f1, #b2dfdb);
            border-color: #009688;
            color: #004d40;
        }
        
        .tab[data-tab="performance"] {
            background: linear-gradient(135deg, #fff8e1, #ffecb3);
            border-color: #ffc107;
            color: #ff6f00;
        }
        
        .dark-theme .tab {
            background: #404040;
            border-color: #555;
            color: #e0e0e0;
        }
        
        .tab:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        /* Hover effects for colored tabs */
        .tab[data-tab="goals"]:hover {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
        }
        
        .tab[data-tab="transactions"]:hover {
            background: linear-gradient(135deg, #bbdefb, #90caf9);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(33, 150, 243, 0.3);
        }
        
        .tab[data-tab="dashboard"]:hover {
            background: linear-gradient(135deg, #e1bee7, #ce93d8);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(156, 39, 176, 0.3);
        }
        
        .tab[data-tab="expenses"]:hover {
            background: linear-gradient(135deg, #ffcc02, #ffb300);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 152, 0, 0.3);
        }
        
        .tab[data-tab="reports"]:hover {
            background: linear-gradient(135deg, #f8bbd9, #f48fb1);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(233, 30, 99, 0.3);
        }
        
        .tab[data-tab="gci"]:hover {
            background: linear-gradient(135deg, #b2dfdb, #80cbc4);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 150, 136, 0.3);
        }
        
        .tab[data-tab="performance"]:hover {
            background: linear-gradient(135deg, #ffecb3, #ffe082);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 193, 7, 0.3);
        }
        
        .dark-theme .tab:hover {
            background: #505050;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255,255,255,0.1);
        }
        
        .tab.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,123,255,0.4);
        }
        
        /* Active state for colored tabs */
        .tab[data-tab="goals"].active {
            background: linear-gradient(135deg, #28a745, #20c997);
            border-color: #28a745;
            color: white;
            box-shadow: 0 6px 12px rgba(40, 167, 69, 0.4);
        }
        
        .tab[data-tab="transactions"].active {
            background: linear-gradient(135deg, #2196f3, #03a9f4);
            border-color: #2196f3;
            color: white;
            box-shadow: 0 6px 12px rgba(33, 150, 243, 0.4);
        }
        
        .tab[data-tab="dashboard"].active {
            background: linear-gradient(135deg, #9c27b0, #e91e63);
            border-color: #9c27b0;
            color: white;
            box-shadow: 0 6px 12px rgba(156, 39, 176, 0.4);
        }
        
        .tab[data-tab="expenses"].active {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            border-color: #ff9800;
            color: white;
            box-shadow: 0 6px 12px rgba(255, 152, 0, 0.4);
        }
        
        .tab[data-tab="reports"].active {
            background: linear-gradient(135deg, #e91e63, #ad1457);
            border-color: #e91e63;
            color: white;
            box-shadow: 0 6px 12px rgba(233, 30, 99, 0.4);
        }
        
        .tab[data-tab="gci"].active {
            background: linear-gradient(135deg, #009688, #00695c);
            border-color: #009688;
            color: white;
            box-shadow: 0 6px 12px rgba(0, 150, 136, 0.4);
        }
        
        .tab[data-tab="performance"].active {
            background: linear-gradient(135deg, #ffc107, #ff8f00);
            border-color: #ffc107;
            color: white;
            box-shadow: 0 6px 12px rgba(255, 193, 7, 0.4);
        }
        
        .dark-theme .tab.active {
            background: #0056b3;
        }
        .tab-content {
            padding: 20px 0;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .tile {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #ddd;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .dark-theme .tile {
            background: linear-gradient(135deg, #404040, #4a4a4a);
            border-color: #555;
            color: #e0e0e0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .tile:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
        }
        
        .dark-theme .tile:hover {
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
        }
        .tile h4 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }
        .tile p {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
            color: #007bff;
        }
        .tile small {
            color: #666;
            font-size: 12px;
            font-weight: 500;
        }
        
        .dark-theme .tile h4 {
            color: #e0e0e0;
        }
        
        .dark-theme .tile p {
            color: #4dabf7;
        }
        
        .dark-theme .tile small {
            color: #aaa;
        }
        .form-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .dark-theme .form-section {
            background: #404040;
            color: #e0e0e0;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        .dark-theme .form-group label {
            color: #e0e0e0;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .dark-theme .form-group input, 
        .dark-theme .form-group select, 
        .dark-theme .form-group textarea {
            background: #555;
            border-color: #666;
            color: #e0e0e0;
        }
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }
        .btn {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s ease;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn:active {
            transform: translateY(1px);
        }
        .timestamp {
            text-align: right;
            color: #666;
            font-size: 12px;
            margin-bottom: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .dark-theme h1 {
            color: #e0e0e0;
        }
        
        h2 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .dark-theme h2 {
            color: #e0e0e0;
        }
        
        h3 {
            color: #555;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        .dark-theme h3 {
            color: #e0e0e0;
        }
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
        }
        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #b6d7e2;
        }
        
        .dark-theme .alert-info {
            color: #a6e9ed;
            background-color: #1c4d52;
            border-color: #2d6266;
        }
        
        .progress-bar {
            background-color: #e9ecef;
            border-radius: 4px;
            height: 20px;
            overflow: hidden;
        }
        
        .dark-theme .progress-bar {
            background-color: #555;
        }
        .progress-fill {
            background-color: #007bff;
            height: 100%;
            transition: width 0.3s ease;
        }
        
        /* Progress Wheel Styles */
        .progress-wheel {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            position: relative;
            margin: 10px auto;
            background: conic-gradient(from 0deg, var(--progress-color) var(--progress-angle), #e9ecef var(--progress-angle));
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .progress-wheel::before {
            content: '';
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--bg-color, white);
            position: absolute;
        }
        
        .progress-wheel-content {
            position: relative;
            z-index: 1;
            text-align: center;
            font-weight: bold;
        }
        
        .progress-wheel-percentage {
            font-size: 18px;
            color: var(--text-color, #333);
        }
        
        .progress-wheel-label {
            font-size: 12px;
            color: var(--text-color, #666);
            margin-top: 2px;
        }
        
        .dark-theme .progress-wheel {
            background: conic-gradient(from 0deg, var(--progress-color) var(--progress-angle), #555 var(--progress-angle));
        }
        
        .dark-theme .progress-wheel::before {
            background: var(--bg-color, #333);
        }
        
        .dark-theme .progress-wheel-percentage {
            color: var(--text-color, #e0e0e0);
        }
        
        .dark-theme .progress-wheel-label {
            color: var(--text-color, #aaa);
        }
        
        .progress-wheels-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .progress-wheel-item {
            text-align: center;
        }
        
        .progress-wheel-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        /* Goals Tab Enhanced Styles */
        .goals-section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .goal-tile-enhanced {
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .goal-tile-enhanced:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
        }
        
        .form-section-enhanced {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .form-section-enhanced:hover {
            box-shadow: 0 6px 20px rgba(0,0,0,0.12);
        }
        
        .dark-theme .form-section-enhanced {
            background: #404040;
            border-color: #555;
        }
        
        .progress-summary-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
        }
        
        .progress-summary-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .dark-theme .progress-summary-card {
            background: #505050;
            color: #e0e0e0;
        }
        
        .activity-input-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        @media (max-width: 768px) {
            .activity-input-group {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }
        
        .goal-category-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
        }
        
        .dark-theme .goal-category-section {
            background: #404040;
            border-left-color: #4dabf7;
        }
        
        /* Property Card Styles */
        .property-card {
            transition: all 0.3s ease;
        }
        
        .dark-theme .property-card {
            background: #404040 !important;
            border-color: #555 !important;
            color: #e0e0e0 !important;
        }
        
        .dark-theme .property-card h4 {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .property-card p {
            color: #ccc !important;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Progress Wheel Component
        const ProgressWheel = ({ percentage, label, color = '#007bff' }) => {
            const angle = Math.min(Math.max(percentage, 0), 100) * 3.6; // Convert percentage to degrees
            
            const getColor = (percentage) => {
                if (percentage >= 100) return '#28a745'; // Green
                if (percentage >= 75) return '#ffc107'; // Yellow
                if (percentage >= 50) return '#fd7e14'; // Orange
                return '#dc3545'; // Red
            };
            
            const wheelColor = getColor(percentage);
            
            return (
                <div className="progress-wheel-item">
                    <div className="progress-wheel-title">{label}</div>
                    <div 
                        className="progress-wheel"
                        style={{
                            '--progress-angle': `${angle}deg`,
                            '--progress-color': wheelColor,
                            '--bg-color': 'var(--wheel-bg, white)',
                            '--text-color': 'var(--wheel-text, #333)'
                        }}
                    >
                        <div className="progress-wheel-content">
                            <div className="progress-wheel-percentage">{Math.round(percentage)}%</div>
                            <div className="progress-wheel-label">Complete</div>
                        </div>
                    </div>
                </div>
            );
        };
        
        const App = () => {
            const [activeTab, setActiveTab] = useState('goals');
            const [properties, setProperties] = useState([]);
            const [transactions, setTransactions] = useState([]);
            const [expenses, setExpenses] = useState([]);
            const [hours, setHours] = useState([]);
            const [calls, setCalls] = useState({ made: 0, answered: 0 });
            const [appointments, setAppointments] = useState([]);
            const [gciData, setGciData] = useState({ gciGoal: 215000, current: 0 });
            const [dailyData, setDailyData] = useState({});
            const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);
            const [goals, setGoals] = useState({
                dailyCalls: 10,
                weeklyAppointments: 5,
                weeklyBuyerContracts: 2,
                weeklyOffers: 5,
                monthlyClosings: 2,
                annualGCI: 215000
            });
            const [goalsLocked, setGoalsLocked] = useState(false);
            const [gciCalculator, setGciCalculator] = useState({
                averageSalePrice: 350000,
                commissionRate: 2.5,
                averageCommissionPerDeal: 8750, // Default commission per deal
                desiredGCI: 215000,
                dealsNeeded: 0
            });
            const [selectedPropertyForExpenses, setSelectedPropertyForExpenses] = useState(null);
            const [currentTheme, setCurrentTheme] = useState('light');
            const [hourlyWage, setHourlyWage] = useState(50); // Default $50/hour
            const [showExpenseModal, setShowExpenseModal] = useState(false);
            const [selectedTransactionExpenses, setSelectedTransactionExpenses] = useState([]);
            const [editingExpense, setEditingExpense] = useState(null);
            const [isEditMode, setIsEditMode] = useState(false);
            const [selectedPropertyForExpense, setSelectedPropertyForExpense] = useState(null);
            const [showReportModal, setShowReportModal] = useState(false);
            const [currentReport, setCurrentReport] = useState(null);
            const [propertySourceFilter, setPropertySourceFilter] = useState('All');
            const [propertyStatusFilter, setPropertyStatusFilter] = useState('All');
            
            // Load initial data and set up functionality
            useEffect(() => {
                const sampleProperties = [
                    { id: 1, address: '123 Main St', client: 'John Doe', status: 'Listed', price: 350000, type: 'Seller', statusNote: '', source: 'Referral' },
                    { id: 2, address: '456 Oak Ave', client: 'Jane Smith', status: 'Sold', price: 425000, type: 'Seller', statusNote: '', source: 'SOI' },
                    { id: 3, address: '789 Pine Rd', client: 'Bob Johnson', status: 'Under Contract', price: 275000, type: 'Buyer', statusNote: '', source: 'Zillow' },
                    { id: 4, address: '321 Elm Dr', client: 'Sarah Wilson', status: 'Buyer Appointment', price: 300000, type: 'Buyer', statusNote: '', source: 'Facebook' },
                    { id: 5, address: '654 Maple Ave', client: 'Mike Brown', status: 'Buyer Signed', price: 380000, type: 'Buyer', statusNote: '', source: 'Direct Mail' },
                    { id: 6, address: '987 Cedar St', client: 'Lisa Davis', status: 'Listing Appointment', price: 450000, type: 'Seller', statusNote: '', source: 'OpCity' },
                    { id: 7, address: '159 Oak Ln', client: 'Tom Anderson', status: 'Closed', price: 320000, type: 'Buyer', statusNote: '', source: 'In-house Referral' }
                ];
                setProperties(sampleProperties);
                
                const sampleTransactions = [
                    { id: 1, amount: 350000, commission: 8750, status: 'Closed', property: '123 Main St', date: '2025-07-15' },
                    { id: 2, amount: 425000, commission: 10625, status: 'Closed', property: '456 Oak Ave', date: '2025-07-10' },
                    { id: 3, amount: 275000, commission: 6875, status: 'Pending', property: '789 Pine Rd', date: '2025-07-05' }
                ];
                setTransactions(sampleTransactions);
                
                setCalls({ made: 15, answered: 12 });
                setAppointments([
                    { id: 1, date: '2025-07-16', time: '10:00', client: 'John Doe' },
                    { id: 2, date: '2025-07-16', time: '14:00', client: 'Jane Smith' }
                ]);
                
                const sampleExpenses = [
                    { 
                        id: 1, 
                        date: '2025-07-20', 
                        propertyId: 1, 
                        propertyAddress: '123 Main St', 
                        category: 'Travel', 
                        amount: 30, 
                        hoursWorked: 0.5,
                        description: 'Gas for property visit', 
                        vendor: 'Shell Station' 
                    },
                    { 
                        id: 2, 
                        date: '2025-07-20', 
                        propertyId: 1, 
                        propertyAddress: '123 Main St', 
                        category: 'Staging', 
                        amount: 1500, 
                        hoursWorked: 4,
                        description: 'Professional staging setup', 
                        vendor: 'Elite Staging Co' 
                    }
                ];
                setExpenses(sampleExpenses);
            }, []);
            
            // Property management functions
            const addProperty = (propertyData) => {
                const newProperty = {
                    id: Math.max(...properties.map(p => p.id), 0) + 1,
                    ...propertyData
                };
                setProperties([...properties, newProperty]);
                
                // Always create transaction for every property, default status is "Inactive"
                const commission = propertyData.status === 'Closed' ? propertyData.price * 0.025 : 0;
                const newTransaction = {
                    id: Math.max(...transactions.map(t => t.id), 0) + 1,
                    amount: propertyData.price,
                    commission: commission,
                    status: 'Inactive', // Default status is always Inactive
                    property: propertyData.address,
                    date: new Date().toISOString().split('T')[0]
                };
                setTransactions([...transactions, newTransaction]);
            };
            
            const deleteProperty = (propertyId) => {
                setProperties(properties.filter(p => p.id !== propertyId));
            };
            
            // Function to update transaction status and recalculate commission
            const updateTransactionStatus = (transactionId, newStatus) => {
                setTransactions(transactions.map(transaction => {
                    if (transaction.id === transactionId) {
                        const newCommission = newStatus === 'Closed' ? transaction.amount * 0.025 : 0;
                        return {
                            ...transaction,
                            status: newStatus,
                            commission: newCommission
                        };
                    }
                    return transaction;
                }));
            };
            
            // Function to update property status
            const updatePropertyStatus = (propertyId, newStatus) => {
                setProperties(properties.map(property => {
                    if (property.id === propertyId) {
                        return {
                            ...property,
                            status: newStatus
                        };
                    }
                    return property;
                }));
                
                // Also update corresponding transaction if it exists
                setTransactions(transactions.map(transaction => {
                    if (transaction.property === properties.find(p => p.id === propertyId)?.address) {
                        const newCommission = newStatus === 'Closed' ? transaction.amount * 0.025 : 0;
                        return {
                            ...transaction,
                            status: newStatus,
                            commission: newCommission
                        };
                    }
                    return transaction;
                }));
            };
            
            const addExpense = (expenseData) => {
                const newExpense = {
                    id: Math.max(...expenses.map(e => e.id), 0) + 1,
                    ...expenseData
                };
                setExpenses([...expenses, newExpense]);
            };
            
            const updateExpense = (expenseId, updatedData) => {
                setExpenses(prev => prev.map(expense => 
                    expense.id === expenseId 
                        ? { ...expense, ...updatedData }
                        : expense
                ));
                // Update the modal data if it's currently showing
                setSelectedTransactionExpenses(prev => prev.map(expense =>
                    expense.id === expenseId
                        ? { ...expense, ...updatedData }
                        : expense
                ));
            };
            
            // Calculate effective hourly wage based on closed transactions and hours worked
            const calculateEffectiveHourlyWage = () => {
                const closedTransactions = transactions.filter(t => t.status === 'Closed');
                const totalCommission = closedTransactions.reduce((sum, t) => sum + t.commission, 0);
                
                // Get expenses for closed transactions only
                const closedTransactionExpenses = expenses.filter(expense => {
                    if (!expense.propertyId) return false;
                    const property = properties.find(p => p.id === expense.propertyId);
                    return property && property.status === 'Closed';
                });
                
                const totalHoursWorked = closedTransactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0);
                
                if (totalHoursWorked === 0) return 0;
                
                return totalCommission / totalHoursWorked;
            };
            
            // Helper function to get week start date (Monday)
            const getWeekStart = (date) => {
                const d = new Date(date);
                const day = d.getDay();
                const diff = d.getDate() - day + (day === 0 ? -6 : 1); // Adjust when day is Sunday
                return new Date(d.setDate(diff)).toISOString().split('T')[0];
            };
            
            // Calculate weekly totals for goals
            const getWeeklyTotal = (field, targetDate = selectedDate) => {
                const weekStart = getWeekStart(targetDate);
                const weekData = Object.entries(dailyData).filter(([date]) => {
                    const entryWeekStart = getWeekStart(date);
                    return entryWeekStart === weekStart;
                });
                
                return weekData.reduce((sum, [_, data]) => sum + (data[field] || 0), 0);
            };
            
            // Calculate weekly progress percentage
            const getWeeklyProgress = (field, weeklyGoal, targetDate = selectedDate) => {
                const total = getWeeklyTotal(field, targetDate);
                return weeklyGoal > 0 ? (total / weeklyGoal) * 100 : 0;
            };
            
            // Get current week expenses
            const getCurrentWeekExpenses = () => {
                const weekStart = getWeekStart(selectedDate);
                return expenses.filter(expense => {
                    const expenseWeekStart = getWeekStart(expense.date);
                    return expenseWeekStart === weekStart;
                });
            };
            
            // Get current month expenses
            const getCurrentMonthExpenses = () => {
                const currentMonth = selectedDate.substring(0, 7); // YYYY-MM format
                return expenses.filter(expense => {
                    const expenseMonth = expense.date.substring(0, 7);
                    return expenseMonth === currentMonth;
                });
            };
            
            // Generate report functions
            const generateExpenseReport = () => {
                const totalExpenses = expenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                const totalHours = expenses.reduce((sum, e) => sum + (e.hoursWorked || 0), 0);
                
                const categorySummary = expenses.reduce((acc, expense) => {
                    const category = expense.category || 'Other';
                    if (!acc[category]) {
                        acc[category] = { amount: 0, count: 0, hours: 0 };
                    }
                    acc[category].amount += expense.amount || 0;
                    acc[category].count += 1;
                    acc[category].hours += expense.hoursWorked || 0;
                    return acc;
                }, {});
                
                return {
                    title: 'Expense Report',
                    totalExpenses,
                    totalHours,
                    categorySummary,
                    expenses: expenses.sort((a, b) => new Date(b.date) - new Date(a.date))
                };
            };
            
            const generateWeeklyReport = () => {
                const weekExpenses = getCurrentWeekExpenses();
                const weekStart = getWeekStart(selectedDate);
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekEnd.getDate() + 6);
                
                const weeklyData = Object.entries(dailyData).filter(([date]) => {
                    const entryWeekStart = getWeekStart(date);
                    return entryWeekStart === weekStart;
                });
                
                const weeklyTotals = {
                    hoursWorked: getWeeklyTotal('hoursWorked'),
                    callsMade: getWeeklyTotal('callsMade'),
                    callsAnswered: getWeeklyTotal('callsAnswered'),
                    appointmentsSet: getWeeklyTotal('appointmentsSet'),
                    offersWritten: getWeeklyTotal('offersWritten'),
                    buyerContracts: getWeeklyTotal('buyerContracts'),
                    listingsObtained: getWeeklyTotal('listingsObtained')
                };
                
                return {
                    title: 'Weekly Report',
                    weekStart,
                    weekEnd: weekEnd.toISOString().split('T')[0],
                    expenses: weekExpenses,
                    dailyData: weeklyData,
                    totals: weeklyTotals,
                    goals
                };
            };
            
            const generateDailyReport = () => {
                const dayData = dailyData[selectedDate] || {};
                const dayExpenses = expenses.filter(e => e.date === selectedDate);
                
                return {
                    title: 'Daily Report',
                    date: selectedDate,
                    data: dayData,
                    expenses: dayExpenses,
                    goals
                };
            };
            
            const saveDailyData = (data) => {
                setDailyData(prev => ({
                    ...prev,
                    [data.date]: data
                }));
                setCalls({ made: data.callsMade || 0, answered: data.callsAnswered || 0 });
            };
            
            // GCI Calculator function
            const calculateDealsNeeded = (avgPrice, commissionRate, desiredGCI, manualCommissionPerDeal = null) => {
                if (desiredGCI > 0) {
                    let commissionPerDeal = manualCommissionPerDeal;
                    if (!commissionPerDeal && avgPrice > 0 && commissionRate > 0) {
                        commissionPerDeal = (avgPrice * commissionRate) / 100;
                    }
                    if (commissionPerDeal > 0) {
                        return Math.ceil(desiredGCI / commissionPerDeal);
                    }
                }
                return 0;
            };
            
            // Mileage Calculator function
            const calculateMileageCost = () => {
                const mileage = parseFloat(document.getElementById('mileageInput')?.value) || 0;
                const gasPrice = parseFloat(document.getElementById('gasPriceInput')?.value) || 0;
                const mpg = parseFloat(document.getElementById('mpgInput')?.value) || 20;
                
                if (mileage > 0 && gasPrice > 0 && mpg > 0) {
                    const gallonsUsed = mileage / mpg;
                    const totalCost = gallonsUsed * gasPrice;
                    const calculatedCostElement = document.getElementById('calculatedCost');
                    if (calculatedCostElement) {
                        calculatedCostElement.value = `$${totalCost.toFixed(2)}`;
                    }
                }
            };
            
            // Function to toggle mileage calculator
            const toggleMileageCalculator = (category) => {
                const calculator = document.getElementById('mileageCalculator');
                if (calculator) {
                    calculator.style.display = category === 'Travel' ? 'block' : 'none';
                }
            };
            
            // Theme toggle function
            const toggleTheme = () => {
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                setCurrentTheme(newTheme);
                document.body.className = newTheme === 'dark' ? 'dark-theme' : '';
            };
            
            // Set initial theme
            React.useEffect(() => {
                document.body.className = currentTheme === 'dark' ? 'dark-theme' : '';
            }, [currentTheme]);
            
            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
            const closedDeals = transactions.filter(t => t.status === 'Closed');
            
            return (
                <div className="container">
                    <div className="app-header">
                        <h1 className="app-title"> Real Estate KPI Dashboard</h1>
                        <p className="app-subtitle">Professional Performance Analytics & Business Intelligence Platform</p>
                        <p className="app-version">Standalone Edition v2.0 | Created July 2025</p>
                    </div>
                    
                    <div className="download-notice">
                         <strong>Standalone Version</strong> - This dashboard runs entirely in your browser and saves data locally. 
                        Perfect for agents, teams, and brokerages who want professional KPI tracking without complex software.
                    </div>
                    
                    {/* Theme Toggle Button */}
                    <button 
                        className="theme-toggle" 
                        onClick={toggleTheme}
                        title={`Switch to ${currentTheme === 'light' ? 'dark' : 'light'} theme`}
                    >
                        {currentTheme === 'light' ? '' : ''}
                    </button>
                    
                    <div className="timestamp">
                        <span> Last Updated: {new Date().toLocaleString()}</span>
                    </div>
                    
                    {/* Navigation Tabs */}
                    <div className="tabs">
                        <div 
                            className={`tab ${activeTab === 'goals' ? 'active' : ''}`}
                            data-tab="goals"
                            onClick={() => setActiveTab('goals')}
                        >
                             Goals
                        </div>
                        <div 
                            className={`tab ${activeTab === 'transactions' ? 'active' : ''}`}
                            data-tab="transactions"
                            onClick={() => setActiveTab('transactions')}
                        >
                             Transactions & Properties
                        </div>
                        <div 
                            className={`tab ${activeTab === 'dashboard' ? 'active' : ''}`}
                            data-tab="dashboard"
                            onClick={() => setActiveTab('dashboard')}
                        >
                             Dashboard
                        </div>
                        <div 
                            className={`tab ${activeTab === 'expenses' ? 'active' : ''}`}
                            data-tab="expenses"
                            onClick={() => setActiveTab('expenses')}
                        >
                             Expenses
                        </div>
                        <div 
                            className={`tab ${activeTab === 'reports' ? 'active' : ''}`}
                            data-tab="reports"
                            onClick={() => setActiveTab('reports')}
                        >
                             Reports
                        </div>
                        <div 
                            className={`tab ${activeTab === 'gci' ? 'active' : ''}`}
                            data-tab="gci"
                            onClick={() => setActiveTab('gci')}
                        >
                             GCI Calculator
                        </div>
                        <div 
                            className={`tab ${activeTab === 'performance' ? 'active' : ''}`}
                            data-tab="performance"
                            onClick={() => setActiveTab('performance')}
                        >
                             Performance
                        </div>
                    </div>
                    
                    {/* Goals Tab */}
                    {activeTab === 'goals' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}> Goals & Performance Tracking</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Set your targets and track your daily progress toward success</p>
                            </div>
                            
                            {/* Goal Status Banner */}
                            <div style={{
                                background: goalsLocked ? 'linear-gradient(135deg, #d4edda, #c3e6cb)' : 'linear-gradient(135deg, #fff3cd, #ffeaa7)',
                                border: `2px solid ${goalsLocked ? '#28a745' : '#ffc107'}`,
                                borderRadius: '12px',
                                padding: '20px',
                                marginBottom: '30px',
                                textAlign: 'center'
                            }} className={currentTheme === 'dark' ? 'dark-calculation-results' : ''}>
                                <h3 style={{margin: '0 0 10px 0', color: goalsLocked ? '#155724' : '#856404'}}>
                                    {goalsLocked ? ' Goals Locked & Active' : ' Goals Ready to Set'}
                                </h3>
                                <p style={{margin: '0 0 15px 0', color: goalsLocked ? '#155724' : '#856404'}}>
                                    {goalsLocked 
                                        ? 'Your goals are locked and progress tracking is enabled. Enter daily activities to see your performance!'
                                        : 'Set your goals below and lock them to start tracking your progress automatically.'
                                    }
                                </p>
                                <button 
                                    className="btn" 
                                    style={{
                                        backgroundColor: goalsLocked ? '#dc3545' : '#28a745',
                                        borderRadius: '25px',
                                        padding: '8px 20px',
                                        fontWeight: 'bold'
                                    }}
                                    onClick={() => {
                                        if (goalsLocked) {
                                            if (confirm(' Unlock your goals?\n\nThis will allow you to modify your targets but disable progress tracking until you lock them again.')) {
                                                setGoalsLocked(false);
                                            }
                                        } else {
                                            if (confirm(' Lock your goals?\n\nThis will enable progress tracking and prevent goal modifications. You can unlock them later if needed.')) {
                                                setGoalsLocked(true);
                                            }
                                        }
                                    }}
                                >
                                    {goalsLocked ? ' Unlock Goals' : ' Lock Goals & Start Tracking'}
                                </button>
                            </div>
                            
                            {/* Current Goals Overview - Redesigned */}
                            <div style={{marginBottom: '30px'}}>
                                <h3 style={{textAlign: 'center', marginBottom: '20px', color: '#333'}}> Your Current Goals</h3>
                                <div style={{
                                    display: 'grid', 
                                    gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', 
                                    gap: '15px'
                                }}>
                                    <div className="tile" style={{
                                        background: 'linear-gradient(135deg, #e3f2fd, #bbdefb)',
                                        border: '2px solid #2196f3',
                                        borderRadius: '12px',
                                        textAlign: 'center'
                                    }}>
                                        <h4 style={{color: '#1565c0', marginBottom: '8px'}}> Daily Calls</h4>
                                        <p style={{fontSize: '24px', fontWeight: 'bold', color: '#0d47a1', margin: '8px 0'}}>{goals.dailyCalls}</p>
                                        <small style={{color: '#1565c0'}}>calls per day</small>
                                    </div>
                                    <div className="tile" style={{
                                        background: 'linear-gradient(135deg, #f3e5f5, #e1bee7)',
                                        border: '2px solid #9c27b0',
                                        borderRadius: '12px',
                                        textAlign: 'center'
                                    }}>
                                        <h4 style={{color: '#7b1fa2', marginBottom: '8px'}}> Weekly Appointments</h4>
                                        <p style={{fontSize: '24px', fontWeight: 'bold', color: '#4a148c', margin: '8px 0'}}>{goals.weeklyAppointments}</p>
                                        <small style={{color: '#7b1fa2'}}>appointments per week</small>
                                    </div>
                                    <div className="tile" style={{
                                        background: 'linear-gradient(135deg, #e8f5e8, #c8e6c9)',
                                        border: '2px solid #4caf50',
                                        borderRadius: '12px',
                                        textAlign: 'center'
                                    }}>
                                        <h4 style={{color: '#2e7d32', marginBottom: '8px'}}> Monthly Closings</h4>
                                        <p style={{fontSize: '24px', fontWeight: 'bold', color: '#1b5e20', margin: '8px 0'}}>{goals.monthlyClosings}</p>
                                        <small style={{color: '#2e7d32'}}>closings per month</small>
                                    </div>
                                    <div className="tile" style={{
                                        background: 'linear-gradient(135deg, #fff3e0, #ffcc02)',
                                        border: '2px solid #ff9800',
                                        borderRadius: '12px',
                                        textAlign: 'center'
                                    }}>
                                        <h4 style={{color: '#f57c00', marginBottom: '8px'}}> Annual GCI</h4>
                                        <p style={{fontSize: '20px', fontWeight: 'bold', color: '#e65100', margin: '8px 0'}}>${goals.annualGCI?.toLocaleString() || 'Not Set'}</p>
                                        <small style={{color: '#f57c00'}}>gross commission income</small>
                                    </div>
                                </div>
                            </div>
                            
                            {/* Main Content Area - Three Column Layout on Desktop */}
                            <div style={{
                                display: 'grid', 
                                gridTemplateColumns: window.innerWidth > 1200 ? '1fr 1fr 1fr' : window.innerWidth > 768 ? '1fr 1fr' : '1fr', 
                                gap: '25px', 
                                marginBottom: '30px'
                            }}>
                                
                                {/* Column 1: Goal Setting */}
                                <div className="form-section" style={{borderRadius: '12px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)'}}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '20px'}}>
                                        <span style={{fontSize: '24px', marginRight: '10px'}}></span>
                                        <h3 style={{margin: 0}}>Configure Goals</h3>
                                    </div>
                                    <form onSubmit={(e) => {
                                        e.preventDefault();
                                        if (goalsLocked) {
                                            alert(' Goals are locked! Unlock them first to make changes.');
                                            return;
                                        }
                                        const formData = new FormData(e.target);
                                        const newGoals = {
                                            dailyCalls: parseInt(formData.get('dailyCalls')) || goals.dailyCalls,
                                            weeklyAppointments: parseInt(formData.get('weeklyAppointments')) || goals.weeklyAppointments,
                                            weeklyBuyerContracts: parseInt(formData.get('weeklyBuyerContracts')) || goals.weeklyBuyerContracts,
                                            weeklyOffers: parseInt(formData.get('weeklyOffers')) || goals.weeklyOffers,
                                            monthlyClosings: parseInt(formData.get('monthlyClosings')) || goals.monthlyClosings,
                                            hoursWorked: parseFloat(formData.get('hoursWorked')) || goals.hoursWorked || 8,
                                            appointmentsSet: parseInt(formData.get('appointmentsSet')) || goals.appointmentsSet || 1,
                                            offersWritten: parseInt(formData.get('offersWritten')) || goals.offersWritten || 2,
                                            annualGCI: parseInt(formData.get('annualGCI')) || goals.annualGCI
                                        };
                                        setGoals(newGoals);
                                        setGciData(prev => ({ ...prev, gciGoal: newGoals.annualGCI }));
                                        alert(' Goals updated successfully!');
                                    }}>
                                        
                                        {/* Daily Goals Section */}
                                        <div style={{marginBottom: '20px', padding: '15px', background: '#f8f9fa', borderRadius: '8px', border: '1px solid #e9ecef'}}>
                                            <h4 style={{margin: '0 0 15px 0', color: '#495057'}}> Daily Targets</h4>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Hours to Work</label>
                                                <input 
                                                    type="number" 
                                                    name="hoursWorked" 
                                                    placeholder={`Current: ${goals.hoursWorked || 8} hours`}
                                                    step="0.5"
                                                    disabled={goalsLocked}
                                                    style={{borderRadius: '6px'}}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Phone Calls to Make</label>
                                                <input 
                                                    type="number" 
                                                    name="dailyCalls" 
                                                    placeholder={`Current: ${goals.dailyCalls} calls`}
                                                    disabled={goalsLocked}
                                                    style={{borderRadius: '6px'}}
                                                />
                                            </div>
                                        </div>
                                        
                                        {/* Weekly Goals Section */}
                                        <div style={{marginBottom: '20px', padding: '15px', background: '#f8f9fa', borderRadius: '8px', border: '1px solid #e9ecef'}}>
                                            <h4 style={{margin: '0 0 15px 0', color: '#495057'}}> Weekly Targets</h4>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Appointments to Set</label>
                                                <input 
                                                    type="number" 
                                                    name="weeklyAppointments" 
                                                    placeholder={`Current: ${goals.weeklyAppointments} per week`}
                                                    disabled={goalsLocked}
                                                    style={{borderRadius: '6px'}}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Buyer Contracts</label>
                                                <input 
                                                    type="number" 
                                                    name="weeklyBuyerContracts" 
                                                    placeholder={`Current: ${goals.weeklyBuyerContracts} per week`}
                                                    disabled={goalsLocked}
                                                    style={{borderRadius: '6px'}}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Offers to Write</label>
                                                <input 
                                                    type="number" 
                                                    name="weeklyOffers" 
                                                    placeholder={`Current: ${goals.weeklyOffers} per week`}
                                                    disabled={goalsLocked}
                                                    style={{borderRadius: '6px'}}
                                                />
                                            </div>
                                        </div>
                                        
                                        {/* Monthly Goals Section */}
                                        <div style={{marginBottom: '20px', padding: '15px', background: '#f8f9fa', borderRadius: '8px', border: '1px solid #e9ecef'}}>
                                            <h4 style={{margin: '0 0 15px 0', color: '#495057'}}> Long-term Targets</h4>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Monthly Closings</label>
                                                <input 
                                                    type="number" 
                                                    name="monthlyClosings" 
                                                    placeholder={`Current: ${goals.monthlyClosings} per month`}
                                                    disabled={goalsLocked}
                                                    style={{borderRadius: '6px'}}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Annual GCI Target</label>
                                                <input 
                                                    type="number" 
                                                    name="annualGCI" 
                                                    placeholder={`Current: $${goals.annualGCI?.toLocaleString() || 'Not Set'}`}
                                                    disabled={goalsLocked}
                                                    style={{borderRadius: '6px'}}
                                                />
                                            </div>
                                        </div>
                                        
                                        <button 
                                            type="submit" 
                                            className="btn" 
                                            disabled={goalsLocked}
                                            style={{
                                                width: '100%',
                                                borderRadius: '8px',
                                                padding: '12px',
                                                fontWeight: 'bold',
                                                backgroundColor: goalsLocked ? '#6c757d' : '#007bff'
                                            }}
                                        >
                                            {goalsLocked ? ' Goals Locked' : ' Update Goals'}
                                        </button>
                                    </form>
                                </div>
                                
                                {/* Column 2: Daily Activity Entry */}
                                <div className="form-section" style={{borderRadius: '12px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)'}}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '20px'}}>
                                        <span style={{fontSize: '24px', marginRight: '10px'}}></span>
                                        <h3 style={{margin: 0}}>Today's Activities</h3>
                                    </div>
                                    <form onSubmit={(e) => {
                                        e.preventDefault();
                                        const formData = new FormData(e.target);
                                        const data = {
                                            date: formData.get('date'),
                                            hoursWorked: parseFloat(formData.get('hoursWorked')) || 0,
                                            callsMade: parseInt(formData.get('callsMade')) || 0,
                                            callsAnswered: parseInt(formData.get('callsAnswered')) || 0,
                                            appointmentsSet: parseInt(formData.get('appointmentsSet')) || 0,
                                            offersWritten: parseInt(formData.get('offersWritten')) || 0,
                                            buyerContracts: parseInt(formData.get('buyerContracts')) || 0,
                                            listingsObtained: parseInt(formData.get('listingsObtained')) || 0
                                        };
                                        saveDailyData(data);
                                        alert(' Daily activities saved successfully!');
                                    }}>
                                        <div className="form-group">
                                            <label style={{fontWeight: '500'}}> Date</label>
                                            <input 
                                                type="date" 
                                                name="date"
                                                value={selectedDate}
                                                onChange={(e) => setSelectedDate(e.target.value)}
                                                required
                                                style={{borderRadius: '6px'}}
                                            />
                                        </div>
                                        
                                        <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '15px'}}>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}> Hours Worked</label>
                                                <input 
                                                    type="number" 
                                                    name="hoursWorked" 
                                                    placeholder="0"
                                                    step="0.5"
                                                    style={{borderRadius: '6px'}}
                                                    defaultValue={dailyData[selectedDate]?.hoursWorked || ''}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}> Calls Made</label>
                                                <input 
                                                    type="number" 
                                                    name="callsMade" 
                                                    placeholder="0"
                                                    style={{borderRadius: '6px'}}
                                                    defaultValue={dailyData[selectedDate]?.callsMade || ''}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}> Calls Answered</label>
                                                <input 
                                                    type="number" 
                                                    name="callsAnswered" 
                                                    placeholder="0"
                                                    style={{borderRadius: '6px'}}
                                                    defaultValue={dailyData[selectedDate]?.callsAnswered || ''}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}> Appointments Set</label>
                                                <input 
                                                    type="number" 
                                                    name="appointmentsSet" 
                                                    placeholder="0"
                                                    style={{borderRadius: '6px'}}
                                                    defaultValue={dailyData[selectedDate]?.appointmentsSet || ''}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}> Offers Written</label>
                                                <input 
                                                    type="number" 
                                                    name="offersWritten" 
                                                    placeholder="0"
                                                    style={{borderRadius: '6px'}}
                                                    defaultValue={dailyData[selectedDate]?.offersWritten || ''}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}> Buyer Contracts</label>
                                                <input 
                                                    type="number" 
                                                    name="buyerContracts" 
                                                    placeholder="0"
                                                    style={{borderRadius: '6px'}}
                                                    defaultValue={dailyData[selectedDate]?.buyerContracts || ''}
                                                />
                                            </div>
                                        </div>
                                        
                                        <div className="form-group">
                                            <label style={{fontWeight: '500'}}> Listings Obtained</label>
                                            <input 
                                                type="number" 
                                                name="listingsObtained" 
                                                placeholder="0"
                                                style={{borderRadius: '6px'}}
                                                defaultValue={dailyData[selectedDate]?.listingsObtained || ''}
                                            />
                                        </div>
                                        
                                        <button 
                                            type="submit" 
                                            className="btn"
                                            style={{
                                                width: '100%',
                                                borderRadius: '8px',
                                                padding: '12px',
                                                fontWeight: 'bold',
                                                background: 'linear-gradient(135deg, #28a745, #20c997)',
                                                border: 'none'
                                            }}
                                        >
                                             Save Today's Activities
                                        </button>
                                    </form>
                                </div>
                                
                                {/* Column 3: Quick Stats & Summary */}
                                <div className="form-section" style={{borderRadius: '12px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)'}}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '20px'}}>
                                        <span style={{fontSize: '24px', marginRight: '10px'}}></span>
                                        <h3 style={{margin: 0}}>Today's Summary</h3>
                                    </div>
                                    
                                    {dailyData[selectedDate] ? (
                                        <div>
                                            <div style={{
                                                background: 'linear-gradient(135deg, #e8f5e8, #d4edda)', 
                                                padding: '15px', 
                                                borderRadius: '8px',
                                                marginBottom: '15px',
                                                border: '1px solid #c3e6cb'
                                            }}>
                                                <h4 style={{margin: '0 0 10px 0', color: '#155724'}}> Activities Completed</h4>
                                                <div style={{display: 'grid', gap: '8px'}}>
                                                    <div style={{display: 'flex', justifyContent: 'space-between'}}>
                                                        <span> Hours Worked:</span>
                                                        <strong>{dailyData[selectedDate].hoursWorked}</strong>
                                                    </div>
                                                    <div style={{display: 'flex', justifyContent: 'space-between'}}>
                                                        <span> Calls Made:</span>
                                                        <strong>{dailyData[selectedDate].callsMade}</strong>
                                                    </div>
                                                    <div style={{display: 'flex', justifyContent: 'space-between'}}>
                                                        <span> Calls Answered:</span>
                                                        <strong>{dailyData[selectedDate].callsAnswered}</strong>
                                                    </div>
                                                    <div style={{display: 'flex', justifyContent: 'space-between'}}>
                                                        <span> Appointments:</span>
                                                        <strong>{dailyData[selectedDate].appointmentsSet}</strong>
                                                    </div>
                                                    <div style={{display: 'flex', justifyContent: 'space-between'}}>
                                                        <span> Offers:</span>
                                                        <strong>{dailyData[selectedDate].offersWritten}</strong>
                                                    </div>
                                                    <div style={{display: 'flex', justifyContent: 'space-between'}}>
                                                        <span> Listings:</span>
                                                        <strong>{dailyData[selectedDate].listingsObtained}</strong>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            {/* Call Success Rate */}
                                            {dailyData[selectedDate].callsMade > 0 && (
                                                <div style={{
                                                    background: 'linear-gradient(135deg, #e3f2fd, #bbdefb)', 
                                                    padding: '15px', 
                                                    borderRadius: '8px',
                                                    border: '1px solid #90caf9'
                                                }}>
                                                    <h4 style={{margin: '0 0 10px 0', color: '#0d47a1'}}> Call Success Rate</h4>
                                                    <div style={{textAlign: 'center'}}>
                                                        <div style={{fontSize: '24px', fontWeight: 'bold', color: '#1565c0'}}>
                                                            {Math.round((dailyData[selectedDate].callsAnswered / dailyData[selectedDate].callsMade) * 100)}%
                                                        </div>
                                                        <small style={{color: '#1976d2'}}>
                                                            {dailyData[selectedDate].callsAnswered} answered of {dailyData[selectedDate].callsMade} made
                                                        </small>
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    ) : (
                                        <div style={{
                                            background: 'linear-gradient(135deg, #fff3cd, #ffeaa7)', 
                                            padding: '20px', 
                                            borderRadius: '8px',
                                            textAlign: 'center',
                                            border: '1px solid #ffc107'
                                        }}>
                                            <div style={{fontSize: '48px', marginBottom: '10px'}}></div>
                                            <h4 style={{margin: '0 0 10px 0', color: '#856404'}}>No Data Yet</h4>
                                            <p style={{margin: 0, color: '#856404'}}>
                                                Enter your activities for {selectedDate} to see your summary here!
                                            </p>
                                        </div>
                                    )}
                                </div>
                            </div>
                            
                            {/* Progress Tracking Section - Only show if goals are locked and daily data exists */}
                            {goalsLocked && dailyData[selectedDate] && (
                                <div style={{
                                    background: 'linear-gradient(135deg, #f8f9fa, #e9ecef)',
                                    borderRadius: '15px',
                                    padding: '25px',
                                    marginBottom: '25px',
                                    border: '2px solid #28a745',
                                    boxShadow: '0 6px 12px rgba(0,0,0,0.1)'
                                }}>
                                    <div style={{textAlign: 'center', marginBottom: '25px'}}>
                                        <h3 style={{margin: '0 0 10px 0', color: '#155724'}}>
                                             Today's Progress vs Goals
                                        </h3>
                                        <p style={{margin: 0, color: '#495057'}}>Track your daily performance against your locked targets</p>
                                    </div>
                                    
                                    <div className="progress-wheels-container" style={{gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))'}}>
                                        <ProgressWheel
                                            percentage={(dailyData[selectedDate].hoursWorked / (goals.hoursWorked || 8)) * 100}
                                            label={` Hours Worked`}
                                        />
                                        <ProgressWheel
                                            percentage={(dailyData[selectedDate].callsMade / goals.dailyCalls) * 100}
                                            label={` Calls Made`}
                                        />
                                        <ProgressWheel
                                            percentage={(dailyData[selectedDate].appointmentsSet / (goals.appointmentsSet || 1)) * 100}
                                            label={` Appointments Set`}
                                        />
                                        <ProgressWheel
                                            percentage={(dailyData[selectedDate].offersWritten / (goals.offersWritten || 2)) * 100}
                                            label={` Offers Written`}
                                        />
                                        <ProgressWheel
                                            percentage={dailyData[selectedDate].callsMade > 0 
                                                ? (dailyData[selectedDate].callsAnswered / dailyData[selectedDate].callsMade) * 100 
                                                : 0}
                                            label={` Call Success Rate`}
                                        />
                                    </div>
                                    
                                    {/* Detailed Progress Stats */}
                                    <div style={{
                                        display: 'grid',
                                        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                                        gap: '15px',
                                        marginTop: '20px'
                                    }}>
                                        {[
                                            {icon: '', label: 'Hours', actual: dailyData[selectedDate].hoursWorked, goal: goals.hoursWorked || 8},
                                            {icon: '', label: 'Calls', actual: dailyData[selectedDate].callsMade, goal: goals.dailyCalls},
                                            {icon: '', label: 'Appointments', actual: dailyData[selectedDate].appointmentsSet, goal: goals.appointmentsSet || 1},
                                            {icon: '', label: 'Offers', actual: dailyData[selectedDate].offersWritten, goal: goals.offersWritten || 2}
                                        ].map((item, index) => (
                                            <div key={index} style={{
                                                background: 'white',
                                                padding: '12px',
                                                borderRadius: '8px',
                                                textAlign: 'center',
                                                border: '1px solid #dee2e6'
                                            }}>
                                                <div style={{fontSize: '20px', marginBottom: '5px'}}>{item.icon}</div>
                                                <div style={{fontWeight: 'bold', fontSize: '16px', color: '#495057'}}>{item.actual} / {item.goal}</div>
                                                <div style={{fontSize: '12px', color: '#6c757d'}}>{item.label}</div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                            
                            {/* Weekly Progress Tracking Section - Only show if goals are locked */}
                            {goalsLocked && (
                                <div style={{
                                    background: 'linear-gradient(135deg, #e3f2fd, #bbdefb)',
                                    borderRadius: '15px',
                                    padding: '25px',
                                    marginBottom: '25px',
                                    border: '2px solid #2196f3',
                                    boxShadow: '0 6px 12px rgba(0,0,0,0.1)'
                                }}>
                                    <div style={{textAlign: 'center', marginBottom: '25px'}}>
                                        <h3 style={{margin: '0 0 10px 0', color: '#0d47a1'}}>
                                             This Week's Progress vs Weekly Goals
                                        </h3>
                                        <p style={{margin: 0, color: '#1976d2'}}>Monitor your weekly targets and stay on track</p>
                                    </div>
                                    
                                    <div className="progress-wheels-container" style={{gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))'}}>
                                        <ProgressWheel
                                            percentage={getWeeklyProgress('buyerContracts', goals.weeklyBuyerContracts)}
                                            label={` Buyer Contracts`}
                                        />
                                        <ProgressWheel
                                            percentage={getWeeklyProgress('offersWritten', goals.weeklyOffers)}
                                            label={` Offers Written`}
                                        />
                                        <ProgressWheel
                                            percentage={getWeeklyProgress('appointmentsSet', goals.weeklyAppointments)}
                                            label={` Appointments Set`}
                                        />
                                    </div>
                                    
                                    {/* Weekly Stats Summary */}
                                    <div style={{
                                        display: 'grid',
                                        gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))',
                                        gap: '15px',
                                        marginTop: '20px'
                                    }}>
                                        {[
                                            {icon: '', label: 'Buyer Contracts', actual: getWeeklyTotal('buyerContracts'), goal: goals.weeklyBuyerContracts},
                                            {icon: '', label: 'Offers Written', actual: getWeeklyTotal('offersWritten'), goal: goals.weeklyOffers},
                                            {icon: '', label: 'Appointments', actual: getWeeklyTotal('appointmentsSet'), goal: goals.weeklyAppointments}
                                        ].map((item, index) => (
                                            <div key={index} style={{
                                                background: 'white',
                                                padding: '12px',
                                                borderRadius: '8px',
                                                textAlign: 'center',
                                                border: '1px solid #90caf9'
                                            }}>
                                                <div style={{fontSize: '20px', marginBottom: '5px'}}>{item.icon}</div>
                                                <div style={{fontWeight: 'bold', fontSize: '16px', color: '#0d47a1'}}>{item.actual} / {item.goal}</div>
                                                <div style={{fontSize: '12px', color: '#1976d2'}}>{item.label}</div>
                                                <div style={{fontSize: '11px', color: '#1976d2', marginTop: '2px'}}>
                                                    {Math.round((item.actual / item.goal) * 100)}% Complete
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                            
                            {/* Helpful Messages with Better Design */}
                            {!goalsLocked && (
                                <div style={{
                                    background: 'linear-gradient(135deg, #fff8e1, #fff3c4)',
                                    border: '2px solid #ffc107',
                                    borderRadius: '15px',
                                    padding: '25px',
                                    textAlign: 'center',
                                    marginBottom: '20px'
                                }}>
                                    <div style={{fontSize: '48px', marginBottom: '15px'}}></div>
                                    <h3 style={{color: '#856404', margin: '0 0 15px 0'}}>Ready to Start Tracking?</h3>
                                    <p style={{color: '#856404', margin: '0 0 20px 0', fontSize: '16px'}}>
                                        Set your goals above and lock them to enable automatic progress tracking with beautiful visual indicators!
                                    </p>
                                    <div style={{
                                        background: 'rgba(255, 193, 7, 0.2)',
                                        padding: '15px',
                                        borderRadius: '8px',
                                        fontSize: '14px',
                                        color: '#856404'
                                    }}>
                                         <strong>Tip:</strong> Once locked, you'll see real-time progress wheels and detailed analytics as you enter your daily activities.
                                    </div>
                                </div>
                            )}
                            
                            {goalsLocked && !dailyData[selectedDate] && (
                                <div style={{
                                    background: 'linear-gradient(135deg, #e8f4fd, #cce7ff)',
                                    border: '2px solid #17a2b8',
                                    borderRadius: '15px',
                                    padding: '25px',
                                    textAlign: 'center',
                                    marginBottom: '20px'
                                }}>
                                    <div style={{fontSize: '48px', marginBottom: '15px'}}></div>
                                    <h3 style={{color: '#0c5460', margin: '0 0 15px 0'}}>Enter Today's Activities</h3>
                                    <p style={{color: '#0c5460', margin: '0 0 20px 0', fontSize: '16px'}}>
                                        Your goals are locked and ready! Enter your activities above to see beautiful progress tracking and analytics.
                                    </p>
                                    <div style={{
                                        background: 'rgba(23, 162, 184, 0.2)',
                                        padding: '15px',
                                        borderRadius: '8px',
                                        fontSize: '14px',
                                        color: '#0c5460'
                                    }}>
                                         <strong>What you'll see:</strong> Progress wheels, completion percentages, and detailed performance analytics.
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                    
                    {/* Transactions Tab */}
                    {activeTab === 'transactions' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}> Transactions & Property Management</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Manage your property listings, client relationships, and transaction pipeline</p>
                            </div>
                            
                            {/* Property Management Section */}
                            <div className="form-section" style={{borderRadius: '12px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)', background: 'white', border: '1px solid #e9ecef'}}>
                                <div style={{display: 'flex', alignItems: 'center', marginBottom: '20px'}}>
                                    <span style={{fontSize: '24px', marginRight: '10px'}}></span>
                                    <h3 style={{margin: 0}}>Add New Property</h3>
                                </div>
                                <form onSubmit={(e) => {
                                    e.preventDefault();
                                    const formData = new FormData(e.target);
                                    const propertyData = {
                                        address: formData.get('address'),
                                        client: formData.get('client'),
                                        type: formData.get('type'),
                                        price: parseFloat(formData.get('price')),
                                        status: formData.get('status') || 'Active',
                                        statusNote: formData.get('statusNote') || '',
                                        source: formData.get('source') || 'Direct'
                                    };
                                    addProperty(propertyData);
                                    e.target.reset();
                                    alert('Property added successfully!');
                                }}>
                                    <div style={{display: 'grid', gridTemplateColumns: window.innerWidth > 768 ? '1fr 1fr' : '1fr', gap: '20px'}}>
                                        
                                        {/* Property Details Section */}
                                        <div style={{padding: '15px', background: '#f8f9fa', borderRadius: '8px', border: '1px solid #e9ecef'}}>
                                            <h4 style={{margin: '0 0 15px 0', color: '#495057'}}> Property Details</h4>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Property Address</label>
                                                <input type="text" name="address" placeholder="Enter property address" required style={{borderRadius: '6px'}} />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Price</label>
                                                <input type="number" name="price" placeholder="Enter price (USD)" required style={{borderRadius: '6px'}} />
                                            </div>
                                        </div>
                                        
                                        {/* Client & Lead Information Section */}
                                        <div style={{padding: '15px', background: '#f8f9fa', borderRadius: '8px', border: '1px solid #e9ecef'}}>
                                            <h4 style={{margin: '0 0 15px 0', color: '#495057'}}> Client & Lead Information</h4>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Client Name</label>
                                                <input type="text" name="client" placeholder="Enter client name" required style={{borderRadius: '6px'}} />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Client Type</label>
                                                <select name="type" required style={{borderRadius: '6px'}}>
                                                    <option value="">Select type</option>
                                                    <option value="Seller">Seller</option>
                                                    <option value="Buyer">Buyer</option>
                                                    <option value="Rental">Rental</option>
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Lead Source</label>
                                                <select name="source" required style={{borderRadius: '6px'}}>
                                                    <option value="">Select Lead Source</option>
                                                    <option value="Social Media">Social Media</option>
                                                    <option value="Referral">Referral</option>
                                                    <option value="SOI">SOI (Sphere of Influence)</option>
                                                    <option value="Zillow">Zillow</option>
                                                    <option value="OpCity">OpCity</option>
                                                    <option value="Homelight">Homelight</option>
                                                    <option value="Direct Mail">Direct Mail</option>
                                                    <option value="Online Advertising">Online Advertising</option>
                                                    <option value="Facebook">Facebook</option>
                                                    <option value="In-house Referral">In-house Referral</option>
                                                    <option value="FSBO">FSBO (For Sale By Owner)</option>
                                                    <option value="Expired">Expired Listings</option>
                                                    <option value="Terminated">Terminated Listings</option>
                                                    <option value="Other">Other</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                    {/* Status Section */}
                                    <div style={{padding: '15px', background: '#f8f9fa', borderRadius: '8px', border: '1px solid #e9ecef', marginTop: '20px'}}>
                                        <h4 style={{margin: '0 0 15px 0', color: '#495057'}}> Status & Notes</h4>
                                        <div style={{display: 'grid', gridTemplateColumns: window.innerWidth > 768 ? '1fr 2fr' : '1fr', gap: '15px'}}>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Status</label>
                                                <select name="status" style={{borderRadius: '6px'}}>
                                                    <option value="">Select Status</option>
                                                    <optgroup label="General">
                                                        <option value="Active">Active</option>
                                                        <option value="Inactive">Inactive</option>
                                                        <option value="Under Contract">Under Contract</option>
                                                        <option value="Closed">Closed</option>
                                                        <option value="Withdrawn">Withdrawn</option>
                                                        <option value="Expired">Expired</option>
                                                        <option value="Terminated">Terminated</option>
                                                    </optgroup>
                                                    <optgroup label="Buyer Pipeline">
                                                        <option value="Buyer Appointment">Buyer Appointment</option>
                                                        <option value="Buyer Signed">Buyer Signed</option>
                                                        <option value="Showing Properties">Showing Properties</option>
                                                        <option value="Offer Submitted">Offer Submitted</option>
                                                    </optgroup>
                                                    <optgroup label="Seller Pipeline">
                                                        <option value="Listing Appointment">Listing Appointment</option>
                                                        <option value="Listed">Listed</option>
                                                        <option value="Pending Sale">Pending Sale</option>
                                                        <option value="Sold">Sold</option>
                                                    </optgroup>
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Status Notes (Optional)</label>
                                                <input type="text" name="statusNote" placeholder="Enter status note (optional)" style={{borderRadius: '6px'}} />
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <button type="submit" className="btn" style={{
                                        background: 'linear-gradient(135deg, #2196f3, #03a9f4)',
                                        borderRadius: '8px',
                                        padding: '12px 24px',
                                        fontWeight: '500',
                                        marginTop: '20px',
                                        width: '100%'
                                    }}> Add Property</button>
                                </form>
                            </div>
                            
                            {/* Transaction Statistics */}
                            <div className="grid">
                                <div className="tile">
                                    <h4>Total Transactions</h4>
                                    <p>{transactions.length}</p>
                                    <small>All transactions</small>
                                </div>
                                <div className="tile">
                                    <h4>Total Volume</h4>
                                    <p>${transactions.reduce((sum, t) => sum + t.amount, 0).toLocaleString()}</p>
                                    <small>Total transaction volume</small>
                                </div>
                                <div className="tile">
                                    <h4>Commission Earned</h4>
                                    <p>${totalCommission.toLocaleString()}</p>
                                    <small>Total commission</small>
                                </div>
                                <div className="tile">
                                    <h4>Closed Deals</h4>
                                    <p>{closedDeals.length}</p>
                                    <small>Successfully closed</small>
                                </div>
                            </div>
                            
                            <div className="form-section" style={{borderRadius: '12px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)', background: 'white', border: '1px solid #e9ecef'}}>
                                <div style={{display: 'flex', alignItems: 'center', marginBottom: '20px'}}>
                                    <span style={{fontSize: '24px', marginRight: '10px'}}></span>
                                    <h3 style={{margin: 0}}>Recent Transactions</h3>
                                </div>
                                <div style={{
                                    marginTop: '20px',
                                    display: 'grid',
                                    gridTemplateColumns: 'repeat(3, 1fr)',
                                    gap: '20px'
                                }} className="transaction-grid">
                                    {transactions.map(transaction => {
                                        // Get expenses for this transaction
                                        const transactionExpenses = expenses.filter(expense => 
                                            expense.propertyAddress === transaction.property
                                        );
                                        const totalExpenses = transactionExpenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                        const netProfit = transaction.commission - totalExpenses;
                                        const roi = totalExpenses > 0 ? ((netProfit / totalExpenses) * 100) : 0;
                                        
                                        return (
                                            <div key={transaction.id} style={{
                                                border: '1px solid #ddd', 
                                                borderRadius: '8px', 
                                                padding: '15px', 
                                                backgroundColor: '#f9f9f9',
                                                display: 'flex',
                                                flexDirection: 'column',
                                                height: 'fit-content'
                                            }} className="transaction-card">
                                                <div style={{marginBottom: '12px'}}>
                                                    <strong className="transaction-title">{transaction.property}</strong>
                                                    <select
                                                        value={transaction.status}
                                                        onChange={(e) => updateTransactionStatus(transaction.id, e.target.value)}
                                                        style={{
                                                            marginLeft: '10px',
                                                            padding: '2px 8px',
                                                            borderRadius: '4px',
                                                            fontSize: '12px',
                                                            border: '1px solid #ddd',
                                                            backgroundColor: transaction.status === 'Closed' ? '#d4edda' : 
                                                                           transaction.status === 'Pending' ? '#fff3cd' : '#f8f9fa',
                                                            color: transaction.status === 'Closed' ? '#155724' : 
                                                                   transaction.status === 'Pending' ? '#856404' : '#666'
                                                        }}
                                                    >
                                                        <option value="Inactive">Inactive</option>
                                                        <option value="Active">Active</option>
                                                        <option value="Pending">Pending</option>
                                                        <option value="Under Contract">Under Contract</option>
                                                        <option value="In Progress">In Progress</option>
                                                        <option value="Withdrawn">Withdrawn</option>
                                                        <option value="Expired">Expired</option>
                                                        <option value="Terminated">Terminated</option>
                                                        <option value="Closed">Closed</option>
                                                    </select>
                                                </div>
                                                
                                                <div style={{flex: 1, marginBottom: '12px'}}>
                                                    <div className="transaction-detail">
                                                        <strong>Amount:</strong> ${transaction.amount.toLocaleString()}
                                                    </div>
                                                    <div className="transaction-detail">
                                                        <strong>Commission:</strong> ${transaction.commission.toLocaleString()}
                                                    </div>
                                                    <div className="transaction-detail">
                                                        <strong>Date:</strong> {transaction.date}
                                                    </div>
                                                    
                                                    {/* ROI Display */}
                                                    <div className="transaction-detail">
                                                        <strong>ROI:</strong> 
                                                        <span style={{
                                                            color: roi >= 0 ? '#28a745' : '#dc3545',
                                                            fontWeight: 'bold',
                                                            marginLeft: '5px'
                                                        }}>
                                                            {totalExpenses > 0 ? `${roi.toFixed(1)}%` : 'N/A'}
                                                        </span>
                                                    </div>
                                                    
                                                    {/* Expenses Section */}
                                                    <div style={{
                                                        borderTop: '1px solid #e0e0e0',
                                                        paddingTop: '8px',
                                                        marginTop: '8px'
                                                    }}>
                                                        <div style={{
                                                            display: 'flex',
                                                            justifyContent: 'space-between',
                                                            alignItems: 'center',
                                                            marginBottom: '5px'
                                                        }}>
                                                            <span className="transaction-detail" style={{margin: 0}}>
                                                                <strong>Expenses:</strong> ${totalExpenses.toLocaleString()}
                                                                {(() => {
                                                                    const totalHours = transactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0);
                                                                    return totalHours > 0 ? ` | ${totalHours}hrs` : '';
                                                                })()}
                                                            </span>
                                                            {transactionExpenses.length > 0 && (
                                                                <button 
                                                                    className="expense-button"
                                                                    onClick={() => {
                                                                        setSelectedTransactionExpenses(transactionExpenses);
                                                                        setShowExpenseModal(true);
                                                                    }}
                                                                >
                                                                    View ({transactionExpenses.length})
                                                                </button>
                                                            )}
                                                        </div>
                                                        {transactionExpenses.length === 0 && (
                                                            <div className="transaction-detail" style={{fontSize: '12px', fontStyle: 'italic', color: '#aaa'}}>
                                                                No expenses recorded
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                                
                                                {/* Net Profit */}
                                                <div style={{
                                                    borderTop: '1px solid #e0e0e0',
                                                    paddingTop: '8px',
                                                    textAlign: 'center'
                                                }}>
                                                    <div className="transaction-detail" style={{fontSize: '12px', marginBottom: '2px', textAlign: 'center'}}>
                                                        Net Profit
                                                    </div>
                                                    <div style={{
                                                        color: netProfit >= 0 ? '#28a745' : '#dc3545',
                                                        fontSize: '16px',
                                                        fontWeight: 'bold'
                                                    }}>
                                                        ${netProfit.toLocaleString()}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                    {transactions.length === 0 && (
                                        <div style={{
                                            gridColumn: '1 / -1',
                                            textAlign: 'center', 
                                            padding: '40px', 
                                            color: '#666', 
                                            fontStyle: 'italic',
                                            border: '2px dashed #ddd',
                                            borderRadius: '8px'
                                        }}>
                                            No transactions recorded yet. Transactions are automatically created when you add a property.
                                        </div>
                                    )}
                                </div>
                                
                                {/* Expense Modal */}
                                {showExpenseModal && (
                                    <div className="expense-modal" onClick={() => {
                                        setShowExpenseModal(false);
                                        setEditingExpense(null);
                                        setIsEditMode(false);
                                    }}>
                                        <div className="expense-modal-content" onClick={(e) => e.stopPropagation()}>
                                            <div style={{
                                                display: 'flex',
                                                justifyContent: 'space-between',
                                                alignItems: 'center',
                                                marginBottom: '20px',
                                                borderBottom: '1px solid #ddd',
                                                paddingBottom: '10px'
                                            }}>
                                                <h3 style={{margin: 0}}>Expense Details</h3>
                                                <button 
                                                    onClick={() => {
                                                        setShowExpenseModal(false);
                                                        setEditingExpense(null);
                                                        setIsEditMode(false);
                                                    }}
                                                    style={{
                                                        background: '#dc3545',
                                                        color: 'white',
                                                        border: 'none',
                                                        borderRadius: '4px',
                                                        padding: '5px 10px',
                                                        cursor: 'pointer'
                                                    }}
                                                >
                                                    
                                                </button>
                                            </div>
                                            <div>
                                                {selectedTransactionExpenses.map(expense => (
                                                    <div key={expense.id} style={{
                                                        padding: '10px',
                                                        marginBottom: '10px',
                                                        border: '1px solid #ddd',
                                                        borderRadius: '4px',
                                                        backgroundColor: '#f8f9fa'
                                                    }}>
                                                        {editingExpense?.id === expense.id ? (
                                                            // Edit Form
                                                            <div className="expense-edit-form">
                                                                <div className="edit-form-row">
                                                                    <div className="edit-form-field">
                                                                        <label>Category:</label>
                                                                        <select
                                                                            value={editingExpense.category}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, category: e.target.value})}
                                                                        >
                                                                            <option value="Travel">Travel</option>
                                                                            <option value="Staging">Staging</option>
                                                                            <option value="Meals">Meals</option>
                                                                            <option value="Professional Photography/Drone">Professional Photography/Drone</option>
                                                                            <option value="Junk Removal">Junk Removal</option>
                                                                            <option value="Repairs">Repairs</option>
                                                                            <option value="Marketing">Marketing</option>
                                                                            <option value="Office">Office</option>
                                                                            <option value="Professional Development">Professional Development</option>
                                                                            <option value="Other">Other</option>
                                                                        </select>
                                                                    </div>
                                                                    <div className="edit-form-field">
                                                                        <label>Amount ($):</label>
                                                                        <input
                                                                            type="number"
                                                                            value={editingExpense.amount}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, amount: parseFloat(e.target.value) || 0})}
                                                                            step="0.01"
                                                                        />
                                                                    </div>
                                                                    <div className="edit-form-field">
                                                                        <label>Hours Worked:</label>
                                                                        <input
                                                                            type="number"
                                                                            value={editingExpense.hoursWorked || 0}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, hoursWorked: parseFloat(e.target.value) || 0})}
                                                                            step="0.25"
                                                                            placeholder="0"
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <div className="edit-form-row">
                                                                    <div className="edit-form-field">
                                                                        <label>Description:</label>
                                                                        <textarea
                                                                            value={editingExpense.description}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, description: e.target.value})}
                                                                            rows="2"
                                                                            placeholder="Expense description"
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <div className="edit-form-row">
                                                                    <div className="edit-form-field">
                                                                        <label>Vendor:</label>
                                                                        <input
                                                                            type="text"
                                                                            value={editingExpense.vendor || ''}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, vendor: e.target.value})}
                                                                            placeholder="Vendor name"
                                                                        />
                                                                    </div>
                                                                    <div className="edit-form-field">
                                                                        <label>Date:</label>
                                                                        <input
                                                                            type="date"
                                                                            value={editingExpense.date}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, date: e.target.value})}
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <div className="edit-buttons">
                                                                    <button
                                                                        className="edit-btn cancel"
                                                                        onClick={() => {
                                                                            setEditingExpense(null);
                                                                            setIsEditMode(false);
                                                                        }}
                                                                    >
                                                                        Cancel
                                                                    </button>
                                                                    <button
                                                                        className="edit-btn save"
                                                                        onClick={() => {
                                                                            updateExpense(editingExpense.id, editingExpense);
                                                                            setEditingExpense(null);
                                                                            setIsEditMode(false);
                                                                        }}
                                                                    >
                                                                        Save Changes
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        ) : (
                                                            // View Mode
                                                            <>
                                                                <div className="expense-item-header">
                                                                    <div style={{display: 'flex', justifyContent: 'space-between', width: '100%'}}>
                                                                        <strong>{expense.category}</strong>
                                                                        <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}>
                                                                            <strong style={{color: '#007bff'}}>${expense.amount.toLocaleString()}</strong>
                                                                            <button
                                                                                className="edit-expense-btn"
                                                                                onClick={() => {
                                                                                    setEditingExpense({...expense});
                                                                                    setIsEditMode(true);
                                                                                }}
                                                                            >
                                                                                Edit
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div style={{color: '#666', fontSize: '14px', marginBottom: '3px'}}>
                                                                    {expense.description}
                                                                </div>
                                                                {expense.vendor && (
                                                                    <div style={{color: '#666', fontSize: '12px', marginBottom: '3px'}}>
                                                                        Vendor: {expense.vendor}
                                                                    </div>
                                                                )}
                                                                {expense.hoursWorked && expense.hoursWorked > 0 && (
                                                                    <div style={{color: '#666', fontSize: '12px', marginBottom: '3px'}}>
                                                                        Hours Worked: {expense.hoursWorked} hrs
                                                                        {hourlyWage > 0 && (
                                                                            <span style={{color: '#28a745', marginLeft: '10px'}}>
                                                                                (Labor Value: ${(expense.hoursWorked * hourlyWage).toFixed(2)})
                                                                            </span>
                                                                        )}
                                                                    </div>
                                                                )}
                                                                <div style={{color: '#666', fontSize: '12px'}}>
                                                                    Date: {expense.date}
                                                                </div>
                                                            </>
                                                        )}
                                                    </div>
                                                ))}
                                                <div style={{
                                                    marginTop: '15px',
                                                    padding: '10px',
                                                    backgroundColor: '#e8f5e8',
                                                    borderRadius: '4px',
                                                    textAlign: 'center'
                                                }}>
                                                    <strong>Total Expenses: ${selectedTransactionExpenses.reduce((sum, exp) => sum + exp.amount, 0).toLocaleString()}</strong>
                                                    {selectedTransactionExpenses.some(exp => exp.hoursWorked && exp.hoursWorked > 0) && (
                                                        <div style={{marginTop: '5px', fontSize: '14px'}}>
                                                            Total Hours: {selectedTransactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0)} hrs
                                                            {hourlyWage > 0 && (
                                                                <span style={{color: '#28a745', marginLeft: '10px'}}>
                                                                    (Total Labor Value: ${(selectedTransactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0) * hourlyWage).toFixed(2)})
                                                                </span>
                                                            )}
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}
                    
                    {/* Dashboard Tab */}
                    {activeTab === 'dashboard' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}> Dashboard Overview</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Your real-time performance metrics and key business indicators</p>
                            </div>
                            <div className="grid">
                                <div className="tile">
                                    <h4>Today's Calls</h4>
                                    <p>{calls.made}</p>
                                    <small>Calls made today</small>
                                </div>
                                <div className="tile">
                                    <h4>Call Success Rate</h4>
                                    <p>{calls.made > 0 ? Math.round((calls.answered / calls.made) * 100) : 0}%</p>
                                    <small>Answered calls rate</small>
                                </div>
                                <div className="tile">
                                    <h4>Appointments Today</h4>
                                    <p>{appointments.filter(a => a.date === selectedDate).length}</p>
                                    <small>Scheduled appointments</small>
                                </div>
                                <div className="tile">
                                    <h4>Monthly Progress</h4>
                                    <p>{Math.round((totalCommission / gciData.gciGoal) * 100)}%</p>
                                    <small>Progress toward annual goal</small>
                                </div>
                            </div>
                            
                            <div className="alert alert-info">
                                <strong>Quick Stats:</strong> You have {properties.filter(p => p.status === 'Active').length} active listings, 
                                {properties.filter(p => p.status === 'Pending').length} pending sales, and have earned 
                                ${totalCommission.toLocaleString()} in commission this year.
                            </div>
                        </div>
                    )}
                    
                    {/* Expenses Tab */}
                    {activeTab === 'expenses' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}> Expense Tracking</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Monitor your business expenses and track profitability across all properties</p>
                            </div>
                            
                            {/* Information note */}
                            <div style={{
                                background: '#e8f4f8',
                                border: '1px solid #bee5eb',
                                borderRadius: '8px',
                                padding: '15px',
                                marginBottom: '20px',
                                color: '#0c5460'
                            }} className="info-note">
                                <strong> Tip:</strong> View individual property expenses in the <strong>Transactions</strong> tab by clicking the "View" button on each transaction card.
                            </div>
                            
                            <div className="grid">
                                <div className="tile">
                                    <h4>Total Expenses</h4>
                                    <p>${expenses.reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>All expenses combined</small>
                                </div>
                                
                                <div className="tile hourly-wage-tile">
                                    <h4>Actual Hourly Wage</h4>
                                    <p>
                                        {(() => {
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                            const actualHourlyWage = totalHours > 0 ? totalCommission / totalHours : 0;
                                            return actualHourlyWage > 0 ? `$${actualHourlyWage.toFixed(2)}` : '$0.00';
                                        })()}
                                    </p>
                                    <small>
                                        {(() => {
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                            return `$${totalCommission.toLocaleString()}  ${totalHours} hours`;
                                        })()}
                                    </small>
                                </div>
                                
                                <div className="tile labor-value-tile">
                                    <h4>Labor Value</h4>
                                    <p>
                                        {(() => {
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            return `$${(totalHours * hourlyWage).toLocaleString()}`;
                                        })()}
                                    </p>
                                    <small>
                                        Total hours: {Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0)}<br/>
                                        @ ${hourlyWage}/hour
                                    </small>
                                </div>
                                
                                <div className="tile roi-tile">
                                    <h4>Effective Hourly Wage</h4>
                                    <p>
                                        {(() => {
                                            const effectiveWage = calculateEffectiveHourlyWage();
                                            return effectiveWage > 0 ? `$${effectiveWage.toFixed(2)}` : '$0.00';
                                        })()}
                                    </p>
                                    <small>
                                        {(() => {
                                            const closedTransactions = transactions.filter(t => t.status === 'Closed');
                                            const totalCommission = closedTransactions.reduce((sum, t) => sum + t.commission, 0);
                                            const closedTransactionExpenses = expenses.filter(expense => {
                                                if (!expense.propertyId) return false;
                                                const property = properties.find(p => p.id === expense.propertyId);
                                                return property && property.status === 'Closed';
                                            });
                                            const totalHours = closedTransactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0);
                                            
                                            return totalHours > 0 
                                                ? `${totalHours}hrs / $${totalCommission.toLocaleString()}`
                                                : 'No hours logged on closed deals';
                                        })()}
                                    </small>
                                </div>
                                
                                <div className="tile">
                                    <h4>This Week's Expenses</h4>
                                    <p>
                                        {(() => {
                                            const weekExpenses = getCurrentWeekExpenses();
                                            const total = weekExpenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                                            return `$${total.toLocaleString()}`;
                                        })()}
                                    </p>
                                    <small>
                                        {(() => {
                                            const weekExpenses = getCurrentWeekExpenses();
                                            const totalHours = weekExpenses.reduce((sum, e) => sum + (e.hoursWorked || 0), 0);
                                            return `${weekExpenses.length} expense(s) | ${totalHours}hrs`;
                                        })()}
                                    </small>
                                </div>
                                
                                <div className="tile">
                                    <h4>This Month's Expenses</h4>
                                    <p>
                                        {(() => {
                                            const monthExpenses = getCurrentMonthExpenses();
                                            const total = monthExpenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                                            return `$${total.toLocaleString()}`;
                                        })()}
                                    </p>
                                    <small>
                                        {(() => {
                                            const monthExpenses = getCurrentMonthExpenses();
                                            const totalHours = monthExpenses.reduce((sum, e) => sum + (e.hoursWorked || 0), 0);
                                            return `${monthExpenses.length} expense(s) | ${totalHours}hrs`;
                                        })()}
                                    </small>
                                </div>
                                
                                <div className="tile">
                                    <h4>Travel</h4>
                                    <p>${expenses.filter(e => e.category === 'Travel').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Travel').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Staging</h4>
                                    <p>${expenses.filter(e => e.category === 'Staging').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Staging').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Meals</h4>
                                    <p>${expenses.filter(e => e.category === 'Meals').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Meals').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Photography/Drone</h4>
                                    <p>${expenses.filter(e => e.category === 'Professional Photography/Drone').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Professional Photography/Drone').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Junk Removal</h4>
                                    <p>${expenses.filter(e => e.category === 'Junk Removal').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Junk Removal').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Repairs</h4>
                                    <p>${expenses.filter(e => e.category === 'Repairs').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Repairs').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Marketing</h4>
                                    <p>${expenses.filter(e => e.category === 'Marketing').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Marketing').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Office</h4>
                                    <p>${expenses.filter(e => e.category === 'Office').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Office').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Professional Dev</h4>
                                    <p>${expenses.filter(e => e.category === 'Professional Development').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Professional Development').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Other</h4>
                                    <p>${expenses.filter(e => e.category === 'Other').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Other').length} expense(s)</small>
                                </div>
                                <div className="tile roi-tile">
                                    <h4>ROI Calculation</h4>
                                    <p>
                                        {(() => {
                                            const totalRevenue = totalCommission;
                                            const totalExpenses = expenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const laborCost = totalHours * hourlyWage;
                                            const totalCosts = totalExpenses + laborCost;
                                            const roi = totalCosts > 0 ? ((totalRevenue - totalCosts) / totalCosts) * 100 : 0;
                                            return `${roi.toFixed(1)}%`;
                                        })()}
                                    </p>
                                    <small>
                                        Revenue: ${totalCommission.toLocaleString()}<br/>
                                        Expenses: ${expenses.reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}<br/>
                                        Labor Cost: ${(() => {
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            return (totalHours * hourlyWage).toLocaleString();
                                        })()}<br/>
                                        Net Profit: ${(() => {
                                            const totalExpenses = expenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const laborCost = totalHours * hourlyWage;
                                            return (totalCommission - totalExpenses - laborCost).toLocaleString();
                                        })()}
                                    </small>
                                </div>
                            </div>
                            
                            <div className="form-section">
                                <h3>Add New Expense</h3>
                                <form onSubmit={(e) => {
                                    e.preventDefault();
                                    const formData = new FormData(e.target);
                                    const expenseData = {
                                        date: formData.get('date'),
                                        propertyId: selectedPropertyForExpense?.id || null,
                                        propertyAddress: selectedPropertyForExpense?.address || 'General Business',
                                        category: formData.get('category'),
                                        amount: parseFloat(formData.get('amount')),
                                        hoursWorked: parseFloat(formData.get('hoursWorked')) || 0,
                                        description: formData.get('description'),
                                        vendor: formData.get('vendor') || ''
                                    };
                                    addExpense(expenseData);
                                    e.target.reset();
                                    setSelectedPropertyForExpense(null);
                                    alert('Expense added successfully!');
                                }}>
                                    <div className="form-group">
                                        <label>Date</label>
                                        <input type="date" name="date" defaultValue={new Date().toISOString().split('T')[0]} required />
                                    </div>
                                    <div className="form-group">
                                        <label>Property (Optional)</label>
                                        <div className="property-house-tiles">
                                            {properties.map(property => (
                                                <div 
                                                    key={property.id}
                                                    className={`property-house-tile ${selectedPropertyForExpense?.id === property.id ? 'selected' : ''}`}
                                                    onClick={() => setSelectedPropertyForExpense(property)}
                                                >
                                                    <div className="address">{property.address}</div>
                                                    <div className="client">{property.client}</div>
                                                </div>
                                            ))}
                                        </div>
                                        {selectedPropertyForExpense && (
                                            <small style={{color: '#007bff', marginTop: '5px', display: 'block'}}>
                                                Selected: {selectedPropertyForExpense.address}
                                            </small>
                                        )}
                                    </div>
                                    <div className="form-group">
                                        <label>Category</label>
                                        <select name="category" required onChange={(e) => toggleMileageCalculator(e.target.value)}>
                                            <option value="">Select category</option>
                                            <option value="Travel">Travel</option>
                                            <option value="Staging">Staging</option>
                                            <option value="Meals">Meals</option>
                                            <option value="Professional Photography/Drone">Professional Photography/Drone</option>
                                            <option value="Junk Removal">Junk Removal</option>
                                            <option value="Repairs">Repairs</option>
                                            <option value="Marketing">Marketing</option>
                                            <option value="Office">Office</option>
                                            <option value="Professional Development">Professional Development</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Amount</label>
                                        <input type="number" name="amount" placeholder="Enter amount" step="0.01" required />
                                    </div>
                                    <div className="form-group">
                                        <label>Hours Worked (Optional)</label>
                                        <input 
                                            type="number" 
                                            name="hoursWorked" 
                                            placeholder="Enter hours worked" 
                                            step="0.25" 
                                            min="0"
                                            style={{width: '100%'}}
                                        />
                                        <small style={{color: '#666', fontSize: '12px', display: 'block', marginTop: '5px'}}>
                                            Track hours for labor value calculation (${hourlyWage}/hour)
                                        </small>
                                    </div>
                                    
                                    {/* Mileage Calculator - Only show for Travel category */}
                                    <div id="mileageCalculator" style={{display: 'none', border: '1px solid #ddd', borderRadius: '8px', padding: '15px', marginBottom: '15px', backgroundColor: '#f8f9fa'}}>
                                        <h4 style={{margin: '0 0 15px 0', color: '#495057'}}>Mileage Calculator</h4>
                                        <div className="form-group">
                                            <label>Mileage (miles)</label>
                                            <input 
                                                type="number" 
                                                id="mileageInput" 
                                                placeholder="Enter mileage" 
                                                step="0.1"
                                                onChange={() => calculateMileageCost()}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>Gas Price (per gallon)</label>
                                            <input 
                                                type="number" 
                                                id="gasPriceInput" 
                                                placeholder="Enter current gas price" 
                                                step="0.01"
                                                onChange={() => calculateMileageCost()}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>Miles Per Gallon (MPG)</label>
                                            <input 
                                                type="number" 
                                                id="mpgInput" 
                                                placeholder="20" 
                                                defaultValue="20"
                                                step="0.1"
                                                onChange={() => calculateMileageCost()}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>Calculated Mileage Cost</label>
                                            <input 
                                                type="text" 
                                                id="calculatedCost" 
                                                placeholder="Auto-calculated" 
                                                disabled 
                                                style={{backgroundColor: '#e9ecef'}}
                                            />
                                        </div>
                                        <button 
                                            type="button" 
                                            className="btn" 
                                            style={{backgroundColor: '#17a2b8', marginTop: '10px'}}
                                            onClick={() => {
                                                const calculatedAmount = document.getElementById('calculatedCost').value;
                                                if (calculatedAmount && calculatedAmount !== 'Auto-calculated') {
                                                    document.querySelector('input[name="amount"]').value = calculatedAmount.replace('$', '');
                                                    alert('Calculated mileage cost applied to amount field!');
                                                }
                                            }}
                                        >
                                            Use Calculated Amount
                                        </button>
                                    </div>
                                    <div className="form-group">
                                        <label>Vendor/Company</label>
                                        <input type="text" name="vendor" placeholder="Enter vendor or company name" />
                                    </div>
                                    <div className="form-group">
                                        <label>Description</label>
                                        <input type="text" name="description" placeholder="Enter description" />
                                    </div>
                                    <button type="submit" className="btn">Add Expense</button>
                                </form>
                            </div>
                        </div>
                    )}
                    
                    {/* Reports Tab */}
                    {activeTab === 'reports' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}> Reports & Analytics</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Generate comprehensive reports and analyze your business performance</p>
                            </div>
                            
                            <div className="grid">
                                <div className="tile" onClick={() => {
                                    setCurrentReport(generateExpenseReport());
                                    setShowReportModal(true);
                                }} style={{cursor: 'pointer'}}>
                                    <h4> Expense Report</h4>
                                    <p>Detailed Analysis</p>
                                    <small>Complete expense breakdown by category</small>
                                </div>
                                
                                <div className="tile" onClick={() => {
                                    setCurrentReport(generateWeeklyReport());
                                    setShowReportModal(true);
                                }} style={{cursor: 'pointer'}}>
                                    <h4> Weekly Report</h4>
                                    <p>7-Day Summary</p>
                                    <small>Activities, goals, and performance</small>
                                </div>
                                
                                <div className="tile" onClick={() => {
                                    setCurrentReport(generateDailyReport());
                                    setShowReportModal(true);
                                }} style={{cursor: 'pointer'}}>
                                    <h4> Daily Report</h4>
                                    <p>Today's Activities</p>
                                    <small>Daily performance and tasks</small>
                                </div>
                            </div>
                            
                            <div style={{marginTop: '30px', padding: '20px', background: '#f8f9fa', borderRadius: '8px'}}>
                                <h3>Report Features</h3>
                                <ul style={{marginBottom: 0}}>
                                    <li><strong>Print Ready:</strong> All reports are formatted for printing</li>
                                    <li><strong>Export Options:</strong> Save as PDF using browser print function</li>
                                    <li><strong>Real-time Data:</strong> Reports reflect current data state</li>
                                    <li><strong>Comprehensive:</strong> Includes expenses, goals, and performance metrics</li>
                                </ul>
                            </div>
                        </div>
                    )}
                    
                    {/* GCI Calculator Tab */}
                    {activeTab === 'gci' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}> GCI Calculator & Deal Planning</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Calculate your income goals and plan the deals needed to achieve them</p>
                            </div>
                            <div className="grid">
                                <div className="tile">
                                    <h4>Desired Annual GCI</h4>
                                    <p>${gciCalculator.desiredGCI.toLocaleString()}</p>
                                    <small>Target for this year</small>
                                </div>
                                <div className="tile">
                                    <h4>Current GCI</h4>
                                    <p>${totalCommission.toLocaleString()}</p>
                                    <small>Year-to-date commission</small>
                                </div>
                                <div className="tile">
                                    <h4>Remaining Goal</h4>
                                    <p>${Math.max(0, gciCalculator.desiredGCI - totalCommission).toLocaleString()}</p>
                                    <small>Still needed</small>
                                </div>
                                <div className="tile">
                                    <h4>Progress</h4>
                                    <p>{Math.round((totalCommission / gciCalculator.desiredGCI) * 100)}%</p>
                                    <small>Toward annual goal</small>
                                </div>
                            </div>
                            
                            <div className="form-section" style={{borderRadius: '12px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)', background: 'white', border: '1px solid #e9ecef'}}>
                                <div style={{display: 'flex', alignItems: 'center', marginBottom: '20px'}}>
                                    <span style={{fontSize: '24px', marginRight: '10px'}}></span>
                                    <h3 style={{margin: 0}}>Deal Calculator</h3>
                                </div>
                                <form onSubmit={(e) => {
                                    e.preventDefault();
                                    const formData = new FormData(e.target);
                                    const avgPrice = parseFloat(formData.get('averageSalePrice')) || 0;
                                    const commissionRate = parseFloat(formData.get('commissionRate')) || 0;
                                    const avgCommissionPerDeal = parseFloat(formData.get('averageCommissionPerDeal')) || null;
                                    const desiredGCI = parseFloat(formData.get('desiredGCI')) || 0;
                                    
                                    // Calculate commission per deal
                                    const finalCommissionPerDeal = avgCommissionPerDeal || (avgPrice * commissionRate) / 100;
                                    
                                    // Calculate deals needed
                                    const dealsNeeded = finalCommissionPerDeal > 0 ? Math.ceil(desiredGCI / finalCommissionPerDeal) : 0;
                                    
                                    setGciCalculator({
                                        averageSalePrice: avgPrice,
                                        commissionRate: commissionRate,
                                        averageCommissionPerDeal: finalCommissionPerDeal,
                                        desiredGCI: desiredGCI,
                                        dealsNeeded: dealsNeeded
                                    });
                                }}>
                                    <div style={{display: 'grid', gridTemplateColumns: window.innerWidth > 768 ? '1fr 1fr' : '1fr', gap: '20px'}}>
                                        
                                        {/* Input Fields Section */}
                                        <div style={{padding: '15px', background: '#f8f9fa', borderRadius: '8px', border: '1px solid #e9ecef'}}>
                                            <h4 style={{margin: '0 0 15px 0', color: '#495057'}}> Deal Parameters</h4>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Average Sale Price</label>
                                                <input 
                                                    type="number" 
                                                    name="averageSalePrice"
                                                    defaultValue={gciCalculator.averageSalePrice}
                                                    placeholder="Enter average sale price"
                                                    style={{borderRadius: '6px'}}
                                                    onChange={(e) => {
                                                        // Auto-calculate when price changes
                                                        const form = e.target.form;
                                                        const avgPrice = parseFloat(e.target.value) || 0;
                                                        const commissionRate = parseFloat(form.commissionRate.value) || 0;
                                                        const avgCommissionPerDeal = parseFloat(form.averageCommissionPerDeal.value) || null;
                                                        const desiredGCI = parseFloat(form.desiredGCI.value) || 0;
                                                        
                                                        if (avgPrice && commissionRate && desiredGCI) {
                                                            const newCommissionPerDeal = avgCommissionPerDeal || (avgPrice * commissionRate) / 100;
                                                            const dealsNeeded = newCommissionPerDeal > 0 ? Math.ceil(desiredGCI / newCommissionPerDeal) : 0;
                                                            setGciCalculator(prev => ({
                                                                ...prev,
                                                                averageSalePrice: avgPrice,
                                                                averageCommissionPerDeal: avgCommissionPerDeal || newCommissionPerDeal,
                                                                dealsNeeded: dealsNeeded
                                                            }));
                                                        }
                                                    }}
                                                    required
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Commission Rate (%)</label>
                                                <input 
                                                    type="number" 
                                                    name="commissionRate"
                                                    defaultValue={gciCalculator.commissionRate}
                                                    placeholder="Enter commission rate"
                                                    step="0.1"
                                                    style={{borderRadius: '6px'}}
                                                    onChange={(e) => {
                                                        // Auto-calculate when rate changes
                                                        const form = e.target.form;
                                                        const commissionRate = parseFloat(e.target.value) || 0;
                                                        const avgPrice = parseFloat(form.averageSalePrice.value) || 0;
                                                        const avgCommissionPerDeal = parseFloat(form.averageCommissionPerDeal.value) || null;
                                                        const desiredGCI = parseFloat(form.desiredGCI.value) || 0;
                                                        
                                                        if (commissionRate && avgPrice && desiredGCI) {
                                                            const newCommissionPerDeal = avgCommissionPerDeal || (avgPrice * commissionRate) / 100;
                                                            const dealsNeeded = newCommissionPerDeal > 0 ? Math.ceil(desiredGCI / newCommissionPerDeal) : 0;
                                                            setGciCalculator(prev => ({
                                                                ...prev,
                                                                commissionRate: commissionRate,
                                                                averageCommissionPerDeal: avgCommissionPerDeal || newCommissionPerDeal,
                                                                dealsNeeded: dealsNeeded
                                                            }));
                                                        }
                                                    }}
                                                    required
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Average Commission Per Deal (Override)</label>
                                                <input 
                                                    type="number" 
                                                    name="averageCommissionPerDeal"
                                                    defaultValue={gciCalculator.averageCommissionPerDeal}
                                                    placeholder="Optional: Manual commission per deal"
                                                    step="0.01"
                                                    style={{borderRadius: '6px'}}
                                                    onChange={(e) => {
                                                        // Auto-calculate when manual commission changes
                                                        const form = e.target.form;
                                                        const avgCommissionPerDeal = parseFloat(e.target.value) || null;
                                                        const desiredGCI = parseFloat(form.desiredGCI.value) || 0;
                                                        const avgPrice = parseFloat(form.averageSalePrice.value) || 0;
                                                        const commissionRate = parseFloat(form.commissionRate.value) || 0;
                                                        
                                                        if (desiredGCI) {
                                                            const finalCommissionPerDeal = avgCommissionPerDeal || (avgPrice * commissionRate) / 100;
                                                            const dealsNeeded = finalCommissionPerDeal > 0 ? Math.ceil(desiredGCI / finalCommissionPerDeal) : 0;
                                                            setGciCalculator(prev => ({
                                                                ...prev,
                                                                averageCommissionPerDeal: avgCommissionPerDeal || finalCommissionPerDeal,
                                                                dealsNeeded: dealsNeeded
                                                            }));
                                                        }
                                                    }}
                                                />
                                                <small style={{color: '#666', fontStyle: 'italic'}}>Leave blank to auto-calculate from price  rate</small>
                                            </div>
                                            <div className="form-group">
                                                <label style={{fontWeight: '500'}}>Desired Annual GCI</label>
                                                <input 
                                                    type="number" 
                                                    name="desiredGCI"
                                                    defaultValue={gciCalculator.desiredGCI}
                                                    placeholder="Enter desired GCI"
                                                    style={{borderRadius: '6px'}}
                                                    onChange={(e) => {
                                                        // Auto-calculate when GCI goal changes
                                                        const form = e.target.form;
                                                        const desiredGCI = parseFloat(e.target.value) || 0;
                                                        const avgCommissionPerDeal = parseFloat(form.averageCommissionPerDeal.value) || null;
                                                        const avgPrice = parseFloat(form.averageSalePrice.value) || 0;
                                                        const commissionRate = parseFloat(form.commissionRate.value) || 0;
                                                        
                                                        if (desiredGCI) {
                                                            const finalCommissionPerDeal = avgCommissionPerDeal || (avgPrice * commissionRate) / 100;
                                                            const dealsNeeded = finalCommissionPerDeal > 0 ? Math.ceil(desiredGCI / finalCommissionPerDeal) : 0;
                                                            setGciCalculator(prev => ({
                                                                ...prev,
                                                                desiredGCI: desiredGCI,
                                                                dealsNeeded: dealsNeeded
                                                            }));
                                                        }
                                                    }}
                                                    required
                                                />
                                            </div>
                                            <button type="submit" className="btn" style={{
                                                background: 'linear-gradient(135deg, #009688, #00695c)',
                                                borderRadius: '8px',
                                                padding: '10px 20px',
                                                fontWeight: '500',
                                                marginTop: '15px',
                                                width: '100%'
                                            }}> Calculate Deals Needed</button>
                                        </div>
                                        
                                        {/* Results Section */}
                                        <div style={{padding: '15px', background: '#f8f9fa', borderRadius: '8px', border: '1px solid #e9ecef'}}>
                                            <h4 style={{margin: '0 0 15px 0', color: '#495057'}}> Calculation Results</h4>
                                            <div style={{marginBottom: '10px'}}>
                                                <strong>Commission per Deal:</strong><br/>
                                                <span style={{fontSize: '1.2em', color: '#007bff'}}>
                                                    ${(gciCalculator.averageCommissionPerDeal || ((gciCalculator.averageSalePrice * gciCalculator.commissionRate) / 100)).toLocaleString()}
                                                </span>
                                                <br/>
                                                <small style={{color: '#666'}}>
                                                    {gciCalculator.averageCommissionPerDeal ? 'Manual override' : 'Calculated from price  rate'}
                                                </small>
                                            </div>
                                            <div style={{marginBottom: '10px'}}>
                                                <strong>Deals Needed:</strong><br/>
                                                <span style={{fontSize: '1.5em', color: '#28a745', fontWeight: 'bold'}}>
                                                    {gciCalculator.dealsNeeded} deals
                                                </span>
                                            </div>
                                            <div style={{marginBottom: '10px'}}>
                                                <strong>Deals per Month:</strong><br/>
                                                <span style={{fontSize: '1.2em', color: '#17a2b8'}}>
                                                    {Math.ceil(gciCalculator.dealsNeeded / 12)} deals/month
                                                </span>
                                            </div>
                                            <div>
                                                <strong>Deals per Quarter:</strong><br/>
                                                <span style={{fontSize: '1.2em', color: '#6f42c1'}}>
                                                    {Math.ceil(gciCalculator.dealsNeeded / 4)} deals/quarter
                                                </span>
                                            </div>
                                        </div>
                                        
                                    </div>
                                </form>
                            </div>
                            
                            <div className="form-section" style={{borderRadius: '12px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)', background: 'white', border: '1px solid #e9ecef'}}>
                                <div style={{display: 'flex', alignItems: 'center', marginBottom: '20px'}}>
                                    <span style={{fontSize: '24px', marginRight: '10px'}}></span>
                                    <h3 style={{margin: 0}}>GCI Progress Tracking</h3>
                                </div>
                                <div className="progress-bar">
                                    <div className="progress-fill" style={{width: `${Math.min((totalCommission / gciCalculator.desiredGCI) * 100, 100)}%`}}></div>
                                </div>
                                <p style={{textAlign: 'center', marginTop: '10px'}}>
                                    {Math.round((totalCommission / gciCalculator.desiredGCI) * 100)}% Complete - ${totalCommission.toLocaleString()} of ${gciCalculator.desiredGCI.toLocaleString()} goal
                                </p>
                                
                                <div style={{marginTop: '20px', display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '15px'}}>
                                    <div style={{textAlign: 'center', padding: '15px', backgroundColor: '#e3f2fd', borderRadius: '8px'}}>
                                        <h5>Deals Closed</h5>
                                        <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#1976d2'}}>
                                            {closedDeals.length}
                                        </div>
                                        <small>of {gciCalculator.dealsNeeded} needed</small>
                                    </div>
                                    <div style={{textAlign: 'center', padding: '15px', backgroundColor: '#f3e5f5', borderRadius: '8px'}}>
                                        <h5>Deals Remaining</h5>
                                        <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#7b1fa2'}}>
                                            {Math.max(0, gciCalculator.dealsNeeded - closedDeals.length)}
                                        </div>
                                        <small>to reach goal</small>
                                    </div>
                                    <div style={{textAlign: 'center', padding: '15px', backgroundColor: '#e8f5e8', borderRadius: '8px'}}>
                                        <h5>Monthly Pace</h5>
                                        <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#388e3c'}}>
                                            {Math.ceil(Math.max(0, gciCalculator.dealsNeeded - closedDeals.length) / Math.max(1, 12 - new Date().getMonth()))}
                                        </div>
                                        <small>deals/month needed</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Performance Tab */}
                    {activeTab === 'performance' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{
                                    marginBottom: '10px',
                                    background: 'linear-gradient(135deg, #FFD700, #FFA500)',
                                    backgroundClip: 'text',
                                    WebkitBackgroundClip: 'text',
                                    WebkitTextFillColor: 'transparent',
                                    fontWeight: 'bold'
                                }}> Performance Analytics & Efficiency Dashboard</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Track your efficiency metrics and optimize your business performance with visual insights</p>
                            </div>
                            
                            {/* Enhanced Efficiency Metrics with Visual Indicators */}
                            <div style={{
                                display: 'grid',
                                gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))',
                                gap: '20px',
                                marginBottom: '25px'
                            }}>
                                {/* Call Efficiency - Enhanced with progress bar and color coding */}
                                <div className="tile" style={{
                                    background: (() => {
                                        const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                        const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                        const efficiency = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                        if (efficiency >= 70) return 'linear-gradient(135deg, #d4edda, #a3d977)';
                                        if (efficiency >= 40) return 'linear-gradient(135deg, #fff3cd, #ffeaa7)';
                                        return 'linear-gradient(135deg, #f8d7da, #f5c6cb)';
                                    })(),
                                    border: (() => {
                                        const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                        const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                        const efficiency = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                        if (efficiency >= 70) return '2px solid #28a745';
                                        if (efficiency >= 40) return '2px solid #ffc107';
                                        return '2px solid #dc3545';
                                    })(),
                                    position: 'relative',
                                    overflow: 'hidden',
                                    minHeight: '160px',
                                    padding: '20px'
                                }}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                                        <span style={{fontSize: '28px', marginRight: '12px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '18px', fontWeight: '600'}}>Call Efficiency</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '36px',
                                        fontWeight: 'bold',
                                        margin: '15px 0',
                                        color: (() => {
                                            const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                            const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                            const efficiency = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                            if (efficiency >= 70) return '#155724';
                                            if (efficiency >= 40) return '#856404';
                                            return '#721c24';
                                        })()
                                    }}>
                                        {(() => {
                                            const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                            const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                            return totalCallsMade > 0 ? `${Math.round((totalCallsAnswered / totalCallsMade) * 100)}%` : '0%';
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '100%',
                                        height: '10px',
                                        backgroundColor: 'rgba(255,255,255,0.4)',
                                        borderRadius: '5px',
                                        marginBottom: '15px',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                                const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                                const efficiency = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                                return `${Math.min(efficiency, 100)}%`;
                                            })(),
                                            height: '100%',
                                            backgroundColor: (() => {
                                                const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                                const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                                const efficiency = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                                if (efficiency >= 70) return '#28a745';
                                                if (efficiency >= 40) return '#ffc107';
                                                return '#dc3545';
                                            })(),
                                            borderRadius: '5px',
                                            transition: 'width 0.8s ease',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '500', fontSize: '14px'}}>
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0)} answered / 
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0)} made
                                    </small>
                                </div>
                                
                                {/* Appointment Conversion - Enhanced */}
                                <div className="tile" style={{
                                    background: (() => {
                                        const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                        const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                        const conversion = totalCallsAnswered > 0 ? (totalAppointments / totalCallsAnswered) * 100 : 0;
                                        if (conversion >= 50) return 'linear-gradient(135deg, #d4edda, #a3d977)';
                                        if (conversion >= 25) return 'linear-gradient(135deg, #fff3cd, #ffeaa7)';
                                        return 'linear-gradient(135deg, #f8d7da, #f5c6cb)';
                                    })(),
                                    border: (() => {
                                        const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                        const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                        const conversion = totalCallsAnswered > 0 ? (totalAppointments / totalCallsAnswered) * 100 : 0;
                                        if (conversion >= 50) return '2px solid #28a745';
                                        if (conversion >= 25) return '2px solid #ffc107';
                                        return '2px solid #dc3545';
                                    })(),
                                    position: 'relative',
                                    overflow: 'hidden',
                                    minHeight: '160px',
                                    padding: '20px'
                                }}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                                        <span style={{fontSize: '28px', marginRight: '12px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '18px', fontWeight: '600'}}>Appointment Conversion</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '36px',
                                        fontWeight: 'bold',
                                        margin: '15px 0',
                                        color: (() => {
                                            const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                            const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                            const conversion = totalCallsAnswered > 0 ? (totalAppointments / totalCallsAnswered) * 100 : 0;
                                            if (conversion >= 50) return '#155724';
                                            if (conversion >= 25) return '#856404';
                                            return '#721c24';
                                        })()
                                    }}>
                                        {(() => {
                                            const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                            const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                            return totalCallsAnswered > 0 ? `${Math.round((totalAppointments / totalCallsAnswered) * 100)}%` : '0%';
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '100%',
                                        height: '10px',
                                        backgroundColor: 'rgba(255,255,255,0.4)',
                                        borderRadius: '5px',
                                        marginBottom: '15px',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                                const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                                const conversion = totalCallsAnswered > 0 ? (totalAppointments / totalCallsAnswered) * 100 : 0;
                                                return `${Math.min(conversion, 100)}%`;
                                            })(),
                                            height: '100%',
                                            backgroundColor: (() => {
                                                const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                                const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                                const conversion = totalCallsAnswered > 0 ? (totalAppointments / totalCallsAnswered) * 100 : 0;
                                                if (conversion >= 50) return '#28a745';
                                                if (conversion >= 25) return '#ffc107';
                                                return '#dc3545';
                                            })(),
                                            borderRadius: '5px',
                                            transition: 'width 0.8s ease',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '500', fontSize: '14px'}}>
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0)} appointments / 
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0)} answered calls
                                    </small>
                                </div>
                                
                                {/* Revenue per Hour - Enhanced */}
                                <div className="tile" style={{
                                    background: (() => {
                                        const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                        const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                        const revenuePerHour = totalHours > 0 ? totalCommission / totalHours : 0;
                                        if (revenuePerHour >= 100) return 'linear-gradient(135deg, #d4edda, #a3d977)';
                                        if (revenuePerHour >= 50) return 'linear-gradient(135deg, #fff3cd, #ffeaa7)';
                                        return 'linear-gradient(135deg, #f8d7da, #f5c6cb)';
                                    })(),
                                    border: (() => {
                                        const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                        const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                        const revenuePerHour = totalHours > 0 ? totalCommission / totalHours : 0;
                                        if (revenuePerHour >= 100) return '2px solid #28a745';
                                        if (revenuePerHour >= 50) return '2px solid #ffc107';
                                        return '2px solid #dc3545';
                                    })(),
                                    position: 'relative',
                                    overflow: 'hidden',
                                    minHeight: '160px',
                                    padding: '20px'
                                }}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                                        <span style={{fontSize: '28px', marginRight: '12px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '18px', fontWeight: '600'}}>Revenue per Hour</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '36px',
                                        fontWeight: 'bold',
                                        margin: '15px 0',
                                        color: (() => {
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                            const revenuePerHour = totalHours > 0 ? totalCommission / totalHours : 0;
                                            if (revenuePerHour >= 100) return '#155724';
                                            if (revenuePerHour >= 50) return '#856404';
                                            return '#721c24';
                                        })()
                                    }}>
                                        {(() => {
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                            return totalHours > 0 ? `$${Math.round(totalCommission / totalHours)}` : '$0';
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '100%',
                                        height: '10px',
                                        backgroundColor: 'rgba(255,255,255,0.4)',
                                        borderRadius: '5px',
                                        marginBottom: '15px',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                                const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                                const revenuePerHour = totalHours > 0 ? totalCommission / totalHours : 0;
                                                return `${Math.min((revenuePerHour / 150) * 100, 100)}%`; // Scale to $150/hr as 100%
                                            })(),
                                            height: '100%',
                                            backgroundColor: (() => {
                                                const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                                const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                                const revenuePerHour = totalHours > 0 ? totalCommission / totalHours : 0;
                                                if (revenuePerHour >= 100) return '#28a745';
                                                if (revenuePerHour >= 50) return '#ffc107';
                                                return '#dc3545';
                                            })(),
                                            borderRadius: '5px',
                                            transition: 'width 0.8s ease',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '500', fontSize: '14px'}}>
                                        Commission per hour worked
                                    </small>
                                </div>
                                
                                {/* Deal Conversion - Enhanced */}
                                <div className="tile" style={{
                                    background: (() => {
                                        const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                        const totalClosedDeals = closedDeals.length;
                                        const conversion = totalOffers > 0 ? (totalClosedDeals / totalOffers) * 100 : 0;
                                        if (conversion >= 70) return 'linear-gradient(135deg, #d4edda, #a3d977)';
                                        if (conversion >= 40) return 'linear-gradient(135deg, #fff3cd, #ffeaa7)';
                                        return 'linear-gradient(135deg, #f8d7da, #f5c6cb)';
                                    })(),
                                    border: (() => {
                                        const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                        const totalClosedDeals = closedDeals.length;
                                        const conversion = totalOffers > 0 ? (totalClosedDeals / totalOffers) * 100 : 0;
                                        if (conversion >= 70) return '2px solid #28a745';
                                        if (conversion >= 40) return '2px solid #ffc107';
                                        return '2px solid #dc3545';
                                    })(),
                                    position: 'relative',
                                    overflow: 'hidden',
                                    minHeight: '160px',
                                    padding: '20px'
                                }}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                                        <span style={{fontSize: '28px', marginRight: '12px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '18px', fontWeight: '600'}}>Deal Conversion</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '36px',
                                        fontWeight: 'bold',
                                        margin: '15px 0',
                                        color: (() => {
                                            const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                            const totalClosedDeals = closedDeals.length;
                                            const conversion = totalOffers > 0 ? (totalClosedDeals / totalOffers) * 100 : 0;
                                            if (conversion >= 70) return '#155724';
                                            if (conversion >= 40) return '#856404';
                                            return '#721c24';
                                        })()
                                    }}>
                                        {(() => {
                                            const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                            const totalClosedDeals = closedDeals.length;
                                            return totalOffers > 0 ? `${Math.round((totalClosedDeals / totalOffers) * 100)}%` : '0%';
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '100%',
                                        height: '10px',
                                        backgroundColor: 'rgba(255,255,255,0.4)',
                                        borderRadius: '5px',
                                        marginBottom: '15px',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                                const totalClosedDeals = closedDeals.length;
                                                const conversion = totalOffers > 0 ? (totalClosedDeals / totalOffers) * 100 : 0;
                                                return `${Math.min(conversion, 100)}%`;
                                            })(),
                                            height: '100%',
                                            backgroundColor: (() => {
                                                const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                                const totalClosedDeals = closedDeals.length;
                                                const conversion = totalOffers > 0 ? (totalClosedDeals / totalOffers) * 100 : 0;
                                                if (conversion >= 70) return '#28a745';
                                                if (conversion >= 40) return '#ffc107';
                                                return '#dc3545';
                                            })(),
                                            borderRadius: '5px',
                                            transition: 'width 0.8s ease',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '500', fontSize: '14px'}}>
                                        {closedDeals.length} closed / {Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0)} offers
                                    </small>
                                </div>
                            </div>
                            
                            {/* Pipeline Metrics Section */}
                            <div style={{
                                display: 'grid',
                                gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))',
                                gap: '20px',
                                marginBottom: '25px'
                            }}>
                                <div className="tile roi-tile" style={{
                                    background: (() => {
                                        const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                        const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                        const netProfit = totalCommission - totalExpenses;
                                        const roi = totalExpenses > 0 ? ((netProfit / totalExpenses) * 100) : 0;
                                        if (roi >= 200) return 'linear-gradient(135deg, #d4edda, #a3d977)';
                                        if (roi >= 100) return 'linear-gradient(135deg, #fff3cd, #ffeaa7)';
                                        return 'linear-gradient(135deg, #f8d7da, #f5c6cb)';
                                    })(),
                                    border: (() => {
                                        const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                        const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                        const netProfit = totalCommission - totalExpenses;
                                        const roi = totalExpenses > 0 ? ((netProfit / totalExpenses) * 100) : 0;
                                        if (roi >= 200) return '2px solid #28a745';
                                        if (roi >= 100) return '2px solid #ffc107';
                                        return '2px solid #dc3545';
                                    })(),
                                    minHeight: '160px',
                                    padding: '20px'
                                }}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                                        <span style={{fontSize: '28px', marginRight: '12px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '18px', fontWeight: '600'}}>Business ROI</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '36px',
                                        fontWeight: 'bold',
                                        margin: '15px 0',
                                        color: (() => {
                                            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                            const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                            const netProfit = totalCommission - totalExpenses;
                                            const roi = totalExpenses > 0 ? ((netProfit / totalExpenses) * 100) : 0;
                                            if (roi >= 200) return '#155724';
                                            if (roi >= 100) return '#856404';
                                            return '#721c24';
                                        })()
                                    }}>
                                        {(() => {
                                            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                            const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                            const netProfit = totalCommission - totalExpenses;
                                            const roi = totalExpenses > 0 ? ((netProfit / totalExpenses) * 100) : 0;
                                            return `${Math.round(roi)}%`;
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '100%',
                                        height: '10px',
                                        backgroundColor: 'rgba(255,255,255,0.4)',
                                        borderRadius: '5px',
                                        marginBottom: '15px',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                                const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                                const netProfit = totalCommission - totalExpenses;
                                                const roi = totalExpenses > 0 ? ((netProfit / totalExpenses) * 100) : 0;
                                                return `${Math.min(roi / 3, 100)}%`; // Scale to 300% ROI as 100%
                                            })(),
                                            height: '100%',
                                            backgroundColor: (() => {
                                                const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                                const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                                const netProfit = totalCommission - totalExpenses;
                                                const roi = totalExpenses > 0 ? ((netProfit / totalExpenses) * 100) : 0;
                                                if (roi >= 200) return '#28a745';
                                                if (roi >= 100) return '#ffc107';
                                                return '#dc3545';
                                            })(),
                                            borderRadius: '5px',
                                            transition: 'width 0.8s ease',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '500', fontSize: '14px'}}>
                                        Return on investment
                                    </small>
                                </div>
                                
                                {/* Buyer Pipeline Efficiency - Enhanced */}
                                <div className="tile" style={{
                                    background: (() => {
                                        const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                        const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                        const signedRate = buyerAppts > 0 ? (buyersSigned / buyerAppts) * 100 : 0;
                                        if (signedRate >= 70) return 'linear-gradient(135deg, #e3f2fd, #90caf9)';
                                        if (signedRate >= 40) return 'linear-gradient(135deg, #fff3e0, #ffcc80)';
                                        return 'linear-gradient(135deg, #fce4ec, #f8bbd9)';
                                    })(),
                                    border: (() => {
                                        const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                        const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                        const signedRate = buyerAppts > 0 ? (buyersSigned / buyerAppts) * 100 : 0;
                                        if (signedRate >= 70) return '2px solid #2196f3';
                                        if (signedRate >= 40) return '2px solid #ff9800';
                                        return '2px solid #e91e63';
                                    })(),
                                    minHeight: '160px',
                                    padding: '20px'
                                }}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                                        <span style={{fontSize: '28px', marginRight: '12px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '18px', fontWeight: '600'}}>Buyer Pipeline Efficiency</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '36px',
                                        fontWeight: 'bold',
                                        margin: '15px 0',
                                        color: (() => {
                                            const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                            const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                            const signedRate = buyerAppts > 0 ? (buyersSigned / buyerAppts) * 100 : 0;
                                            if (signedRate >= 70) return '#1565c0';
                                            if (signedRate >= 40) return '#f57c00';
                                            return '#c2185b';
                                        })()
                                    }}>
                                        {(() => {
                                            const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                            const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                            
                                            if (buyerAppts === 0) return '0%';
                                            const signedRate = (buyersSigned / buyerAppts) * 100;
                                            return `${Math.round(signedRate)}%`;
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '100%',
                                        height: '10px',
                                        backgroundColor: 'rgba(255,255,255,0.4)',
                                        borderRadius: '5px',
                                        marginBottom: '15px',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                                const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                                const signedRate = buyerAppts > 0 ? (buyersSigned / buyerAppts) * 100 : 0;
                                                return `${Math.min(signedRate, 100)}%`;
                                            })(),
                                            height: '100%',
                                            backgroundColor: (() => {
                                                const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                                const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                                const signedRate = buyerAppts > 0 ? (buyersSigned / buyerAppts) * 100 : 0;
                                                if (signedRate >= 70) return '#2196f3';
                                                if (signedRate >= 40) return '#ff9800';
                                                return '#e91e63';
                                            })(),
                                            borderRadius: '5px',
                                            transition: 'width 0.8s ease',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '500', fontSize: '14px'}}>
                                        {(() => {
                                            const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                            const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                            return `${buyersSigned} signed / ${buyerAppts} appointments`;
                                        })()}
                                    </small>
                                </div>
                                
                                {/* Buyer Closing Rate - Enhanced */}
                                <div className="tile" style={{
                                    background: (() => {
                                        const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                        const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                        const closingRate = buyersSigned > 0 ? (buyersSold / buyersSigned) * 100 : 0;
                                        if (closingRate >= 80) return 'linear-gradient(135deg, #e8f5e8, #a5d6a7)';
                                        if (closingRate >= 50) return 'linear-gradient(135deg, #fff8e1, #ffcc80)';
                                        return 'linear-gradient(135deg, #ffebee, #ef9a9a)';
                                    })(),
                                    border: (() => {
                                        const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                        const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                        const closingRate = buyersSigned > 0 ? (buyersSold / buyersSigned) * 100 : 0;
                                        if (closingRate >= 80) return '2px solid #4caf50';
                                        if (closingRate >= 50) return '2px solid #ff9800';
                                        return '2px solid #f44336';
                                    })(),
                                    minHeight: '160px',
                                    padding: '20px'
                                }}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                                        <span style={{fontSize: '28px', marginRight: '12px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '18px', fontWeight: '600'}}>Buyer Closing Rate</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '36px',
                                        fontWeight: 'bold',
                                        margin: '15px 0',
                                        color: (() => {
                                            const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                            const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                            const closingRate = buyersSigned > 0 ? (buyersSold / buyersSigned) * 100 : 0;
                                            if (closingRate >= 80) return '#2e7d32';
                                            if (closingRate >= 50) return '#f57c00';
                                            return '#c62828';
                                        })()
                                    }}>
                                        {(() => {
                                            const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                            const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                            
                                            if (buyersSigned === 0) return '0%';
                                            const closingRate = (buyersSold / buyersSigned) * 100;
                                            return `${Math.round(closingRate)}%`;
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '100%',
                                        height: '10px',
                                        backgroundColor: 'rgba(255,255,255,0.4)',
                                        borderRadius: '5px',
                                        marginBottom: '15px',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                                const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                                const closingRate = buyersSigned > 0 ? (buyersSold / buyersSigned) * 100 : 0;
                                                return `${Math.min(closingRate, 100)}%`;
                                            })(),
                                            height: '100%',
                                            backgroundColor: (() => {
                                                const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                                const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                                const closingRate = buyersSigned > 0 ? (buyersSold / buyersSigned) * 100 : 0;
                                                if (closingRate >= 80) return '#4caf50';
                                                if (closingRate >= 50) return '#ff9800';
                                                return '#f44336';
                                            })(),
                                            borderRadius: '5px',
                                            transition: 'width 0.8s ease',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '500', fontSize: '14px'}}>
                                        {(() => {
                                            const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                            const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                            return `${buyersSold} closed / ${buyersSigned} signed`;
                                        })()}
                                    </small>
                                </div>
                                
                                {/* Listing Pipeline Efficiency - Enhanced */}
                                <div className="tile" style={{
                                    background: (() => {
                                        const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                        const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                        const takenRate = listingAppts > 0 ? (listingsTaken / listingAppts) * 100 : 0;
                                        if (takenRate >= 70) return 'linear-gradient(135deg, #f3e5f5, #ce93d8)';
                                        if (takenRate >= 40) return 'linear-gradient(135deg, #fff3e0, #ffb74d)';
                                        return 'linear-gradient(135deg, #ffebee, #ef5350)';
                                    })(),
                                    border: (() => {
                                        const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                        const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                        const takenRate = listingAppts > 0 ? (listingsTaken / listingAppts) * 100 : 0;
                                        if (takenRate >= 70) return '2px solid #9c27b0';
                                        if (takenRate >= 40) return '2px solid #ff9800';
                                        return '2px solid #f44336';
                                    })(),
                                    minHeight: '160px',
                                    padding: '20px'
                                }}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                                        <span style={{fontSize: '28px', marginRight: '12px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '18px', fontWeight: '600'}}>Listing Pipeline Efficiency</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '36px',
                                        fontWeight: 'bold',
                                        margin: '15px 0',
                                        color: (() => {
                                            const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                            const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                            const takenRate = listingAppts > 0 ? (listingsTaken / listingAppts) * 100 : 0;
                                            if (takenRate >= 70) return '#7b1fa2';
                                            if (takenRate >= 40) return '#f57c00';
                                            return '#c62828';
                                        })()
                                    }}>
                                        {(() => {
                                            const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                            const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                            
                                            if (listingAppts === 0) return '0%';
                                            const takenRate = (listingsTaken / listingAppts) * 100;
                                            return `${Math.round(takenRate)}%`;
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '100%',
                                        height: '10px',
                                        backgroundColor: 'rgba(255,255,255,0.4)',
                                        borderRadius: '5px',
                                        marginBottom: '15px',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                                const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                                const takenRate = listingAppts > 0 ? (listingsTaken / listingAppts) * 100 : 0;
                                                return `${Math.min(takenRate, 100)}%`;
                                            })(),
                                            height: '100%',
                                            backgroundColor: (() => {
                                                const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                                const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                                const takenRate = listingAppts > 0 ? (listingsTaken / listingAppts) * 100 : 0;
                                                if (takenRate >= 70) return '#9c27b0';
                                                if (takenRate >= 40) return '#ff9800';
                                                return '#f44336';
                                            })(),
                                            borderRadius: '5px',
                                            transition: 'width 0.8s ease',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '500', fontSize: '14px'}}>
                                        {(() => {
                                            const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                            const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                            return `${listingsTaken} taken / ${listingAppts} appointments`;
                                        })()}
                                    </small>
                                </div>
                                
                                {/* Listing Sale Rate - Enhanced */}
                                <div className="tile" style={{
                                    background: (() => {
                                        const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                        const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                        const soldRate = listingsTaken > 0 ? (listingsSold / listingsTaken) * 100 : 0;
                                        if (soldRate >= 70) return 'linear-gradient(135deg, #e1f5fe, #81d4fa)';
                                        if (soldRate >= 40) return 'linear-gradient(135deg, #fff8e1, #ffcc80)';
                                        return 'linear-gradient(135deg, #fce4ec, #f8bbd9)';
                                    })(),
                                    border: (() => {
                                        const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                        const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                        const soldRate = listingsTaken > 0 ? (listingsSold / listingsTaken) * 100 : 0;
                                        if (soldRate >= 70) return '2px solid #03a9f4';
                                        if (soldRate >= 40) return '2px solid #ff9800';
                                        return '2px solid #e91e63';
                                    })(),
                                    minHeight: '160px',
                                    padding: '20px'
                                }}>
                                    <div style={{display: 'flex', alignItems: 'center', marginBottom: '15px'}}>
                                        <span style={{fontSize: '28px', marginRight: '12px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '18px', fontWeight: '600'}}>Listing Sale Rate</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '36px',
                                        fontWeight: 'bold',
                                        margin: '15px 0',
                                        color: (() => {
                                            const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                            const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                            const soldRate = listingsTaken > 0 ? (listingsSold / listingsTaken) * 100 : 0;
                                            if (soldRate >= 70) return '#0277bd';
                                            if (soldRate >= 40) return '#f57c00';
                                            return '#c2185b';
                                        })()
                                    }}>
                                        {(() => {
                                            const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                            const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                            
                                            if (listingsTaken === 0) return '0%';
                                            const soldRate = (listingsSold / listingsTaken) * 100;
                                            return `${Math.round(soldRate)}%`;
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '100%',
                                        height: '10px',
                                        backgroundColor: 'rgba(255,255,255,0.4)',
                                        borderRadius: '5px',
                                        marginBottom: '15px',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                                const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                                const soldRate = listingsTaken > 0 ? (listingsSold / listingsTaken) * 100 : 0;
                                                return `${Math.min(soldRate, 100)}%`;
                                            })(),
                                            height: '100%',
                                            backgroundColor: (() => {
                                                const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                                const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                                const soldRate = listingsTaken > 0 ? (listingsSold / listingsTaken) * 100 : 0;
                                                if (soldRate >= 70) return '#03a9f4';
                                                if (soldRate >= 40) return '#ff9800';
                                                return '#e91e63';
                                            })(),
                                            borderRadius: '5px',
                                            transition: 'width 0.8s ease',
                                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '500', fontSize: '14px'}}>
                                        {(() => {
                                            const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                            const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                            return `${listingsSold} sold / ${listingsTaken} taken`;
                                        })()}
                                    </small>
                                </div>
                            </div>
                            
                            {/* Overall Efficiency Score - Stand-alone featured metric */}
                            <div style={{
                                display: 'flex',
                                justifyContent: 'center',
                                marginBottom: '30px'
                            }}>
                                <div className="tile" style={{
                                    background: 'linear-gradient(135deg, #fff3cd, #ffeaa7, #fdcb6e)',
                                    border: '3px solid #f39c12',
                                    minHeight: '200px',
                                    padding: '30px',
                                    maxWidth: '400px',
                                    textAlign: 'center',
                                    boxShadow: '0 8px 25px rgba(243, 156, 18, 0.3)',
                                    position: 'relative',
                                    overflow: 'hidden'
                                }}>
                                    <div style={{
                                        position: 'absolute',
                                        top: '-50px',
                                        right: '-50px',
                                        width: '100px',
                                        height: '100px',
                                        background: 'radial-gradient(circle, rgba(255,255,255,0.2), transparent)',
                                        borderRadius: '50%'
                                    }}></div>
                                    <div style={{display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '20px'}}>
                                        <span style={{fontSize: '40px', marginRight: '15px'}}></span>
                                        <h4 style={{margin: 0, color: '#333', fontSize: '24px', fontWeight: '700'}}>Overall Efficiency Score</h4>
                                    </div>
                                    <p style={{
                                        fontSize: '48px',
                                        fontWeight: 'bold',
                                        margin: '20px 0',
                                        color: '#d68910',
                                        textShadow: '2px 2px 4px rgba(0,0,0,0.1)'
                                    }}>
                                        {(() => {
                                            // Calculate comprehensive efficiency score with buyer/listing pipeline
                                            let totalScore = 0;
                                            let scoreComponents = 0;
                                            
                                            // Call efficiency (15% weight)
                                            const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                            const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                            if (totalCallsMade > 0) {
                                                totalScore += (totalCallsAnswered / totalCallsMade) * 15;
                                                scoreComponents += 15;
                                            }
                                            
                                            // Appointment conversion (15% weight)
                                            const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                            if (totalCallsAnswered > 0) {
                                                totalScore += (totalAppointments / totalCallsAnswered) * 15;
                                                scoreComponents += 15;
                                            }
                                            
                                            // Deal conversion (20% weight)
                                            const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                            const totalClosedDeals = closedDeals.length;
                                            if (totalOffers > 0) {
                                                totalScore += (totalClosedDeals / totalOffers) * 20;
                                                scoreComponents += 20;
                                            }
                                            
                                            // Buyer Pipeline Efficiency (15% weight)
                                            const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                            const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                            if (buyerAppts > 0) {
                                                totalScore += (buyersSigned / buyerAppts) * 15;
                                                scoreComponents += 15;
                                            }
                                            
                                            // Buyer Closing Rate (10% weight)
                                            const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                            if (buyersSigned > 0) {
                                                totalScore += (buyersSold / buyersSigned) * 10;
                                                scoreComponents += 10;
                                            }
                                            
                                            // Listing Pipeline Efficiency (15% weight)
                                            const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                            const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                            if (listingAppts > 0) {
                                                totalScore += (listingsTaken / listingAppts) * 15;
                                                scoreComponents += 15;
                                            }
                                            
                                            // Listing Sale Rate (10% weight)
                                            const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                            if (listingsTaken > 0) {
                                                totalScore += (listingsSold / listingsTaken) * 10;
                                                scoreComponents += 10;
                                            }
                                            
                                            // Revenue efficiency (10% weight)
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                            if (totalHours > 0 && totalCommission > 0) {
                                                const revenuePerHour = totalCommission / totalHours;
                                                const revenueScore = Math.min(revenuePerHour / 100, 1);
                                                totalScore += revenueScore * 10;
                                                scoreComponents += 10;
                                            }
                                            
                                            // Business ROI (5% weight)
                                            const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                            if (totalExpenses > 0 && totalCommission > 0) {
                                                const netProfit = totalCommission - totalExpenses;
                                                const roi = netProfit / totalExpenses;
                                                const roiScore = Math.min(Math.max(roi / 2, 0), 1);
                                                totalScore += roiScore * 5;
                                                scoreComponents += 5;
                                            }
                                            
                                            const finalScore = scoreComponents > 0 ? (totalScore / scoreComponents) * 100 : 0;
                                            return `${Math.round(finalScore)}%`;
                                        })()}
                                    </p>
                                    <div style={{
                                        width: '80%',
                                        height: '15px',
                                        backgroundColor: 'rgba(255,255,255,0.5)',
                                        borderRadius: '8px',
                                        margin: '20px auto',
                                        overflow: 'hidden',
                                        boxShadow: 'inset 0 3px 6px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{
                                            width: (() => {
                                                let totalScore = 0;
                                                let scoreComponents = 0;
                                                
                                                const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                                const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                                if (totalCallsMade > 0) {
                                                    totalScore += (totalCallsAnswered / totalCallsMade) * 15;
                                                    scoreComponents += 15;
                                                }
                                                
                                                const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                                if (totalCallsAnswered > 0) {
                                                    totalScore += (totalAppointments / totalCallsAnswered) * 15;
                                                    scoreComponents += 15;
                                                }
                                                
                                                const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                                const totalClosedDeals = closedDeals.length;
                                                if (totalOffers > 0) {
                                                    totalScore += (totalClosedDeals / totalOffers) * 20;
                                                    scoreComponents += 20;
                                                }
                                                
                                                const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                                const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                                if (buyerAppts > 0) {
                                                    totalScore += (buyersSigned / buyerAppts) * 15;
                                                    scoreComponents += 15;
                                                }
                                                
                                                const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                                if (buyersSigned > 0) {
                                                    totalScore += (buyersSold / buyersSigned) * 10;
                                                    scoreComponents += 10;
                                                }
                                                
                                                const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                                const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                                if (listingAppts > 0) {
                                                    totalScore += (listingsTaken / listingAppts) * 15;
                                                    scoreComponents += 15;
                                                }
                                                
                                                const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                                if (listingsTaken > 0) {
                                                    totalScore += (listingsSold / listingsTaken) * 10;
                                                    scoreComponents += 10;
                                                }
                                                
                                                const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                                const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                                if (totalHours > 0 && totalCommission > 0) {
                                                    const revenuePerHour = totalCommission / totalHours;
                                                    const revenueScore = Math.min(revenuePerHour / 100, 1);
                                                    totalScore += revenueScore * 10;
                                                    scoreComponents += 10;
                                                }
                                                
                                                const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                                if (totalExpenses > 0 && totalCommission > 0) {
                                                    const netProfit = totalCommission - totalExpenses;
                                                    const roi = netProfit / totalExpenses;
                                                    const roiScore = Math.min(Math.max(roi / 2, 0), 1);
                                                    totalScore += roiScore * 5;
                                                    scoreComponents += 5;
                                                }
                                                
                                                const finalScore = scoreComponents > 0 ? (totalScore / scoreComponents) * 100 : 0;
                                                return `${Math.min(finalScore, 100)}%`;
                                            })(),
                                            height: '100%',
                                            background: 'linear-gradient(90deg, #f39c12, #e67e22, #d35400)',
                                            borderRadius: '8px',
                                            transition: 'width 1s ease',
                                            boxShadow: '0 3px 6px rgba(0,0,0,0.2)'
                                        }}></div>
                                    </div>
                                    <small style={{color: '#555', fontWeight: '600', fontSize: '16px'}}>
                                        Comprehensive business efficiency with pipeline tracking
                                    </small>
                                </div>
                            </div>
                            
                            {/* Performance Improvement Suggestions */}
                            <div className="form-section" style={{marginTop: '30px'}}>
                                <h3> Performance Improvement Recommendations</h3>
                                
                                <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))', gap: '20px', marginTop: '20px'}}>
                                    {/* Call Efficiency Suggestions */}
                                    <div style={{
                                        border: '1px solid #007bff',
                                        borderRadius: '8px',
                                        padding: '20px',
                                        backgroundColor: '#f8f9ff'
                                    }}>
                                        <h4 style={{color: '#007bff', marginBottom: '15px'}}> Call Performance</h4>
                                        {(() => {
                                            const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                            const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                            const callEfficiency = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                            
                                            if (callEfficiency < 30) {
                                                return (
                                                    <div>
                                                        <p><strong>Current Rate:</strong> {Math.round(callEfficiency)}% (Needs Improvement)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Call during peak hours (10AM-12PM, 2PM-4PM)</li>
                                                            <li>Use a predictive dialer or CRM to filter numbers</li>
                                                            <li>Warm up leads with text/email before calling</li>
                                                            <li>Practice your opening script for better engagement</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else if (callEfficiency < 50) {
                                                return (
                                                    <div>
                                                        <p><strong>Current Rate:</strong> {Math.round(callEfficiency)}% (Good)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Track call times to identify best calling windows</li>
                                                            <li>Segment your leads by source for targeted approaches</li>
                                                            <li>Use social media research before calling</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else {
                                                return (
                                                    <div>
                                                        <p><strong>Current Rate:</strong> {Math.round(callEfficiency)}% (Excellent!)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li> Maintain your current calling strategy</li>
                                                            <li> Consider mentoring other agents</li>
                                                            <li>Focus on appointment conversion now</li>
                                                        </ul>
                                                    </div>
                                                );
                                            }
                                        })()}
                                    </div>
                                    
                                    {/* Revenue Efficiency Suggestions */}
                                    <div style={{
                                        border: '1px solid #28a745',
                                        borderRadius: '8px',
                                        padding: '20px',
                                        backgroundColor: '#f8fff8'
                                    }}>
                                        <h4 style={{color: '#28a745', marginBottom: '15px'}}> Revenue Optimization</h4>
                                        {(() => {
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                            const revenuePerHour = totalHours > 0 ? totalCommission / totalHours : 0;
                                            
                                            if (revenuePerHour < 50) {
                                                return (
                                                    <div>
                                                        <p><strong>Current Rate:</strong> ${Math.round(revenuePerHour)}/hour (Focus Needed)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Focus on higher-value properties ($400K+)</li>
                                                            <li>Negotiate higher commission rates with experience</li>
                                                            <li>Reduce time spent on non-revenue activities</li>
                                                            <li>Track time to identify efficiency gaps</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else if (revenuePerHour < 100) {
                                                return (
                                                    <div>
                                                        <p><strong>Current Rate:</strong> ${Math.round(revenuePerHour)}/hour (Good Progress)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Automate routine tasks with technology</li>
                                                            <li>Build referral network for quality leads</li>
                                                            <li>Specialize in luxury or commercial markets</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else {
                                                return (
                                                    <div>
                                                        <p><strong>Current Rate:</strong> ${Math.round(revenuePerHour)}/hour (Outstanding!)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li> Excellent revenue efficiency</li>
                                                            <li>Consider expanding your team</li>
                                                            <li>Focus on building passive income streams</li>
                                                        </ul>
                                                    </div>
                                                );
                                            }
                                        })()}
                                    </div>
                                    
                                    {/* Deal Conversion Suggestions */}
                                    <div style={{
                                        border: '1px solid #ffc107',
                                        borderRadius: '8px',
                                        padding: '20px',
                                        backgroundColor: '#fffdf8'
                                    }}>
                                        <h4 style={{color: '#856404', marginBottom: '15px'}}> Deal Conversion</h4>
                                        {(() => {
                                            const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                            const totalClosedDeals = closedDeals.length;
                                            const conversionRate = totalOffers > 0 ? (totalClosedDeals / totalOffers) * 100 : 0;
                                            
                                            if (conversionRate < 30) {
                                                return (
                                                    <div>
                                                        <p><strong>Conversion Rate:</strong> {Math.round(conversionRate)}% (Needs Work)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Improve offer presentation skills</li>
                                                            <li>Research comparable sales thoroughly</li>
                                                            <li>Build stronger client relationships</li>
                                                            <li>Follow up consistently on pending offers</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else if (conversionRate < 60) {
                                                return (
                                                    <div>
                                                        <p><strong>Conversion Rate:</strong> {Math.round(conversionRate)}% (Solid Performance)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Qualify buyers more thoroughly before showing</li>
                                                            <li>Understand seller motivations better</li>
                                                            <li>Use staging and professional photography</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else {
                                                return (
                                                    <div>
                                                        <p><strong>Conversion Rate:</strong> {Math.round(conversionRate)}% (Excellent!)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li> Outstanding closing skills</li>
                                                            <li>Document your successful strategies</li>
                                                            <li>Focus on higher-value transactions</li>
                                                        </ul>
                                                    </div>
                                                );
                                            }
                                        })()}
                                    </div>
                                    
                                    {/* Business ROI Suggestions */}
                                    <div style={{
                                        border: '1px solid #dc3545',
                                        borderRadius: '8px',
                                        padding: '20px',
                                        backgroundColor: '#fff8f8'
                                    }}>
                                        <h4 style={{color: '#dc3545', marginBottom: '15px'}}> Business ROI</h4>
                                        {(() => {
                                            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                            const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                            const roi = totalExpenses > 0 ? ((totalCommission - totalExpenses) / totalExpenses) * 100 : 0;
                                            
                                            if (roi < 100) {
                                                return (
                                                    <div>
                                                        <p><strong>Current ROI:</strong> {Math.round(roi)}% (Concerning)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Review and cut unnecessary expenses</li>
                                                            <li>Track all expenses religiously</li>
                                                            <li>Focus on cost-effective marketing</li>
                                                            <li>Consider increasing commission rates</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else if (roi < 300) {
                                                return (
                                                    <div>
                                                        <p><strong>Current ROI:</strong> {Math.round(roi)}% (Healthy)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Optimize marketing spend for better results</li>
                                                            <li>Invest in high-ROI activities (referrals, repeat clients)</li>
                                                            <li>Consider expanding successful strategies</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else {
                                                return (
                                                    <div>
                                                        <p><strong>Current ROI:</strong> {Math.round(roi)}% (Exceptional!)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li> Excellent expense management</li>
                                                            <li>Scale your successful strategies</li>
                                                            <li>Consider investing in business growth</li>
                                                        </ul>
                                                    </div>
                                                );
                                            }
                                        })()}
                                    </div>
                                    
                                    {/* Buyer Pipeline Suggestions */}
                                    <div style={{
                                        border: '1px solid #6f42c1',
                                        borderRadius: '8px',
                                        padding: '20px',
                                        backgroundColor: '#f8f6ff'
                                    }}>
                                        <h4 style={{color: '#6f42c1', marginBottom: '15px'}}> Buyer Pipeline</h4>
                                        {(() => {
                                            const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                            const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                            const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                            const signRate = buyerAppts > 0 ? (buyersSigned / buyerAppts) * 100 : 0;
                                            const closeRate = buyersSigned > 0 ? (buyersSold / buyersSigned) * 100 : 0;
                                            
                                            if (signRate < 50) {
                                                return (
                                                    <div>
                                                        <p><strong>Signing Rate:</strong> {Math.round(signRate)}% (Needs Focus)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Pre-qualify buyers thoroughly before appointments</li>
                                                            <li>Get pre-approval letters before showing properties</li>
                                                            <li>Build rapport and trust in buyer consultations</li>
                                                            <li>Present clear value proposition and market analysis</li>
                                                            <li>Use buyer agency agreements to establish commitment</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else if (closeRate < 70) {
                                                return (
                                                    <div>
                                                        <p><strong>Closing Rate:</strong> {Math.round(closeRate)}% (Improve Follow-through)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Stay in regular contact with signed buyers</li>
                                                            <li>Help buyers understand the market timeline</li>
                                                            <li>Present properties that match their criteria better</li>
                                                            <li>Manage expectations about competition and pricing</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else {
                                                return (
                                                    <div>
                                                        <p><strong>Pipeline Performance:</strong> Excellent! ({Math.round(signRate)}% sign, {Math.round(closeRate)}% close)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li> Strong buyer conversion rates</li>
                                                            <li>Focus on increasing appointment volume</li>
                                                            <li>Consider buyer referral programs</li>
                                                        </ul>
                                                    </div>
                                                );
                                            }
                                        })()}
                                    </div>
                                    
                                    {/* Listing Pipeline Suggestions */}
                                    <div style={{
                                        border: '1px solid #e83e8c',
                                        borderRadius: '8px',
                                        padding: '20px',
                                        backgroundColor: '#fff8fa'
                                    }}>
                                        <h4 style={{color: '#e83e8c', marginBottom: '15px'}}> Listing Pipeline</h4>
                                        {(() => {
                                            const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                            const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                            const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                            const takeRate = listingAppts > 0 ? (listingsTaken / listingAppts) * 100 : 0;
                                            const sellRate = listingsTaken > 0 ? (listingsSold / listingsTaken) * 100 : 0;
                                            
                                            if (takeRate < 60) {
                                                return (
                                                    <div>
                                                        <p><strong>Listing Rate:</strong> {Math.round(takeRate)}% (Improve Presentations)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Prepare comprehensive market analysis (CMA)</li>
                                                            <li>Present professional marketing plan</li>
                                                            <li>Bring portfolio of recently sold listings</li>
                                                            <li>Practice objection handling for pricing concerns</li>
                                                            <li>Show staging and photography examples</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else if (sellRate < 80) {
                                                return (
                                                    <div>
                                                        <p><strong>Sale Rate:</strong> {Math.round(sellRate)}% (Boost Marketing)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li>Improve listing photography and virtual tours</li>
                                                            <li>Price properties competitively from the start</li>
                                                            <li>Increase online and social media presence</li>
                                                            <li>Host more open houses and broker tours</li>
                                                            <li>Provide regular market updates to sellers</li>
                                                        </ul>
                                                    </div>
                                                );
                                            } else {
                                                return (
                                                    <div>
                                                        <p><strong>Pipeline Performance:</strong> Outstanding! ({Math.round(takeRate)}% take, {Math.round(sellRate)}% sell)</p>
                                                        <ul style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                            <li> Excellent listing conversion</li>
                                                            <li>Scale up with more listing appointments</li>
                                                            <li>Consider premium property segments</li>
                                                        </ul>
                                                    </div>
                                                );
                                            }
                                        })()}
                                    </div>
                                </div>
                                
                                {/* Overall Efficiency Score Improvement */}
                                <div style={{
                                    marginTop: '20px',
                                    padding: '20px',
                                    backgroundColor: '#f8f9fa',
                                    borderRadius: '8px',
                                    border: '2px solid #f39c12'
                                }}>
                                    <h4 style={{color: '#d68910', marginBottom: '15px'}}> Efficiency Score Action Plan</h4>
                                    {(() => {
                                        // Calculate efficiency score again for recommendations (matches updated weights)
                                        let totalScore = 0;
                                        let scoreComponents = 0;
                                        
                                        const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                        const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                        const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                        const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                        const totalClosedDeals = closedDeals.length;
                                        const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                        const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
                                        const totalExpenses = expenses.reduce((sum, exp) => sum + (exp.amount || 0), 0);
                                        
                                        // Call efficiency (15% weight)
                                        if (totalCallsMade > 0) {
                                            totalScore += (totalCallsAnswered / totalCallsMade) * 15;
                                            scoreComponents += 15;
                                        }
                                        // Appointment conversion (15% weight)  
                                        if (totalCallsAnswered > 0) {
                                            totalScore += (totalAppointments / totalCallsAnswered) * 15;
                                            scoreComponents += 15;
                                        }
                                        // Deal conversion (20% weight)
                                        if (totalOffers > 0) {
                                            totalScore += (totalClosedDeals / totalOffers) * 20;
                                            scoreComponents += 20;
                                        }
                                        // Buyer pipeline efficiency (15% weight)
                                        const buyerAppts = properties.filter(p => p.type === 'Buyer' && p.status === 'Buyer Appointment').length;
                                        const buyersSigned = properties.filter(p => p.type === 'Buyer' && ['Buyer Signed', 'Under Contract', 'Closed'].includes(p.status)).length;
                                        if (buyerAppts > 0) {
                                            totalScore += (buyersSigned / buyerAppts) * 15;
                                            scoreComponents += 15;
                                        }
                                        // Buyer closing rate (10% weight)
                                        const buyersSold = properties.filter(p => p.type === 'Buyer' && p.status === 'Closed').length;
                                        if (buyersSigned > 0) {
                                            totalScore += (buyersSold / buyersSigned) * 10;
                                            scoreComponents += 10;
                                        }
                                        // Listing pipeline efficiency (15% weight)
                                        const listingAppts = properties.filter(p => p.type === 'Seller' && p.status === 'Listing Appointment').length;
                                        const listingsTaken = properties.filter(p => p.type === 'Seller' && ['Listed', 'Under Contract', 'Sold'].includes(p.status)).length;
                                        if (listingAppts > 0) {
                                            totalScore += (listingsTaken / listingAppts) * 15;
                                            scoreComponents += 15;
                                        }
                                        // Listing sale rate (10% weight)
                                        const listingsSold = properties.filter(p => p.type === 'Seller' && p.status === 'Sold').length;
                                        if (listingsTaken > 0) {
                                            totalScore += (listingsSold / listingsTaken) * 10;
                                            scoreComponents += 10;
                                        }
                                        // Revenue efficiency (10% weight)
                                        if (totalHours > 0 && totalCommission > 0) {
                                            const revenuePerHour = totalCommission / totalHours;
                                            const revenueScore = Math.min(revenuePerHour / 100, 1);
                                            totalScore += revenueScore * 10;
                                            scoreComponents += 10;
                                        }
                                        // Business ROI (5% weight)
                                        if (totalExpenses > 0 && totalCommission > 0) {
                                            const netProfit = totalCommission - totalExpenses;
                                            const roi = netProfit / totalExpenses;
                                            const roiScore = Math.min(Math.max(roi / 2, 0), 1);
                                            totalScore += roiScore * 5;
                                            scoreComponents += 5;
                                        }
                                        
                                        const finalScore = scoreComponents > 0 ? (totalScore / scoreComponents) * 100 : 0;
                                        
                                        if (finalScore < 50) {
                                            return (
                                                <div>
                                                    <p><strong>Priority Focus Areas:</strong> Your efficiency score indicates significant room for improvement</p>
                                                    <ol style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                        <li><strong>Week 1-2:</strong> Focus on call efficiency - improve your calling strategy and timing</li>
                                                        <li><strong>Week 3-4:</strong> Work on appointment conversion - better qualify leads before calling</li>
                                                        <li><strong>Month 2:</strong> Improve deal closing skills through training or mentorship</li>
                                                        <li><strong>Ongoing:</strong> Track time and expenses to optimize your hourly value</li>
                                                    </ol>
                                                </div>
                                            );
                                        } else if (finalScore < 75) {
                                            return (
                                                <div>
                                                    <p><strong>Optimization Areas:</strong> You're performing well but can reach the next level</p>
                                                    <ol style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                        <li><strong>This Month:</strong> Identify your strongest performance area and double down</li>
                                                        <li><strong>Next Month:</strong> Address your weakest metric with targeted improvement</li>
                                                        <li><strong>Quarter Goal:</strong> Aim for 80%+ efficiency score through consistent optimization</li>
                                                    </ol>
                                                </div>
                                            );
                                        } else {
                                            return (
                                                <div>
                                                    <p><strong>Excellence Maintenance:</strong> Outstanding performance - focus on scaling and consistency</p>
                                                    <ol style={{margin: '10px 0', paddingLeft: '20px'}}>
                                                        <li><strong>Document:</strong> Record your successful strategies and systems</li>
                                                        <li><strong>Scale:</strong> Consider expanding your operation or team</li>
                                                        <li><strong>Innovate:</strong> Test new strategies while maintaining current performance</li>
                                                    </ol>
                                                </div>
                                            );
                                        }
                                    })()}
                                </div>
                            </div>
                            
                            {/* Goal Achievement Progress */}
                            {goalsLocked && (
                                <div className="form-section">
                                    <h3>Goal Achievement Summary</h3>
                                    
                                    {/* Overall Performance Score */}
                                    <div style={{marginBottom: '30px', textAlign: 'center', padding: '20px', backgroundColor: '#f8f9fa', borderRadius: '8px'}}>
                                        <h4>Overall Performance Score</h4>
                                        <div style={{fontSize: '3em', fontWeight: 'bold', color: '#007bff'}}>
                                            {(() => {
                                                const daysWithData = Object.keys(dailyData).length;
                                                if (daysWithData === 0) return '0%';
                                                
                                                let totalScore = 0;
                                                let scoredDays = 0;
                                                
                                                Object.values(dailyData).forEach(day => {
                                                    let dayScore = 0;
                                                    let maxDayScore = 0;
                                                    
                                                    // Hours goal
                                                    if (goals.hoursWorked && day.hoursWorked !== undefined) {
                                                        dayScore += Math.min(day.hoursWorked / goals.hoursWorked, 1) * 25;
                                                        maxDayScore += 25;
                                                    }
                                                    
                                                    // Calls goal
                                                    if (goals.dailyCalls && day.callsMade !== undefined) {
                                                        dayScore += Math.min(day.callsMade / goals.dailyCalls, 1) * 25;
                                                        maxDayScore += 25;
                                                    }
                                                    
                                                    // Appointments goal
                                                    if (goals.appointmentsSet && day.appointmentsSet !== undefined) {
                                                        dayScore += Math.min(day.appointmentsSet / goals.appointmentsSet, 1) * 25;
                                                        maxDayScore += 25;
                                                    }
                                                    
                                                    // Offers goal
                                                    if (goals.offersWritten && day.offersWritten !== undefined) {
                                                        dayScore += Math.min(day.offersWritten / goals.offersWritten, 1) * 25;
                                                        maxDayScore += 25;
                                                    }
                                                    
                                                    if (maxDayScore > 0) {
                                                        totalScore += (dayScore / maxDayScore) * 100;
                                                        scoredDays++;
                                                    }
                                                });
                                                
                                                return scoredDays > 0 ? `${Math.round(totalScore / scoredDays)}%` : '0%';
                                            })()}
                                        </div>
                                        <small>Average daily goal achievement</small>
                                    </div>
                                    
                                    {/* Individual Goal Progress */}
                                    <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '20px'}}>
                                        <div style={{padding: '15px', backgroundColor: '#e3f2fd', borderRadius: '8px'}}>
                                            <h5>Hours Worked Goal</h5>
                                            <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#1976d2'}}>
                                                {(() => {
                                                    const daysWithHours = Object.values(dailyData).filter(day => day.hoursWorked && day.hoursWorked >= (goals.hoursWorked || 8)).length;
                                                    const totalDays = Object.keys(dailyData).length;
                                                    return totalDays > 0 ? `${Math.round((daysWithHours / totalDays) * 100)}%` : '0%';
                                                })()}
                                            </div>
                                            <small>Days meeting hours goal</small>
                                        </div>
                                        
                                        <div style={{padding: '15px', backgroundColor: '#f3e5f5', borderRadius: '8px'}}>
                                            <h5>Calls Goal</h5>
                                            <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#7b1fa2'}}>
                                                {(() => {
                                                    const daysWithCalls = Object.values(dailyData).filter(day => day.callsMade && day.callsMade >= goals.dailyCalls).length;
                                                    const totalDays = Object.keys(dailyData).length;
                                                    return totalDays > 0 ? `${Math.round((daysWithCalls / totalDays) * 100)}%` : '0%';
                                                })()}
                                            </div>
                                            <small>Days meeting calls goal</small>
                                        </div>
                                        
                                        <div style={{padding: '15px', backgroundColor: '#e8f5e8', borderRadius: '8px'}}>
                                            <h5>Appointments Goal</h5>
                                            <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#388e3c'}}>
                                                {(() => {
                                                    const daysWithAppts = Object.values(dailyData).filter(day => day.appointmentsSet && day.appointmentsSet >= (goals.appointmentsSet || 1)).length;
                                                    const totalDays = Object.keys(dailyData).length;
                                                    return totalDays > 0 ? `${Math.round((daysWithAppts / totalDays) * 100)}%` : '0%';
                                                })()}
                                            </div>
                                            <small>Days meeting appointment goal</small>
                                        </div>
                                        
                                        <div style={{padding: '15px', backgroundColor: '#fff3cd', borderRadius: '8px'}}>
                                            <h5>Offers Goal</h5>
                                            <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#856404'}}>
                                                {(() => {
                                                    const daysWithOffers = Object.values(dailyData).filter(day => day.offersWritten && day.offersWritten >= (goals.offersWritten || 2)).length;
                                                    const totalDays = Object.keys(dailyData).length;
                                                    return totalDays > 0 ? `${Math.round((daysWithOffers / totalDays) * 100)}%` : '0%';
                                                })()}
                                            </div>
                                            <small>Days meeting offers goal</small>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {/* Activity Comparison */}
                            <div className="form-section">
                                <h3>Activity vs Goals Comparison</h3>
                                <div className="grid">
                                    <div className="tile">
                                        <h4>Total Hours</h4>
                                        <p>{Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0)}</p>
                                        <small>
                                            Goal: {(goals.hoursWorked || 8) * Object.keys(dailyData).length} total
                                            {Object.keys(dailyData).length > 0 && 
                                                ` (${Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0) >= (goals.hoursWorked || 8) * Object.keys(dailyData).length ? '' : ''})`
                                            }
                                        </small>
                                    </div>
                                    
                                    <div className="tile">
                                        <h4>Total Calls</h4>
                                        <p>{Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0)}</p>
                                        <small>
                                            Goal: {goals.dailyCalls * Object.keys(dailyData).length} total
                                            {Object.keys(dailyData).length > 0 && 
                                                ` (${Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0) >= goals.dailyCalls * Object.keys(dailyData).length ? '' : ''})`
                                            }
                                        </small>
                                    </div>
                                    
                                    <div className="tile">
                                        <h4>Total Appointments</h4>
                                        <p>{Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0)}</p>
                                        <small>
                                            Goal: {(goals.appointmentsSet || 1) * Object.keys(dailyData).length} total
                                            {Object.keys(dailyData).length > 0 && 
                                                ` (${Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0) >= (goals.appointmentsSet || 1) * Object.keys(dailyData).length ? '' : ''})`
                                            }
                                        </small>
                                    </div>
                                    
                                    <div className="tile">
                                        <h4>Total Offers</h4>
                                        <p>{Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0)}</p>
                                        <small>
                                            Goal: {(goals.offersWritten || 2) * Object.keys(dailyData).length} total
                                            {Object.keys(dailyData).length > 0 && 
                                                ` (${Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0) >= (goals.offersWritten || 2) * Object.keys(dailyData).length ? '' : ''})`
                                            }
                                        </small>
                                    </div>
                                </div>
                            </div>
                            
                            {!goalsLocked && (
                                <div style={{marginTop: '20px', padding: '15px', background: '#fff3cd', border: '1px solid #ffeaa7', borderRadius: '8px'}}>
                                    <h4 style={{color: '#856404'}}>Lock Your Goals to See Performance Analytics</h4>
                                    <p style={{color: '#856404', margin: '10px 0 0 0'}}>
                                        To view detailed performance metrics and goal achievement tracking, please lock your goals in the Goals tab.
                                    </p>
                                </div>
                            )}
                            
                            {Object.keys(dailyData).length === 0 && (
                                <div style={{marginTop: '20px', padding: '15px', background: '#d1ecf1', border: '1px solid #b8daff', borderRadius: '8px'}}>
                                    <h4 style={{color: '#0c5460'}}>No Activity Data Available</h4>
                                    <p style={{color: '#0c5460', margin: '10px 0 0 0'}}>
                                        Start entering your daily activities in the Goals tab to see performance analytics here.
                                    </p>
                                </div>
                            )}
                        </div>
                    )}
                    
                    {/* Reports Tab */}
                    {activeTab === 'reports' && (
                        <div className="tab-content">
                            <h2>Reports & Analytics</h2>
                            <div className="grid">
                                <div className="tile">
                                    <h4>Conversion Rate</h4>
                                    <p>25%</p>
                                    <small>Leads to appointments</small>
                                </div>
                                <div className="tile">
                                    <h4>Average Deal Size</h4>
                                    <p>${transactions.length > 0 ? Math.round(transactions.reduce((sum, t) => sum + t.amount, 0) / transactions.length).toLocaleString() : 0}</p>
                                    <small>Average transaction value</small>
                                </div>
                                <div className="tile">
                                    <h4>Time to Close</h4>
                                    <p>45 days</p>
                                    <small>Average closing time</small>
                                </div>
                                <div className="tile">
                                    <h4>Commission Rate</h4>
                                    <p>2.5%</p>
                                    <small>Average commission rate</small>
                                </div>
                            </div>
                            
                            <div className="form-section">
                                <h3>Generate Report</h3>
                                <div className="form-group">
                                    <label>Report Type</label>
                                    <select>
                                        <option>Monthly Summary</option>
                                        <option>Quarterly Review</option>
                                        <option>Annual Report</option>
                                        <option>Commission Summary</option>
                                    </select>
                                </div>
                                <div className="form-group">
                                    <label>Date Range</label>
                                    <input type="date" />
                                </div>
                                <button className="btn">Generate Report</button>
                            </div>
                        </div>
                    )}
                    
                    {/* Report Modal */}
                    {showReportModal && currentReport && (
                        <div className="report-modal" onClick={() => setShowReportModal(false)}>
                            <div className="report-modal-content" onClick={(e) => e.stopPropagation()}>
                                <div className="report-header">
                                    <h2>{currentReport.title}</h2>
                                    <button 
                                        onClick={() => setShowReportModal(false)}
                                        style={{
                                            background: '#dc3545',
                                            color: 'white',
                                            border: 'none',
                                            borderRadius: '4px',
                                            padding: '5px 10px',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        
                                    </button>
                                </div>
                                
                                <div className="report-actions">
                                    <button 
                                        className="report-btn print"
                                        onClick={() => window.print()}
                                    >
                                         Print / Save PDF
                                    </button>
                                    <button 
                                        className="report-btn close"
                                        onClick={() => setShowReportModal(false)}
                                    >
                                        Close
                                    </button>
                                </div>
                                
                                <div className="report-content">
                                    {currentReport.title === 'Expense Report' && (
                                        <div>
                                            <h3>Summary</h3>
                                            <p><strong>Total Expenses:</strong> ${currentReport.totalExpenses.toLocaleString()}</p>
                                            <p><strong>Total Hours:</strong> {currentReport.totalHours} hours</p>
                                            
                                            <h3>Category Breakdown</h3>
                                            <table className="report-table">
                                                <thead>
                                                    <tr>
                                                        <th>Category</th>
                                                        <th>Amount</th>
                                                        <th>Count</th>
                                                        <th>Hours</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {Object.entries(currentReport.categorySummary).map(([category, data]) => (
                                                        <tr key={category}>
                                                            <td>{category}</td>
                                                            <td>${data.amount.toLocaleString()}</td>
                                                            <td>{data.count}</td>
                                                            <td>{data.hours}</td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                            
                                            <h3>Detailed Expenses</h3>
                                            <table className="report-table">
                                                <thead>
                                                    <tr>
                                                        <th>Date</th>
                                                        <th>Property</th>
                                                        <th>Category</th>
                                                        <th>Description</th>
                                                        <th>Vendor</th>
                                                        <th>Amount</th>
                                                        <th>Hours</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {currentReport.expenses.map(expense => (
                                                        <tr key={expense.id}>
                                                            <td>{expense.date}</td>
                                                            <td>{expense.propertyAddress}</td>
                                                            <td>{expense.category}</td>
                                                            <td>{expense.description}</td>
                                                            <td>{expense.vendor || 'N/A'}</td>
                                                            <td>${expense.amount.toLocaleString()}</td>
                                                            <td>{expense.hoursWorked || 0}</td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                    )}
                                    
                                    {currentReport.title === 'Weekly Report' && (
                                        <div>
                                            <h3>Week of {currentReport.weekStart} to {currentReport.weekEnd}</h3>
                                            
                                            <h3>Goal Achievement</h3>
                                            <table className="report-table">
                                                <thead>
                                                    <tr>
                                                        <th>Metric</th>
                                                        <th>Actual</th>
                                                        <th>Goal</th>
                                                        <th>Achievement</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>Buyer Contracts</td>
                                                        <td>{currentReport.totals.buyerContracts}</td>
                                                        <td>{currentReport.goals.weeklyBuyerContracts}</td>
                                                        <td>{Math.round(getWeeklyProgress('buyerContracts', currentReport.goals.weeklyBuyerContracts))}%</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Offers Written</td>
                                                        <td>{currentReport.totals.offersWritten}</td>
                                                        <td>{currentReport.goals.weeklyOffers}</td>
                                                        <td>{Math.round(getWeeklyProgress('offersWritten', currentReport.goals.weeklyOffers))}%</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Appointments Set</td>
                                                        <td>{currentReport.totals.appointmentsSet}</td>
                                                        <td>{currentReport.goals.weeklyAppointments}</td>
                                                        <td>{Math.round(getWeeklyProgress('appointmentsSet', currentReport.goals.weeklyAppointments))}%</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            
                                            <h3>Weekly Expenses</h3>
                                            <p><strong>Total:</strong> ${currentReport.expenses.reduce((sum, e) => sum + e.amount, 0).toLocaleString()}</p>
                                            <p><strong>Hours:</strong> {currentReport.expenses.reduce((sum, e) => sum + (e.hoursWorked || 0), 0)} hours</p>
                                        </div>
                                    )}
                                    
                                    {currentReport.title === 'Daily Report' && (
                                        <div>
                                            <h3>Daily Report for {currentReport.date}</h3>
                                            
                                            <h3>Activities</h3>
                                            <table className="report-table">
                                                <thead>
                                                    <tr>
                                                        <th>Metric</th>
                                                        <th>Actual</th>
                                                        <th>Goal</th>
                                                        <th>Achievement</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>Hours Worked</td>
                                                        <td>{currentReport.data.hoursWorked || 0}</td>
                                                        <td>{currentReport.goals.hoursWorked || 8}</td>
                                                        <td>{Math.round(((currentReport.data.hoursWorked || 0) / (currentReport.goals.hoursWorked || 8)) * 100)}%</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Calls Made</td>
                                                        <td>{currentReport.data.callsMade || 0}</td>
                                                        <td>{currentReport.goals.dailyCalls}</td>
                                                        <td>{Math.round(((currentReport.data.callsMade || 0) / currentReport.goals.dailyCalls) * 100)}%</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Appointments Set</td>
                                                        <td>{currentReport.data.appointmentsSet || 0}</td>
                                                        <td>{currentReport.goals.appointmentsSet || 1}</td>
                                                        <td>{Math.round(((currentReport.data.appointmentsSet || 0) / (currentReport.goals.appointmentsSet || 1)) * 100)}%</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            
                                            <h3>Daily Expenses</h3>
                                            <p><strong>Total:</strong> ${currentReport.expenses.reduce((sum, e) => sum + e.amount, 0).toLocaleString()}</p>
                                            <p><strong>Count:</strong> {currentReport.expenses.length} expense(s)</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
