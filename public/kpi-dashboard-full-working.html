<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KPI Dashboard - Complete Version</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            transition: all 0.3s ease;
            --wheel-bg: white;
            --wheel-text: #333;
        }
        
        body.dark-theme {
            background-color: #1a1a1a;
            color: #e0e0e0;
            --wheel-bg: #333;
            --wheel-text: #e0e0e0;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .dark-theme .container {
            background: #2d2d2d;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .theme-toggle:hover {
            background: #0056b3;
            transform: scale(1.1);
        }
        
        .dark-theme .theme-toggle {
            background: #ffc107;
            color: #000;
        }
        
        .dark-theme .theme-toggle:hover {
            background: #ffca2c;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
        }
        
        .tab {
            padding: 12px 16px;
            cursor: pointer;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px 8px 0 0;
            font-size: 14px;
            font-weight: 500;
            min-width: 100px;
            text-align: center;
            white-space: nowrap;
            transition: all 0.3s ease;
        }
        
        .tab[data-tab="goals"] {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            border-color: #28a745;
            color: #155724;
        }
        
        .tab[data-tab="transactions"] {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-color: #2196f3;
            color: #0d47a1;
        }
        
        .tab[data-tab="dashboard"] {
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            border-color: #9c27b0;
            color: #4a148c;
        }
        
        .tab[data-tab="expenses"] {
            background: linear-gradient(135deg, #fff3e0, #ffcc02);
            border-color: #ff9800;
            color: #e65100;
        }
        
        .tab[data-tab="reports"] {
            background: linear-gradient(135deg, #fce4ec, #f8bbd9);
            border-color: #e91e63;
            color: #880e4f;
        }
        
        .tab[data-tab="gci"] {
            background: linear-gradient(135deg, #e0f2f1, #b2dfdb);
            border-color: #009688;
            color: #004d40;
        }
        
        .tab[data-tab="performance"] {
            background: linear-gradient(135deg, #fff8e1, #ffecb3);
            border-color: #ffc107;
            color: #ff6f00;
        }
        
        .dark-theme .tab {
            background: #404040;
            border-color: #555;
            color: #e0e0e0;
        }
        
        .tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .tab.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,123,255,0.4);
        }
        
        .dark-theme .tab.active {
            background: #0056b3;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .tile {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #ddd;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .dark-theme .tile {
            background: linear-gradient(135deg, #404040, #4a4a4a);
            border-color: #555;
            color: #e0e0e0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .tile:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
        }
        
        .dark-theme .tile:hover {
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
        }
        
        .tile h4 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }
        
        .tile p {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
            color: #007bff;
        }
        
        .tile small {
            color: #666;
            font-size: 12px;
            font-weight: 500;
        }
        
        .dark-theme .tile h4 {
            color: #e0e0e0;
        }
        
        .dark-theme .tile p {
            color: #4dabf7;
        }
        
        .dark-theme .tile small {
            color: #aaa;
        }
        
        .form-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .dark-theme .form-section {
            background: #404040;
            color: #e0e0e0;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        .dark-theme .form-group label {
            color: #e0e0e0;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .dark-theme .form-group input, 
        .dark-theme .form-group select, 
        .dark-theme .form-group textarea {
            background: #555;
            border-color: #666;
            color: #e0e0e0;
        }
        
        .btn {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s ease;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .dark-theme h1 {
            color: #e0e0e0;
        }
        
        h2 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .dark-theme h2 {
            color: #e0e0e0;
        }
        
        h3 {
            color: #555;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        .dark-theme h3 {
            color: #e0e0e0;
        }
        
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
        }
        
        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #b6d7e2;
        }
        
        .dark-theme .alert-info {
            color: #a6e9ed;
            background-color: #1c4d52;
            border-color: #2d6266;
        }
        
        .progress-wheels-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .progress-wheel-item {
            text-align: center;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .dark-theme .progress-wheel-item {
            background: #404040;
            color: #e0e0e0;
        }
        
        .progress-wheel-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .efficiency-score-container {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }
        
        .calculator-results {
            background: #f8f9fa;
            border: 2px solid #007bff;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .dark-theme .calculator-results {
            background: #404040;
            border-color: #4dabf7;
            color: #e0e0e0;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const App = () => {
            const [activeTab, setActiveTab] = useState('goals');
            const [properties, setProperties] = useState([]);
            const [transactions, setTransactions] = useState([]);
            const [expenses, setExpenses] = useState([]);
            const [calls, setCalls] = useState({ made: 0, answered: 0 });
            const [appointments, setAppointments] = useState([]);
            const [gciData, setGciData] = useState({ gciGoal: 0, current: 0 });
            const [dailyData, setDailyData] = useState({});
            const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);
            const [goals, setGoals] = useState({
                dailyCalls: 0,
                weeklyAppointments: 0,
                weeklyBuyerContracts: 0,
                weeklyOffers: 0,
                monthlyClosings: 0,
                annualGCI: 0
            });
            const [goalsLocked, setGoalsLocked] = useState(false);
            const [gciCalculator, setGciCalculator] = useState({
                averageSalePrice: 0,
                commissionRate: 0,
                averageCommissionPerDeal: 0,
                desiredGCI: 0,
                desiredVolume: 0,
                dealsNeeded: 0,
                dealsNeededForGCI: 0,
                dealsNeededForVolume: 0
            });
            const [currentTheme, setCurrentTheme] = useState('light');
            
            // Calculate total commission
            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
            
            // Theme toggle function
            const toggleTheme = () => {
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                setCurrentTheme(newTheme);
                document.body.className = newTheme === 'dark' ? 'dark-theme' : '';
            };
            
            // Set initial theme
            useEffect(() => {
                document.body.className = currentTheme === 'dark' ? 'dark-theme' : '';
            }, [currentTheme]);
            
            // Property management functions
            const addProperty = (propertyData) => {
                const newProperty = {
                    id: Math.max(...properties.map(p => p.id), 0) + 1,
                    ...propertyData
                };
                setProperties([...properties, newProperty]);
                
                const commission = propertyData.status === 'Closed' ? propertyData.price * 0.025 : 0;
                const newTransaction = {
                    id: Math.max(...transactions.map(t => t.id), 0) + 1,
                    amount: propertyData.price,
                    commission: commission,
                    status: 'Inactive',
                    property: propertyData.address,
                    date: new Date().toISOString().split('T')[0]
                };
                setTransactions([...transactions, newTransaction]);
            };
            
            const addSampleProperty = () => {
                const addresses = ['123 Main St', '456 Oak Ave', '789 Pine Rd', '321 Elm Dr', '654 Maple Ln'];
                const clients = ['John Smith', 'Sarah Johnson', 'Mike Wilson', 'Lisa Brown', 'David Davis'];
                const statuses = ['Active', 'Pending', 'Closed'];
                const types = ['Listing', 'Buyer Rep'];
                
                const newProperty = {
                    address: addresses[Math.floor(Math.random() * addresses.length)] + ` #${Math.floor(Math.random() * 1000)}`,
                    client: clients[Math.floor(Math.random() * clients.length)],
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    price: Math.floor(Math.random() * 500000) + 200000,
                    type: types[Math.floor(Math.random() * types.length)],
                    source: 'Sample Data'
                };
                addProperty(newProperty);
            };
            
            const addExpense = (expenseData) => {
                const newExpense = {
                    id: Math.max(...expenses.map(e => e.id), 0) + 1,
                    ...expenseData
                };
                setExpenses([...expenses, newExpense]);
            };
            
            const addSampleExpense = () => {
                const categories = ['Travel', 'Marketing', 'Office', 'Staging', 'Photography', 'Meals', 'Professional Development'];
                const amounts = [50, 100, 200, 300, 500, 750, 1000];
                const descriptions = ['Business meeting', 'Client lunch', 'Office supplies', 'Marketing materials', 'Professional photos'];
                
                const newExpense = {
                    category: categories[Math.floor(Math.random() * categories.length)],
                    amount: amounts[Math.floor(Math.random() * amounts.length)],
                    description: descriptions[Math.floor(Math.random() * descriptions.length)],
                    date: selectedDate,
                    hoursWorked: Math.floor(Math.random() * 8) + 1
                };
                addExpense(newExpense);
            };
            
            // GCI Calculator functions
            const calculateGCIDeals = () => {
                if (gciCalculator.averageCommissionPerDeal > 0 && gciCalculator.desiredGCI > 0) {
                    return Math.ceil(gciCalculator.desiredGCI / gciCalculator.averageCommissionPerDeal);
                }
                return 0;
            };
            
            const calculateVolumeDeals = () => {
                if (gciCalculator.averageSalePrice > 0 && gciCalculator.desiredVolume > 0) {
                    return Math.ceil(gciCalculator.desiredVolume / gciCalculator.averageSalePrice);
                }
                return 0;
            };
            
            // Weekly totals calculation
            const getWeekStart = (date) => {
                const d = new Date(date);
                const day = d.getDay();
                const diff = d.getDate() - day + (day === 0 ? -6 : 1);
                return new Date(d.setDate(diff)).toISOString().split('T')[0];
            };
            
            const getWeeklyTotal = (field, targetDate = selectedDate) => {
                const weekStart = getWeekStart(targetDate);
                const weekData = Object.entries(dailyData).filter(([date]) => {
                    const entryWeekStart = getWeekStart(date);
                    return entryWeekStart === weekStart;
                });
                return weekData.reduce((sum, [_, data]) => sum + (data[field] || 0), 0);
            };
            
            const saveDailyData = (data) => {
                setDailyData(prev => ({
                    ...prev,
                    [data.date]: data
                }));
                setCalls({ made: data.callsMade || 0, answered: data.callsAnswered || 0 });
            };
            
            return (
                <div className="container">
                    {/* Theme Toggle Button */}
                    <button 
                        className="theme-toggle" 
                        onClick={toggleTheme}
                        title={`Switch to ${currentTheme === 'light' ? 'dark' : 'light'} mode`}
                    >
                        {currentTheme === 'light' ? '🌙' : '☀️'}
                    </button>
                    
                    <h1>Real Estate KPI Dashboard</h1>
                    
                    <div style={{textAlign: 'right', color: '#666', fontSize: '12px', marginBottom: '20px'}}>
                        Last updated: {new Date().toLocaleString()}
                    </div>
                    
                    {/* Tab Navigation */}
                    <div className="tabs">
                        {[
                            { id: 'goals', label: '🎯 Goals', icon: '🎯' },
                            { id: 'dashboard', label: '📊 Dashboard', icon: '📊' },
                            { id: 'performance', label: '⚡ Performance', icon: '⚡' },
                            { id: 'transactions', label: '💰 Transactions', icon: '💰' },
                            { id: 'expenses', label: '💳 Expenses', icon: '💳' },
                            { id: 'gci', label: '🏆 GCI Calculator', icon: '🏆' },
                            { id: 'reports', label: '📈 Reports', icon: '📈' }
                        ].map(tab => (
                            <div 
                                key={tab.id}
                                className={`tab ${activeTab === tab.id ? 'active' : ''}`}
                                onClick={() => setActiveTab(tab.id)}
                                data-tab={tab.id}
                            >
                                {tab.label}
                            </div>
                        ))}
                    </div>
                    
                    {/* Goals Tab */}
                    {activeTab === 'goals' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}>🎯 Goals & Performance Tracking</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Set your targets and track your daily progress toward success</p>
                            </div>
                            
                            {/* Goal Status Banner */}
                            <div style={{
                                background: goalsLocked ? 'linear-gradient(135deg, #d4edda, #c3e6cb)' : 'linear-gradient(135deg, #fff3cd, #ffeaa7)',
                                border: `2px solid ${goalsLocked ? '#28a745' : '#ffc107'}`,
                                borderRadius: '12px',
                                padding: '20px',
                                marginBottom: '30px',
                                textAlign: 'center'
                            }}>
                                <h3 style={{margin: '0 0 10px 0', color: goalsLocked ? '#155724' : '#856404'}}>
                                    {goalsLocked ? '🔒 Goals Locked & Active' : '🔓 Goals Ready to Set'}
                                </h3>
                                <p style={{margin: '0 0 15px 0', color: goalsLocked ? '#155724' : '#856404'}}>
                                    {goalsLocked 
                                        ? 'Your goals are locked and progress tracking is enabled. Enter daily activities to see your performance!'
                                        : 'Set your goals below and lock them to start tracking your progress automatically.'
                                    }
                                </p>
                                <button 
                                    className="btn" 
                                    style={{
                                        backgroundColor: goalsLocked ? '#dc3545' : '#28a745',
                                        borderRadius: '25px',
                                        padding: '8px 20px',
                                        fontWeight: 'bold'
                                    }}
                                    onClick={() => setGoalsLocked(!goalsLocked)}
                                >
                                    {goalsLocked ? '🔓 Unlock Goals' : '🔒 Lock Goals & Start Tracking'}
                                </button>
                            </div>
                            
                            {/* Goals Configuration */}
                            <div className="form-section">
                                <h3>📋 Goal Configuration</h3>
                                <div className="grid">
                                    <div className="form-group">
                                        <label>📞 Daily Calls Goal</label>
                                        <input 
                                            type="number" 
                                            value={goals.dailyCalls}
                                            onChange={(e) => setGoals({...goals, dailyCalls: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>📅 Weekly Appointments Goal</label>
                                        <input 
                                            type="number" 
                                            value={goals.weeklyAppointments}
                                            onChange={(e) => setGoals({...goals, weeklyAppointments: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>📋 Weekly Buyer Contracts Goal</label>
                                        <input 
                                            type="number" 
                                            value={goals.weeklyBuyerContracts}
                                            onChange={(e) => setGoals({...goals, weeklyBuyerContracts: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>📝 Weekly Offers Goal</label>
                                        <input 
                                            type="number" 
                                            value={goals.weeklyOffers}
                                            onChange={(e) => setGoals({...goals, weeklyOffers: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>🏡 Monthly Closings Goal</label>
                                        <input 
                                            type="number" 
                                            value={goals.monthlyClosings}
                                            onChange={(e) => setGoals({...goals, monthlyClosings: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>💰 Annual GCI Goal</label>
                                        <input 
                                            type="number" 
                                            value={goals.annualGCI}
                                            onChange={(e) => {
                                                const newGoals = {...goals, annualGCI: parseInt(e.target.value) || 0};
                                                setGoals(newGoals);
                                                setGciData({...gciData, gciGoal: newGoals.annualGCI});
                                            }}
                                            disabled={goalsLocked}
                                        />
                                    </div>
                                </div>
                            </div>
                            
                            {/* Daily Activity Tracking */}
                            <div className="form-section">
                                <h3>📈 Daily Activity Tracking</h3>
                                <div className="form-group">
                                    <label>📅 Select Date</label>
                                    <input 
                                        type="date" 
                                        value={selectedDate}
                                        onChange={(e) => setSelectedDate(e.target.value)}
                                    />
                                </div>
                                
                                <div className="grid">
                                    <div className="form-group">
                                        <label>📞 Calls Made</label>
                                        <input 
                                            type="number" 
                                            value={dailyData[selectedDate]?.callsMade || ''}
                                            onChange={(e) => {
                                                const value = parseInt(e.target.value) || 0;
                                                const currentData = dailyData[selectedDate] || {};
                                                saveDailyData({...currentData, date: selectedDate, callsMade: value});
                                            }}
                                            placeholder="Enter calls made"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>✅ Calls Answered</label>
                                        <input 
                                            type="number" 
                                            value={dailyData[selectedDate]?.callsAnswered || ''}
                                            onChange={(e) => {
                                                const value = parseInt(e.target.value) || 0;
                                                const currentData = dailyData[selectedDate] || {};
                                                saveDailyData({...currentData, date: selectedDate, callsAnswered: value});
                                            }}
                                            placeholder="Enter calls answered"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>📅 Appointments Set</label>
                                        <input 
                                            type="number" 
                                            value={dailyData[selectedDate]?.appointmentsSet || ''}
                                            onChange={(e) => {
                                                const value = parseInt(e.target.value) || 0;
                                                const currentData = dailyData[selectedDate] || {};
                                                saveDailyData({...currentData, date: selectedDate, appointmentsSet: value});
                                            }}
                                            placeholder="Enter appointments"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>📝 Offers Written</label>
                                        <input 
                                            type="number" 
                                            value={dailyData[selectedDate]?.offersWritten || ''}
                                            onChange={(e) => {
                                                const value = parseInt(e.target.value) || 0;
                                                const currentData = dailyData[selectedDate] || {};
                                                saveDailyData({...currentData, date: selectedDate, offersWritten: value});
                                            }}
                                            placeholder="Enter offers written"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>🏠 Buyer Contracts</label>
                                        <input 
                                            type="number" 
                                            value={dailyData[selectedDate]?.buyerContracts || ''}
                                            onChange={(e) => {
                                                const value = parseInt(e.target.value) || 0;
                                                const currentData = dailyData[selectedDate] || {};
                                                saveDailyData({...currentData, date: selectedDate, buyerContracts: value});
                                            }}
                                            placeholder="Enter buyer contracts"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>🏡 Listings Obtained</label>
                                        <input 
                                            type="number" 
                                            value={dailyData[selectedDate]?.listingsObtained || ''}
                                            onChange={(e) => {
                                                const value = parseInt(e.target.value) || 0;
                                                const currentData = dailyData[selectedDate] || {};
                                                saveDailyData({...currentData, date: selectedDate, listingsObtained: value});
                                            }}
                                            placeholder="Enter listings obtained"
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Dashboard Tab */}
                    {activeTab === 'dashboard' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}>📊 Dashboard Overview</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Your key performance metrics at a glance</p>
                            </div>
                            
                            {/* Key Metrics */}
                            <div className="grid">
                                <div className="tile" style={{background: 'linear-gradient(135deg, #e3f2fd, #bbdefb)'}}>
                                    <h4>Total Commission</h4>
                                    <p style={{fontSize: '1.8em', fontWeight: 'bold'}}>${totalCommission.toLocaleString()}</p>
                                    <small>Year-to-date earnings</small>
                                </div>
                                <div className="tile" style={{background: 'linear-gradient(135deg, #e8f5e8, #c8e6c9)'}}>
                                    <h4>Active Listings</h4>
                                    <p style={{fontSize: '1.8em', fontWeight: 'bold'}}>{properties.filter(p => p.status === 'Active').length}</p>
                                    <small>Properties on the market</small>
                                </div>
                                <div className="tile" style={{background: 'linear-gradient(135deg, #fff3e0, #ffcc80)'}}>
                                    <h4>Closed Deals</h4>
                                    <p style={{fontSize: '1.8em', fontWeight: 'bold'}}>{transactions.filter(t => t.status === 'Closed').length}</p>
                                    <small>Successful transactions</small>
                                </div>
                                <div className="tile" style={{background: 'linear-gradient(135deg, #f3e5f5, #e1bee7)'}}>
                                    <h4>Monthly Progress</h4>
                                    <p style={{fontSize: '1.8em', fontWeight: 'bold'}}>{gciData.gciGoal > 0 ? Math.round((totalCommission / gciData.gciGoal) * 100) : 0}%</p>
                                    <small>Progress toward annual goal</small>
                                </div>
                            </div>
                            
                            {/* Today's Activity */}
                            <div style={{marginBottom: '30px'}}>
                                <h3 style={{textAlign: 'center', marginBottom: '20px', color: '#495057'}}>📞 Today's Activity</h3>
                                <div className="grid">
                                    <div className="tile">
                                        <h4>Calls Made</h4>
                                        <p>{calls.made}</p>
                                        <small>Today's outreach</small>
                                    </div>
                                    <div className="tile">
                                        <h4>Call Success Rate</h4>
                                        <p>{calls.made > 0 ? Math.round((calls.answered / calls.made) * 100) : 0}%</p>
                                        <small>Answered calls rate</small>
                                    </div>
                                    <div className="tile">
                                        <h4>Total Expenses</h4>
                                        <p>${expenses.reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                        <small>Business expenses</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="alert alert-info">
                                <strong>Quick Stats:</strong> You have {properties.filter(p => p.status === 'Active').length} active listings, 
                                {properties.filter(p => p.status === 'Pending').length} pending sales, and have earned 
                                ${totalCommission.toLocaleString()} in commission this year.
                            </div>
                        </div>
                    )}
                    
                    {/* Performance Tab */}
                    {activeTab === 'performance' && (
                        <div className="tab-content">
                            {/* Overall Efficiency Score at Top */}
                            <div className="efficiency-score-container">
                                <h2 style={{margin: '0 0 10px 0', fontSize: '28px'}}>⚡ Overall Efficiency Score</h2>
                                <div style={{fontSize: '48px', fontWeight: 'bold', margin: '10px 0'}}>
                                    {(() => {
                                        const totalGoals = Object.values(goals).reduce((sum, goal) => sum + (goal || 0), 0);
                                        const totalProgress = getWeeklyTotal('callsMade') + getWeeklyTotal('appointmentsSet') + 
                                                            getWeeklyTotal('offersWritten') + getWeeklyTotal('buyerContracts') + 
                                                            getWeeklyTotal('listingsObtained');
                                        return totalGoals > 0 ? Math.round((totalProgress / totalGoals) * 100) : 0;
                                    })()}%
                                </div>
                                <p style={{margin: '10px 0 0 0', fontSize: '16px', opacity: 0.9}}>
                                    Combined performance across all key metrics
                                </p>
                            </div>
                            
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}>⚡ Performance Analytics</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Track your efficiency and goal progress</p>
                            </div>
                            
                            <div className="performance-grid">
                                <div className="tile">
                                    <h4>Weekly Calls</h4>
                                    <p>{getWeeklyTotal('callsMade')}</p>
                                    <small>This week's outreach</small>
                                </div>
                                <div className="tile">
                                    <h4>Call Conversion</h4>
                                    <p>{calls.made > 0 ? Math.round((calls.answered / calls.made) * 100) : 0}%</p>
                                    <small>Success rate</small>
                                </div>
                                <div className="tile">
                                    <h4>Weekly Appointments</h4>
                                    <p>{getWeeklyTotal('appointmentsSet')}</p>
                                    <small>Meetings scheduled</small>
                                </div>
                                <div className="tile">
                                    <h4>Weekly Offers</h4>
                                    <p>{getWeeklyTotal('offersWritten')}</p>
                                    <small>Offers submitted</small>
                                </div>
                            </div>
                            
                            {/* Progress Wheels */}
                            <div style={{marginTop: '30px'}}>
                                <h3 style={{textAlign: 'center', marginBottom: '20px'}}>📊 Weekly Goal Progress</h3>
                                <div className="progress-wheels-container">
                                    <div className="progress-wheel-item">
                                        <div className="progress-wheel-title">Daily Calls</div>
                                        <div style={{
                                            width: '100px',
                                            height: '100px',
                                            borderRadius: '50%',
                                            background: `conic-gradient(#28a745 ${Math.min((getWeeklyTotal('callsMade') / Math.max(goals.dailyCalls * 7, 1)) * 360, 360)}deg, #e9ecef 0deg)`,
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            margin: '0 auto 10px'
                                        }}>
                                            <div style={{
                                                width: '70px',
                                                height: '70px',
                                                borderRadius: '50%',
                                                background: 'white',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                fontSize: '14px',
                                                fontWeight: 'bold'
                                            }}>
                                                {goals.dailyCalls > 0 ? Math.round((getWeeklyTotal('callsMade') / (goals.dailyCalls * 7)) * 100) : 0}%
                                            </div>
                                        </div>
                                        <small>{getWeeklyTotal('callsMade')} / {goals.dailyCalls * 7}</small>
                                    </div>
                                    
                                    <div className="progress-wheel-item">
                                        <div className="progress-wheel-title">Weekly Appointments</div>
                                        <div style={{
                                            width: '100px',
                                            height: '100px',
                                            borderRadius: '50%',
                                            background: `conic-gradient(#007bff ${Math.min((getWeeklyTotal('appointmentsSet') / Math.max(goals.weeklyAppointments, 1)) * 360, 360)}deg, #e9ecef 0deg)`,
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            margin: '0 auto 10px'
                                        }}>
                                            <div style={{
                                                width: '70px',
                                                height: '70px',
                                                borderRadius: '50%',
                                                background: 'white',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                fontSize: '14px',
                                                fontWeight: 'bold'
                                            }}>
                                                {goals.weeklyAppointments > 0 ? Math.round((getWeeklyTotal('appointmentsSet') / goals.weeklyAppointments) * 100) : 0}%
                                            </div>
                                        </div>
                                        <small>{getWeeklyTotal('appointmentsSet')} / {goals.weeklyAppointments}</small>
                                    </div>
                                    
                                    <div className="progress-wheel-item">
                                        <div className="progress-wheel-title">Weekly Offers</div>
                                        <div style={{
                                            width: '100px',
                                            height: '100px',
                                            borderRadius: '50%',
                                            background: `conic-gradient(#ffc107 ${Math.min((getWeeklyTotal('offersWritten') / Math.max(goals.weeklyOffers, 1)) * 360, 360)}deg, #e9ecef 0deg)`,
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            margin: '0 auto 10px'
                                        }}>
                                            <div style={{
                                                width: '70px',
                                                height: '70px',
                                                borderRadius: '50%',
                                                background: 'white',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                fontSize: '14px',
                                                fontWeight: 'bold'
                                            }}>
                                                {goals.weeklyOffers > 0 ? Math.round((getWeeklyTotal('offersWritten') / goals.weeklyOffers) * 100) : 0}%
                                            </div>
                                        </div>
                                        <small>{getWeeklyTotal('offersWritten')} / {goals.weeklyOffers}</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Transactions Tab */}
                    {activeTab === 'transactions' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}>💰 Transactions & Properties</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Manage your properties and track transaction progress</p>
                            </div>
                            
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <button className="btn" onClick={addSampleProperty}>
                                    ➕ Add Sample Property
                                </button>
                            </div>
                            
                            {properties.length === 0 ? (
                                <div className="alert alert-info">
                                    <strong>No properties yet!</strong> Click "Add Sample Property" to get started.
                                </div>
                            ) : (
                                <div className="grid">
                                    {properties.map(property => (
                                        <div key={property.id} className="tile">
                                            <h4>{property.address}</h4>
                                            <p>${property.price.toLocaleString()}</p>
                                            <small>
                                                {property.client} • {property.status}<br/>
                                                Type: {property.type}
                                            </small>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    )}
                    
                    {/* Expenses Tab */}
                    {activeTab === 'expenses' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}>💳 Expense Management</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Track and manage your business expenses efficiently</p>
                            </div>
                            
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <button className="btn" onClick={addSampleExpense}>
                                    ➕ Add Sample Expense
                                </button>
                            </div>
                            
                            {/* Clean Expense Summary */}
                            <div className="grid">
                                <div className="tile">
                                    <h4>Total Expenses</h4>
                                    <p>${expenses.reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>All business expenses</small>
                                </div>
                                <div className="tile">
                                    <h4>Monthly Average</h4>
                                    <p>${expenses.length > 0 ? Math.round(expenses.reduce((sum, e) => sum + (e.amount || 0), 0) / Math.max(1, new Set(expenses.map(e => e.date.substring(0, 7))).size)).toLocaleString() : 0}</p>
                                    <small>Average per month</small>
                                </div>
                                <div className="tile">
                                    <h4>Most Expensive Category</h4>
                                    <p>
                                        {(() => {
                                            if (expenses.length === 0) return 'None';
                                            const categories = {};
                                            expenses.forEach(e => {
                                                categories[e.category] = (categories[e.category] || 0) + e.amount;
                                            });
                                            const maxCategory = Object.keys(categories).reduce((a, b) => categories[a] > categories[b] ? a : b, '');
                                            return maxCategory || 'None';
                                        })()}
                                    </p>
                                    <small>Highest spending area</small>
                                </div>
                            </div>
                            
                            {expenses.length === 0 ? (
                                <div className="alert alert-info" style={{marginTop: '20px'}}>
                                    <strong>No expenses recorded yet!</strong> Click "Add Sample Expense" to get started.
                                </div>
                            ) : (
                                <div style={{marginTop: '30px'}}>
                                    <h3>Recent Expenses</h3>
                                    <div className="grid">
                                        {expenses.slice(-6).map(expense => (
                                            <div key={expense.id} className="tile">
                                                <h4>{expense.category}</h4>
                                                <p>${expense.amount.toLocaleString()}</p>
                                                <small>
                                                    {expense.description}<br/>
                                                    {expense.date} • {expense.hoursWorked}hrs
                                                </small>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                    
                    {/* GCI Calculator Tab */}
                    {activeTab === 'gci' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}>🏆 GCI & Volume Calculator</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Calculate deals needed for your commission and volume goals</p>
                            </div>
                            
                            <div className="form-section">
                                <h3>📊 Deal Planning Calculator</h3>
                                <div className="grid">
                                    <div className="form-group">
                                        <label>💰 Average Sale Price</label>
                                        <input 
                                            type="number" 
                                            value={gciCalculator.averageSalePrice}
                                            onChange={(e) => setGciCalculator({
                                                ...gciCalculator, 
                                                averageSalePrice: parseFloat(e.target.value) || 0
                                            })}
                                            placeholder="e.g., 500000"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>📈 Commission Rate (%)</label>
                                        <input 
                                            type="number" 
                                            step="0.1"
                                            value={gciCalculator.commissionRate}
                                            onChange={(e) => {
                                                const rate = parseFloat(e.target.value) || 0;
                                                const avgCommission = gciCalculator.averageSalePrice * (rate / 100);
                                                setGciCalculator({
                                                    ...gciCalculator, 
                                                    commissionRate: rate,
                                                    averageCommissionPerDeal: avgCommission
                                                });
                                            }}
                                            placeholder="e.g., 2.5"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>💎 Desired Annual GCI</label>
                                        <input 
                                            type="number" 
                                            value={gciCalculator.desiredGCI}
                                            onChange={(e) => setGciCalculator({
                                                ...gciCalculator, 
                                                desiredGCI: parseFloat(e.target.value) || 0
                                            })}
                                            placeholder="e.g., 200000"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>📊 Desired Annual Volume</label>
                                        <input 
                                            type="number" 
                                            value={gciCalculator.desiredVolume}
                                            onChange={(e) => setGciCalculator({
                                                ...gciCalculator, 
                                                desiredVolume: parseFloat(e.target.value) || 0
                                            })}
                                            placeholder="e.g., 10000000"
                                        />
                                    </div>
                                </div>
                            </div>
                            
                            {/* Results */}
                            {(gciCalculator.averageSalePrice > 0 || gciCalculator.desiredGCI > 0 || gciCalculator.desiredVolume > 0) && (
                                <div className="calculator-results">
                                    <h3>🎯 Goal Analysis Results</h3>
                                    <div className="grid">
                                        <div className="tile">
                                            <h4>Avg Commission/Deal</h4>
                                            <p>${gciCalculator.averageCommissionPerDeal.toLocaleString()}</p>
                                            <small>Per transaction</small>
                                        </div>
                                        <div className="tile">
                                            <h4>Deals for GCI Goal</h4>
                                            <p>{calculateGCIDeals()}</p>
                                            <small>To reach ${gciCalculator.desiredGCI.toLocaleString()}</small>
                                        </div>
                                        <div className="tile">
                                            <h4>Deals for Volume Goal</h4>
                                            <p>{calculateVolumeDeals()}</p>
                                            <small>To reach ${gciCalculator.desiredVolume.toLocaleString()}</small>
                                        </div>
                                        <div className="tile">
                                            <h4>Recommended Target</h4>
                                            <p style={{color: Math.max(calculateGCIDeals(), calculateVolumeDeals()) === calculateGCIDeals() ? '#dc3545' : '#007bff'}}>
                                                {Math.max(calculateGCIDeals(), calculateVolumeDeals())}
                                            </p>
                                            <small>Higher requirement drives strategy</small>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                    
                    {/* Reports Tab */}
                    {activeTab === 'reports' && (
                        <div className="tab-content">
                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                <h2 style={{marginBottom: '10px'}}>📈 Performance Reports</h2>
                                <p style={{color: '#666', fontSize: '16px', margin: 0}}>Analyze your business performance and trends</p>
                            </div>
                            
                            <div className="grid">
                                <div className="tile">
                                    <h4>Total Properties</h4>
                                    <p>{properties.length}</p>
                                    <small>All time</small>
                                </div>
                                <div className="tile">
                                    <h4>Total Transactions</h4>
                                    <p>{transactions.length}</p>
                                    <small>All time</small>
                                </div>
                                <div className="tile">
                                    <h4>Total Expenses</h4>
                                    <p>{expenses.length}</p>
                                    <small>All time</small>
                                </div>
                                <div className="tile">
                                    <h4>Commission Rate</h4>
                                    <p>{totalCommission > 0 && transactions.length > 0 ? ((totalCommission / transactions.reduce((sum, t) => sum + t.amount, 0)) * 100).toFixed(2) : 0}%</p>
                                    <small>Average</small>
                                </div>
                            </div>
                            
                            <div className="alert alert-info" style={{marginTop: '30px'}}>
                                <strong>📊 Quick Analysis:</strong> 
                                {properties.length > 0 ? 
                                    ` You have managed ${properties.length} properties with ${transactions.filter(t => t.status === 'Closed').length} successful closings. Your current commission total is $${totalCommission.toLocaleString()}.` :
                                    ' No data available yet. Start by adding properties and tracking your daily activities.'
                                }
                            </div>
                        </div>
                    )}
                    
                    <div style={{marginTop: '40px', textAlign: 'center', color: '#666', fontSize: '14px', borderTop: '1px solid #ddd', paddingTop: '20px'}}>
                        ✅ Complete KPI Dashboard - All Features Working
                    </div>
                </div>
            );
        };
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
