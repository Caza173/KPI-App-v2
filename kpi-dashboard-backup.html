<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KPI Dashboard - All Tabs</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* Light Theme (Default) */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            transition: all 0.3s ease;
            --wheel-bg: white;
            --wheel-text: #333;
        }
        
        /* Dark Theme */
        body.dark-theme {
            background-color: #1a1a1a;
            color: #e0e0e0;
            --wheel-bg: #333;
            --wheel-text: #e0e0e0;
        }

        /* Ocean Theme */
        body.ocean-theme {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            --wheel-bg: rgba(255,255,255,0.9);
            --wheel-text: #333;
        }

        .ocean-theme .container {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            color: #333;
        }

        /* Forest Theme */
        body.forest-theme {
            background: linear-gradient(135deg, #134e5e 0%, #71b280 100%);
            color: #fff;
            --wheel-bg: rgba(255,255,255,0.9);
            --wheel-text: #333;
        }

        .forest-theme .container {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            color: #333;
        }

        /* Sunset Theme */
        body.sunset-theme {
            background: linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%);
            color: #333;
            --wheel-bg: rgba(255,255,255,0.9);
            --wheel-text: #333;
        }

        .sunset-theme .container {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            color: #333;
        }

        /* Purple Theme */
        body.purple-theme {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            --wheel-bg: rgba(255,255,255,0.9);
            --wheel-text: #333;
        }

        .purple-theme .container {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            color: #333;
        }

        /* Theme support for tiles */
        .ocean-theme .tile,
        .forest-theme .tile,
        .sunset-theme .tile,
        .purple-theme .tile {
            background: rgba(255,255,255,0.9) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        /* Theme support for form sections */
        .ocean-theme .form-section,
        .forest-theme .form-section,
        .sunset-theme .form-section,
        .purple-theme .form-section {
            background: rgba(255,255,255,0.9) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        /* Theme support for tabs */
        .ocean-theme .tab,
        .forest-theme .tab,
        .sunset-theme .tab,
        .purple-theme .tab {
            background: rgba(255,255,255,0.8) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .ocean-theme .tab:hover,
        .forest-theme .tab:hover,
        .sunset-theme .tab:hover,
        .purple-theme .tab:hover {
            background: rgba(255,255,255,0.9) !important;
        }

        .ocean-theme .tab.active,
        .forest-theme .tab.active,
        .sunset-theme .tab.active,
        .purple-theme .tab.active {
            background: rgba(0,123,255,0.9) !important;
            color: white !important;
        }

        /* Theme support for inputs and selects */
        .ocean-theme input,
        .ocean-theme select,
        .ocean-theme textarea,
        .forest-theme input,
        .forest-theme select,
        .forest-theme textarea,
        .sunset-theme input,
        .sunset-theme select,
        .sunset-theme textarea,
        .purple-theme input,
        .purple-theme select,
        .purple-theme textarea {
            background: rgba(255,255,255,0.9) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3) !important;
        }

        /* Theme support for buttons */
        .ocean-theme .btn,
        .forest-theme .btn,
        .sunset-theme .btn,
        .purple-theme .btn {
            background: rgba(0,123,255,0.9) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,123,255,0.3);
        }

        /* Theme support for property list items */
        .ocean-theme .property-item,
        .forest-theme .property-item,
        .sunset-theme .property-item,
        .purple-theme .property-item {
            background: rgba(255,255,255,0.85) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .ocean-theme .property-item:hover,
        .forest-theme .property-item:hover,
        .sunset-theme .property-item:hover,
        .purple-theme .property-item:hover {
            background: rgba(255,255,255,0.95) !important;
        }

        /* Theme support for status indicators */
        .ocean-theme .status-indicator,
        .forest-theme .status-indicator,
        .sunset-theme .status-indicator,
        .purple-theme .status-indicator {
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .dark-theme .container {
            background: #2d2d2d;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        /* Theme Toggle Button */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .theme-toggle:hover {
            background: #0056b3;
            transform: scale(1.1);
        }
        
        .dark-theme .theme-toggle {
            background: #ffc107;
            color: #000;
        }
        
        .dark-theme .theme-toggle:hover {
            background: #ffca2c;
        }
        
        /* Enhanced Transaction Card Styles */
        .transaction-card {
            transition: all 0.3s ease !important;
        }
        
        .transaction-card:hover {
            transform: translateY(-5px) !important;
            box-shadow: 0 12px 48px rgba(0,0,0,0.15) !important;
        }
        
        .dark-theme .transaction-card {
            background: rgba(64,64,64,0.95) !important;
            backdrop-filter: blur(10px) !important;
            border: 1px solid rgba(255,255,255,0.1) !important;
        }
        
        .ocean-theme .transaction-card,
        .forest-theme .transaction-card,
        .sunset-theme .transaction-card,
        .purple-theme .transaction-card {
            background: rgba(255,255,255,0.95) !important;
            backdrop-filter: blur(10px) !important;
        }
        
        /* Transaction grid responsive improvements */
        @media (max-width: 1200px) {
            .transaction-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)) !important;
            }
        }
        
        @media (max-width: 768px) {
            .transaction-grid {
                grid-template-columns: 1fr !important;
            }
        }
        
        /* ROI Tile Special Styling */
        .roi-tile {
            background: linear-gradient(135deg, #e8f5e8, #d4edda) !important;
            border: 2px solid #28a745 !important;
        }
        
        .dark-theme .roi-tile {
            background: linear-gradient(135deg, #2d5a2d, #1e3a1e) !important;
            border: 2px solid #28a745 !important;
            color: #e0e0e0 !important;
        }
        
        /* Hourly Wage and Labor Value tiles */
        .hourly-wage-tile {
            background: #fff3cd !important;
            border-color: #ffc107 !important;
        }
        
        .dark-theme .hourly-wage-tile {
            background: #5a4a1e !important;
            border-color: #ffc107 !important;
            color: #e0e0e0 !important;
        }
        
        .labor-value-tile {
            background: #e8f5e8 !important;
            border-color: #28a745 !important;
        }
        
        .dark-theme .labor-value-tile {
            background: #2d5a2d !important;
            border-color: #28a745 !important;
            color: #e0e0e0 !important;
        }
        
        .dark-theme .dark-calculation-results {
            background: #404040 !important;
            color: #e0e0e0 !important;
        }
        
        .dark-theme .dark-calculation-results strong {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .dark-calculation-results small {
            color: #aaa !important;
        }
        
        /* Transaction Grid Responsive */
        @media (max-width: 1024px) {
            .transaction-grid {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }
        
        @media (max-width: 768px) {
            .transaction-grid {
                grid-template-columns: 1fr !important;
            }
        }
        
        /* Dark theme for transaction cards */
        .dark-theme .transaction-card {
            background: #404040 !important;
            border-color: #555 !important;
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card strong {
            color: #e0e0e0 !important;
        }
        
        /* Expense Modal Styles */
        .expense-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .expense-modal-content {
            background: white;
            border-radius: 8px;
            padding: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .dark-theme .expense-modal-content {
            background: #2d2d2d;
            color: #e0e0e0;
        }
        
        .expense-button {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 4px;
        }
        
        .expense-button:hover {
            background: #138496;
        }
        
        .dark-theme .expense-button {
            background: #17a2b8;
        }
        
        .dark-theme .expense-button:hover {
            background: #138496;
        }
        
        /* Comprehensive dark theme text color fixes */
        .dark-theme strong {
            color: #e0e0e0 !important;
        }
        
        .dark-theme span {
            color: #e0e0e0 !important;
        }
        
        .dark-theme div[style*="color: #333"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme div[style*="color: #495057"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme div[style*="color: #666"] {
            color: #aaa !important;
        }
        
        .dark-theme h4 {
            color: #e0e0e0 !important;
        }
        
        .dark-theme h5 {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .expense-modal-content h3 {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .mileage-calculator h4 {
            color: #e0e0e0 !important;
        }
        
        /* Additional dark theme improvements */
        .dark-theme .transaction-card span {
            color: #e0e0e0 !important;
        }
        
        /* Comprehensive transaction card text fixes for dark theme */
        .dark-theme .transaction-card div[style*="color: #666"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card div[style*="color: #333"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card div[style*="color: #aaa"] {
            color: #ccc !important;
        }
        
        .dark-theme .transaction-card strong {
            color: #e0e0e0 !important;
        }
        
        /* Override all inline color styles in transaction cards for dark theme */
        .dark-theme .transaction-card [style*="color: #666"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card [style*="color: #333"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .transaction-card [style*="color: #aaa"] {
            color: #ccc !important;
        }
        
        /* Force all text in transaction cards to be white in dark theme */
        .dark-theme .transaction-card * {
            color: #e0e0e0 !important;
        }
        
        /* Preserve green/red colors for profit/loss indicators */
        .dark-theme .transaction-card [style*="color: #28a745"] {
            color: #28a745 !important;
        }
        
        .dark-theme .transaction-card [style*="color: #dc3545"] {
            color: #dc3545 !important;
        }
        
        /* Transaction card specific elements */
        .transaction-title {
            font-size: 16px;
            color: #333;
        }
        
        .dark-theme .transaction-title {
            color: #e0e0e0 !important;
        }
        
        .transaction-detail {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .dark-theme .transaction-detail {
            color: #e0e0e0 !important;
        }
        
        /* Special handling for disabled/muted text */
        .dark-theme .transaction-detail[style*="color: #aaa"] {
            color: #ccc !important;
        }
        
        .dark-theme .expense-modal-content div {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .expense-modal-content .expense-breakdown {
            background: #404040 !important;
        }
        
        /* Comprehensive expense modal dark theme fixes */
        .dark-theme .expense-modal-content [style*="color: #666"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .expense-modal-content [style*="color: #333"] {
            color: #e0e0e0 !important;
        }
        
        .dark-theme .expense-modal-content [style*="color: #aaa"] {
            color: #ccc !important;
        }
        
        .dark-theme .expense-modal-content strong {
            color: #e0e0e0 !important;
        }
        
        /* Expense modal background fix */
        .dark-theme .expense-modal-content > div > div[style*="backgroundColor: #f8f9fa"] {
            background-color: #404040 !important;
        }
        
        .dark-theme select {
            background: #555 !important;
            color: #e0e0e0 !important;
            border-color: #666 !important;
        }
        
        .dark-theme #mileageCalculator {
            background: #404040 !important;
            border-color: #555 !important;
        }
        
        .dark-theme .info-note {
            background: #1e3a3e !important;
            border-color: #4a6b70 !important;
            color: #a6e9ed !important;
        }
        
        /* Expense Edit Form Styles */
        .expense-edit-form {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .dark-theme .expense-edit-form {
            background: #404040;
            border-color: #555;
        }
        
        .edit-form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .edit-form-field {
            flex: 1;
            min-width: 120px;
        }
        
        .edit-form-field label {
            display: block;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 3px;
            color: #555;
        }
        
        .dark-theme .edit-form-field label {
            color: #ccc;
        }
        
        .edit-form-field input, .edit-form-field select, .edit-form-field textarea {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .dark-theme .edit-form-field input, 
        .dark-theme .edit-form-field select, 
        .dark-theme .edit-form-field textarea {
            background: #555;
            border-color: #666;
            color: #e0e0e0;
        }
        
        .edit-buttons {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 15px;
        }
        
        .edit-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        .edit-btn.save {
            background: #28a745;
            color: white;
        }
        
        .edit-btn.cancel {
            background: #6c757d;
            color: white;
        }
        
        .edit-btn:hover {
            opacity: 0.9;
        }
        
        .expense-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .edit-expense-btn {
            background: #17a2b8;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .edit-expense-btn:hover {
            background: #138496;
        }
        
        /* Modern Real Estate Property Tiles */
        .property-house-tiles {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .property-house-tile {
            position: relative;
            background: linear-gradient(145deg, #ffffff, #f0f8ff);
            border: 1px solid #e3f2fd;
            border-radius: 16px;
            padding: 20px 15px 15px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 120px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        
        .property-house-tile::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: height 0.3s ease;
        }
        
        .property-house-tile:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 40px rgba(0,123,255,0.15);
            background: linear-gradient(145deg, #ffffff, #f8fcff);
        }
        
        .property-house-tile:hover::before {
            height: 6px;
        }
        
        .property-house-tile.selected {
            background: linear-gradient(145deg, #e3f2fd, #bbdefb);
            border-color: #2196f3;
            box-shadow: 0 8px 32px rgba(33,150,243,0.25);
            transform: translateY(-4px);
        }
        
        .property-house-tile.selected::before {
            height: 6px;
            background: linear-gradient(90deg, #2196f3, #1976d2);
        }
        
        .property-house-tile .house-icon {
            font-size: 32px;
            display: block;
            margin-bottom: 8px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        
        .property-house-tile .address {
            font-weight: 700;
            font-size: 13px;
            margin-bottom: 4px;
            color: #1565c0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .property-house-tile .client {
            font-size: 11px;
            color: #64b5f6;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .property-house-tile .property-type {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(102,126,234,0.1);
            color: #667eea;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: 600;
        }
        
        /* Dark theme for modern property tiles */
        .dark-theme .property-house-tile {
            background: linear-gradient(145deg, #2a2a2a, #1f1f1f);
            border-color: #404040;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        .dark-theme .property-house-tile:hover {
            background: linear-gradient(145deg, #333, #2a2a2a);
            box-shadow: 0 12px 40px rgba(0,123,255,0.2);
        }
        
        .dark-theme .property-house-tile.selected {
            background: linear-gradient(145deg, #1e3a5f, #1a237e);
            border-color: #2196f3;
        }
        
        .dark-theme .property-house-tile .address {
            color: #64b5f6;
        }
        
        .dark-theme .property-house-tile .client {
            color: #90caf9;
        }
        
        .dark-theme .property-house-tile .property-type {
            background: rgba(100,181,246,0.2);
            color: #90caf9;
        }
        
        /* Theme support for property tiles */
        .ocean-theme .property-house-tile,
        .forest-theme .property-house-tile,
        .sunset-theme .property-house-tile,
        .purple-theme .property-house-tile {
            background: rgba(255,255,255,0.95) !important;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .ocean-theme .property-house-tile:hover,
        .forest-theme .property-house-tile:hover,
        .sunset-theme .property-house-tile:hover,
        .purple-theme .property-house-tile:hover {
            background: rgba(255,255,255,0.98) !important;
            box-shadow: 0 12px 40px rgba(255,255,255,0.2);
        }
        
        .ocean-theme .property-house-tile.selected,
        .forest-theme .property-house-tile.selected,
        .sunset-theme .property-house-tile.selected,
        .purple-theme .property-house-tile.selected {
            background: rgba(255,255,255,0.9) !important;
            border-color: rgba(255,255,255,0.6);
            box-shadow: 0 8px 32px rgba(255,255,255,0.3);
        }
        
        /* Report Modal Styles */
        .report-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        
        .report-modal-content {
            background: white;
            width: 90%;
            max-width: 800px;
            max-height: 90%;
            overflow-y: auto;
            border-radius: 8px;
            padding: 20px;
            position: relative;
        }
        
        .dark-theme .report-modal-content {
            background: #2d2d2d;
            color: #e0e0e0;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .dark-theme .report-header {
            border-bottom-color: #555;
        }
        
        .report-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .report-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .report-btn.print {
            background: #007bff;
            color: white;
        }
        
        .report-btn.close {
            background: #6c757d;
            color: white;
        }
        
        .report-content {
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        
        .report-content h1, .report-content h2, .report-content h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .dark-theme .report-content h1, 
        .dark-theme .report-content h2, 
        .dark-theme .report-content h3 {
            color: #e0e0e0;
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .report-table th, .report-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        .report-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .dark-theme .report-table th, 
        .dark-theme .report-table td {
            border-color: #555;
        }
        
        .dark-theme .report-table th {
            background: #404040;
        }
        
        @media print {
            .report-actions {
                display: none;
            }
            
            .report-modal {
                position: static;
                background: none;
            }
            
            .report-modal-content {
                width: 100%;
                max-width: none;
                box-shadow: none;
                padding: 0;
            }
        }
        .tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
        }
        .tab {
            padding: 12px 16px;
            cursor: pointer;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px 5px 0 0;
            font-size: 14px;
            font-weight: 500;
            min-width: 100px;
            text-align: center;
            white-space: nowrap;
            transition: all 0.2s ease;
        }
        
        .dark-theme .tab {
            background: #404040;
            border-color: #555;
            color: #e0e0e0;
        }
        
        .tab:hover {
            background: #e9ecef;
        }
        
        .dark-theme .tab:hover {
            background: #505050;
        }
        
        .tab.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .dark-theme .tab.active {
            background: #0056b3;
        }
        .tab-content {
            padding: 20px 0;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .tile {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #ddd;
            transition: transform 0.2s ease;
        }
        
        .dark-theme .tile {
            background: #404040;
            border-color: #555;
            color: #e0e0e0;
        }
        
        .tile:hover {
            transform: translateY(-2px);
        }
        .tile h4 {
            margin: 0 0 8px 0;
            color: #333;
            font-size: 14px;
        }
        .tile p {
            font-size: 22px;
            font-weight: bold;
            margin: 8px 0;
            color: #007bff;
        }
        .tile small {
            color: #666;
            font-size: 11px;
        }
        
        .dark-theme .tile h4 {
            color: #e0e0e0;
        }
        
        .dark-theme .tile p {
            color: #4dabf7;
        }
        
        .dark-theme .tile small {
            color: #aaa;
        }
        .form-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .dark-theme .form-section {
            background: #404040;
            color: #e0e0e0;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        .dark-theme .form-group label {
            color: #e0e0e0;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .dark-theme .form-group input, 
        .dark-theme .form-group select, 
        .dark-theme .form-group textarea {
            background: #555;
            border-color: #666;
            color: #e0e0e0;
        }
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }
        .btn {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s ease;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn:active {
            transform: translateY(1px);
        }
        .timestamp {
            text-align: right;
            color: #666;
            font-size: 12px;
            margin-bottom: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .dark-theme h1 {
            color: #e0e0e0;
        }
        
        h2 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .dark-theme h2 {
            color: #e0e0e0;
        }
        
        h3 {
            color: #555;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        .dark-theme h3 {
            color: #e0e0e0;
        }
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
        }
        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #b6d7e2;
        }
        
        .dark-theme .alert-info {
            color: #a6e9ed;
            background-color: #1c4d52;
            border-color: #2d6266;
        }
        
        .progress-bar {
            background-color: #e9ecef;
            border-radius: 4px;
            height: 20px;
            overflow: hidden;
        }
        
        .dark-theme .progress-bar {
            background-color: #555;
        }
        .progress-fill {
            background-color: #007bff;
            height: 100%;
            transition: width 0.3s ease;
        }
        
        /* Progress Wheel Styles */
        .progress-wheel {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            position: relative;
            margin: 10px auto;
            background: conic-gradient(from 0deg, var(--progress-color) var(--progress-angle), #e9ecef var(--progress-angle));
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .progress-wheel::before {
            content: '';
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--bg-color, white);
            position: absolute;
        }
        
        .progress-wheel-content {
            position: relative;
            z-index: 1;
            text-align: center;
            font-weight: bold;
        }
        
        .progress-wheel-percentage {
            font-size: 18px;
            color: var(--text-color, #333);
        }
        
        .progress-wheel-label {
            font-size: 12px;
            color: var(--text-color, #666);
            margin-top: 2px;
        }
        
        .dark-theme .progress-wheel {
            background: conic-gradient(from 0deg, var(--progress-color) var(--progress-angle), #555 var(--progress-angle));
        }
        
        .dark-theme .progress-wheel::before {
            background: var(--bg-color, #333);
        }
        
        .dark-theme .progress-wheel-percentage {
            color: var(--text-color, #e0e0e0);
        }
        
        .dark-theme .progress-wheel-label {
            color: var(--text-color, #aaa);
        }
        
        .progress-wheels-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .progress-wheel-item {
            text-align: center;
        }
        
        .progress-wheel-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 14px;
        }

        /* Progress Wheel Input Styles */
        .progress-wheel-input {
            text-align: center;
            margin: 15px;
        }

        .progress-wheel-input-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .progress-wheel-input-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .wheel-input {
            width: 80px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .wheel-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.25);
        }

        .wheel-input:disabled {
            background: #f8f9fa;
            color: #666;
            cursor: not-allowed;
        }

        .dark-theme .wheel-input {
            background: #555;
            border-color: #666;
            color: #e0e0e0;
        }

        .dark-theme .wheel-input:disabled {
            background: #444;
            color: #888;
        }

        /* Remove spinner arrows from ALL number inputs globally */
        input[type="number"] {
            -webkit-appearance: none;
            -moz-appearance: textfield;
            appearance: none;
        }

        /* Hide spinner arrows for WebKit browsers - more aggressive approach */
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none !important;
            margin: 0 !important;
            display: none !important;
        }

        /* Additional aggressive targeting for React inline styles */
        input[type="number"] {
            -webkit-appearance: none !important;
            -moz-appearance: textfield !important;
            appearance: none !important;
        }

        .progress-wheels-input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        /* Progress wheel center input styling */
        .progress-wheel-input .progress-wheel input {
            transition: all 0.3s ease;
            /* Hide spinner arrows */
            -webkit-appearance: none;
            -moz-appearance: textfield;
            appearance: none;
        }

        /* Hide spinner arrows for WebKit browsers */
        .progress-wheel-input .progress-wheel input::-webkit-outer-spin-button,
        .progress-wheel-input .progress-wheel input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .progress-wheel-input .progress-wheel input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }

        .dark-theme .progress-wheel-input .progress-wheel input {
            background: #555 !important;
            border-color: #666 !important;
            color: #e0e0e0 !important;
        }

        .dark-theme .progress-wheel-input .progress-wheel input:disabled {
            background: #444 !important;
            color: #888 !important;
        }

        /* Custom button controls for progress wheels */
        .progress-wheel-controls {
            background: rgba(255,255,255,0.9);
            border-radius: 12px;
            padding: 2px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .dark-theme .progress-wheel-controls {
            background: rgba(45,45,45,0.9) !important;
        }

        .progress-wheel-btn {
            transition: all 0.2s ease;
        }

        .progress-wheel-btn:hover:not(:disabled) {
            transform: scale(1.1);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .progress-wheel-display {
            background: rgba(255,255,255,0.8);
            border-radius: 8px;
            padding: 2px 4px;
        }

        .dark-theme .progress-wheel-display {
            background: rgba(45,45,45,0.8) !important;
            color: #e0e0e0 !important;
        }

        /* KPI Cards Animation */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* KPI Cards Grid */
        .kpi-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        /* Dark theme support for KPI cards */
        .dark-theme .kpi-card {
            background: #404040 !important;
            border-color: #666 !important;
            color: #e0e0e0 !important;
        }

        .dark-theme .kpi-card h3 {
            color: #e0e0e0 !important;
        }

        .dark-theme .kpi-card .controls {
            background: rgba(45,45,45,0.8) !important;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Progress Wheel Component
        const ProgressWheel = ({ percentage, label, color = '#007bff' }) => {
            const angle = Math.min(Math.max(percentage, 0), 100) * 3.6; // Convert percentage to degrees
            
            const getColor = (percentage) => {
                if (percentage >= 100) return '#28a745'; // Green
                if (percentage >= 75) return '#ffc107'; // Yellow
                if (percentage >= 50) return '#fd7e14'; // Orange
                return '#dc3545'; // Red
            };
            
            const wheelColor = getColor(percentage);
            
            return (
                <div className="progress-wheel-item">
                    <div className="progress-wheel-title">{label}</div>
                    <div 
                        className="progress-wheel"
                        style={{
                            '--progress-angle': `${angle}deg`,
                            '--progress-color': wheelColor,
                            '--bg-color': 'var(--wheel-bg, white)',
                            '--text-color': 'var(--wheel-text, #333)'
                        }}
                    >
                        <div className="progress-wheel-content">
                            <div className="progress-wheel-percentage">{Math.round(percentage)}%</div>
                            <div className="progress-wheel-label">Complete</div>
                        </div>
                    </div>
                </div>
            );
        };

        // Modern KPI Card Component
        const KPICard = ({ label, value, goal, onChange, disabled = false, step = 1, icon = "ðŸ“Š", isWeekly = false, dailyValue = 0 }) => {
            const [isEditing, setIsEditing] = useState(false);
            const [editValue, setEditValue] = useState(isWeekly ? dailyValue : value);
            
            // Calculate percentage properly - if goal is 0, only show green if value is also 0
            const percentage = goal > 0 ? Math.min((value / goal) * 100, 100) : (value === 0 ? 0 : 100);
            
            const getStatusColor = (percentage, goal) => {
                // If no goal is set, show neutral gray
                if (goal === 0) return { bg: '#f8f9fa', border: '#6c757d', text: '#495057' };
                
                // Standard color progression based on percentage
                if (percentage >= 100) return { bg: '#d4edda', border: '#28a745', text: '#155724' }; // Green - Achieved/Exceeded
                if (percentage >= 80) return { bg: '#fff3cd', border: '#ffc107', text: '#856404' }; // Yellow - Close to goal
                if (percentage >= 50) return { bg: '#fef5e7', border: '#fd7e14', text: '#8a4d02' }; // Orange - Halfway there
                if (percentage >= 25) return { bg: '#f8d7da', border: '#dc3545', text: '#721c24' }; // Red - Needs attention
                return { bg: '#f8d7da', border: '#dc3545', text: '#721c24' }; // Red - Very low/no progress
            };
            
            const colors = getStatusColor(percentage, goal);
            
            const handleIncrement = () => {
                if (!disabled) {
                    if (isWeekly) {
                        onChange(dailyValue + step);
                    } else {
                        onChange(value + step);
                    }
                }
            };
            
            const handleDecrement = () => {
                if (!disabled) {
                    if (isWeekly) {
                        if (dailyValue > 0) onChange(Math.max(0, dailyValue - step));
                    } else {
                        if (value > 0) onChange(Math.max(0, value - step));
                    }
                }
            };
            
            const handleEditStart = () => {
                if (!disabled) {
                    setIsEditing(true);
                    setEditValue(isWeekly ? dailyValue : value);
                }
            };
            
            const handleEditSave = () => {
                const newValue = parseInt(editValue) || 0;
                onChange(newValue);
                setIsEditing(false);
            };
            
            const handleEditCancel = () => {
                setIsEditing(false);
                setEditValue(isWeekly ? dailyValue : value);
            };
            
            return (
                <div style={{
                    background: colors.bg,
                    border: `2px solid ${colors.border}`,
                    borderRadius: '12px',
                    padding: '20px',
                    margin: '10px',
                    boxShadow: '0 4px 12px rgba(0,0,0,0.1)',
                    transition: 'all 0.3s ease',
                    position: 'relative',
                    overflow: 'hidden'
                }}>
                    {/* Header */}
                    <div style={{
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'space-between',
                        marginBottom: '15px'
                    }}>
                        <div style={{
                            display: 'flex',
                            alignItems: 'center',
                            gap: '10px'
                        }}>
                            <span style={{ fontSize: '24px' }}>{icon}</span>
                            <h3 style={{
                                margin: 0,
                                color: colors.text,
                                fontSize: '16px',
                                fontWeight: '600'
                            }}>
                                {label}
                            </h3>
                        </div>
                        <div style={{
                            background: colors.border,
                            color: 'white',
                            padding: '4px 8px',
                            borderRadius: '20px',
                            fontSize: '12px',
                            fontWeight: 'bold'
                        }}>
                            {goal > 0 ? Math.round(percentage) + '%' : 'No Goal'}
                        </div>
                    </div>
                    
                    {/* Progress Bar */}
                    <div style={{
                        background: 'rgba(255,255,255,0.5)',
                        borderRadius: '10px',
                        height: '8px',
                        marginBottom: '15px',
                        overflow: 'hidden'
                    }}>
                        <div style={{
                            background: colors.border,
                            height: '100%',
                            width: `${percentage}%`,
                            borderRadius: '10px',
                            transition: 'width 0.5s ease',
                            boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                        }} />
                    </div>
                    
                    {/* Controls */}
                    <div style={{
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'space-between'
                    }}>
                        <div style={{
                            display: 'flex',
                            alignItems: 'center',
                            gap: '8px',
                            background: 'rgba(255,255,255,0.8)',
                            borderRadius: '25px',
                            padding: '5px'
                        }}>
                            <button
                                onClick={handleDecrement}
                                disabled={disabled || (isWeekly ? (dailyValue <= 0) : (value <= 0))}
                                style={{
                                    width: '30px',
                                    height: '30px',
                                    border: 'none',
                                    borderRadius: '50%',
                                    background: disabled || (isWeekly ? (dailyValue <= 0) : (value <= 0)) ? '#e9ecef' : colors.border,
                                    color: disabled || (isWeekly ? (dailyValue <= 0) : (value <= 0)) ? '#6c757d' : 'white',
                                    fontSize: '16px',
                                    cursor: disabled || (isWeekly ? (dailyValue <= 0) : (value <= 0)) ? 'not-allowed' : 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    transition: 'all 0.2s ease',
                                    fontWeight: 'bold'
                                }}
                                onMouseEnter={(e) => {
                                    if (!disabled && (isWeekly ? (dailyValue > 0) : (value > 0))) {
                                        e.target.style.transform = 'scale(1.1)';
                                        e.target.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
                                    }
                                }}
                                onMouseLeave={(e) => {
                                    e.target.style.transform = 'scale(1)';
                                    e.target.style.boxShadow = 'none';
                                }}
                            >
                                âˆ’
                            </button>
                            
                            {isEditing ? (
                                <input
                                    type="number"
                                    value={editValue}
                                    onChange={(e) => setEditValue(e.target.value)}
                                    onBlur={handleEditSave}
                                    onKeyDown={(e) => {
                                        if (e.key === 'Enter') handleEditSave();
                                        if (e.key === 'Escape') handleEditCancel();
                                    }}
                                    autoFocus
                                    style={{
                                        width: '60px',
                                        textAlign: 'center',
                                        fontSize: '20px',
                                        fontWeight: 'bold',
                                        color: colors.text,
                                        border: '2px solid ' + colors.border,
                                        borderRadius: '4px',
                                        padding: '2px'
                                    }}
                                />
                            ) : (
                                <div 
                                    style={{
                                        fontSize: '20px',
                                        fontWeight: 'bold',
                                        color: colors.text,
                                        minWidth: '40px',
                                        textAlign: 'center',
                                        padding: '0 10px',
                                        cursor: disabled ? 'not-allowed' : 'pointer',
                                        borderRadius: '4px',
                                        transition: 'background-color 0.2s'
                                    }}
                                    onClick={handleEditStart}
                                    onMouseEnter={(e) => {
                                        if (!disabled) {
                                            e.target.style.backgroundColor = 'rgba(0,0,0,0.1)';
                                        }
                                    }}
                                    onMouseLeave={(e) => {
                                        e.target.style.backgroundColor = 'transparent';
                                    }}
                                    title={disabled ? '' : 'Click to edit directly'}
                                >
                                    {isWeekly ? dailyValue : value}
                                </div>
                            )}
                            
                            <button
                                onClick={handleIncrement}
                                disabled={disabled}
                                style={{
                                    width: '30px',
                                    height: '30px',
                                    border: 'none',
                                    borderRadius: '50%',
                                    background: disabled ? '#e9ecef' : colors.border,
                                    color: disabled ? '#6c757d' : 'white',
                                    fontSize: '16px',
                                    cursor: disabled ? 'not-allowed' : 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    transition: 'all 0.2s ease',
                                    fontWeight: 'bold'
                                }}
                                onMouseEnter={(e) => {
                                    if (!disabled) {
                                        e.target.style.transform = 'scale(1.1)';
                                        e.target.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
                                    }
                                }}
                                onMouseLeave={(e) => {
                                    e.target.style.transform = 'scale(1)';
                                    e.target.style.boxShadow = 'none';
                                }}
                            >
                                +
                            </button>
                        </div>
                        
                        <div style={{
                            fontSize: '14px',
                            color: colors.text,
                            fontWeight: '500',
                            textAlign: 'right'
                        }}>
                            {isWeekly ? (
                                <div>
                                    <div>This Week: <strong>{value}</strong></div>
                                    <div>Goal: <strong>{goal}</strong></div>
                                    <div style={{fontSize: '12px', opacity: 0.8}}>
                                        Today: +{dailyValue}
                                    </div>
                                </div>
                            ) : (
                                <div>Goal: {goal}</div>
                            )}
                        </div>
                    </div>
                    
                    {/* Achievement Badge */}
                    {goal > 0 && percentage >= 100 && (
                        <div style={{
                            position: 'absolute',
                            top: '10px',
                            right: '10px',
                            background: '#28a745',
                            color: 'white',
                            padding: '4px 8px',
                            borderRadius: '12px',
                            fontSize: '12px',
                            fontWeight: 'bold',
                            animation: 'pulse 2s infinite'
                        }}>
                            âœ… ACHIEVED!
                        </div>
                    )}
                </div>
            );
        };
        
        const App = () => {
            const [activeTab, setActiveTab] = useState('goals');
            const [properties, setProperties] = useState([]);
            const [transactions, setTransactions] = useState([]);
            const [expenses, setExpenses] = useState([]);
            const [hours, setHours] = useState([]);
            const [calls, setCalls] = useState({ made: 0, answered: 0 });
            const [appointments, setAppointments] = useState([]);
            const [gciData, setGciData] = useState({ gciGoal: 215000, current: 0 });
            const [dailyData, setDailyData] = useState({});
            const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);
            const [goals, setGoals] = useState(() => {
                const savedGoals = localStorage.getItem('kpiGoals');
                return savedGoals ? JSON.parse(savedGoals) : {
                    dailyCalls: 0,
                    weeklyAppointments: 0,
                    weeklyBuyerContracts: 0,
                    weeklyOffers: 0,
                    weeklyListings: 0,
                    monthlyClosings: 0,
                    annualGCI: 0,
                    hoursWorked: 0
                };
            });
            const [goalsLocked, setGoalsLocked] = useState(() => {
                return localStorage.getItem('kpiGoalsLocked') === 'true';
            });
            const [originalLockedGoals, setOriginalLockedGoals] = useState(() => {
                const saved = localStorage.getItem('kpiOriginalGoals');
                return saved ? JSON.parse(saved) : null;
            });
            const [propertySearchTerm, setPropertySearchTerm] = useState('');
            const [propertyStatusFilter, setPropertyStatusFilter] = useState('');
            const [propertyTypeFilter, setPropertyTypeFilter] = useState('');
            const [gciCalculator, setGciCalculator] = useState({
                averageSalePrice: 350000,
                commissionRate: 2.5,
                averageCommissionPerDeal: 8750, // Default commission per deal
                desiredGCI: 215000,
                dealsNeeded: 0
            });
            const [selectedPropertyForExpenses, setSelectedPropertyForExpenses] = useState(null);
            const [currentTheme, setCurrentTheme] = useState('light');
            const themes = [
                { name: 'light', icon: 'ðŸŽ¨', label: 'Light' },
                { name: 'dark', icon: 'ðŸŒ™', label: 'Dark' },
                { name: 'ocean', icon: 'ðŸŒŠ', label: 'Ocean' },
                { name: 'forest', icon: 'ðŸŒ²', label: 'Forest' },
                { name: 'sunset', icon: 'ðŸŒ…', label: 'Sunset' },
                { name: 'purple', icon: 'ðŸ’œ', label: 'Purple' }
            ];
            const [hourlyWage, setHourlyWage] = useState(50); // Default $50/hour
            const [showExpenseModal, setShowExpenseModal] = useState(false);
            const [selectedTransactionExpenses, setSelectedTransactionExpenses] = useState([]);
            const [editingExpense, setEditingExpense] = useState(null);
            const [isEditMode, setIsEditMode] = useState(false);
            const [selectedPropertyForExpense, setSelectedPropertyForExpense] = useState(null);
            const [showReportModal, setShowReportModal] = useState(false);
            const [currentReport, setCurrentReport] = useState(null);
            
            // Daily input values
            const [dailyInputs, setDailyInputs] = useState({
                hoursWorked: 0,
                callsMade: 0,
                callsAnswered: 0,
                appointmentsSet: 0,
                offersWritten: 0,
                buyerContracts: 0,
                listingsObtained: 0
            });
            
            // Load initial data and set up functionality
            useEffect(() => {
                const sampleProperties = [
                    { id: 1, address: '123 Main St', client: 'John Doe', status: 'Active', price: 350000, type: 'Seller', statusNote: '' },
                    { id: 2, address: '456 Oak Ave', client: 'Jane Smith', status: 'Closed', price: 425000, type: 'Seller', statusNote: '' },
                    { id: 3, address: '789 Pine Rd', client: 'Bob Johnson', status: 'Pending', price: 275000, type: 'Buyer', statusNote: '' }
                ];
                setProperties(sampleProperties);
                
                const sampleTransactions = [
                    { id: 1, amount: 350000, commission: 8750, status: 'Closed', property: '123 Main St', date: '2025-07-15' },
                    { id: 2, amount: 425000, commission: 10625, status: 'Closed', property: '456 Oak Ave', date: '2025-07-10' },
                    { id: 3, amount: 275000, commission: 6875, status: 'Pending', property: '789 Pine Rd', date: '2025-07-05' }
                ];
                setTransactions(sampleTransactions);
                
                setCalls({ made: 15, answered: 12 });
                setAppointments([
                    { id: 1, date: '2025-07-16', time: '10:00', client: 'John Doe' },
                    { id: 2, date: '2025-07-16', time: '14:00', client: 'Jane Smith' }
                ]);
                
                const sampleExpenses = [
                    { 
                        id: 1, 
                        date: '2025-07-20', 
                        propertyId: 1, 
                        propertyAddress: '123 Main St', 
                        category: 'Travel', 
                        amount: 30, 
                        hoursWorked: 0.5,
                        description: 'Gas for property visit', 
                        vendor: 'Shell Station' 
                    },
                    { 
                        id: 2, 
                        date: '2025-07-20', 
                        propertyId: 1, 
                        propertyAddress: '123 Main St', 
                        category: 'Staging', 
                        amount: 1500, 
                        hoursWorked: 4,
                        description: 'Professional staging setup', 
                        vendor: 'Elite Staging Co' 
                    }
                ];
                setExpenses(sampleExpenses);
            }, []);
            
            // Load daily data when selected date changes
            useEffect(() => {
                if (dailyData[selectedDate]) {
                    setDailyInputs({
                        hoursWorked: dailyData[selectedDate].hoursWorked || 0,
                        callsMade: dailyData[selectedDate].callsMade || 0,
                        callsAnswered: dailyData[selectedDate].callsAnswered || 0,
                        appointmentsSet: dailyData[selectedDate].appointmentsSet || 0,
                        offersWritten: dailyData[selectedDate].offersWritten || 0,
                        buyerContracts: dailyData[selectedDate].buyerContracts || 0,
                        listingsObtained: dailyData[selectedDate].listingsObtained || 0
                    });
                } else {
                    // Clear inputs for new date
                    setDailyInputs({
                        hoursWorked: 0,
                        callsMade: 0,
                        callsAnswered: 0,
                        appointmentsSet: 0,
                        offersWritten: 0,
                        buyerContracts: 0,
                        listingsObtained: 0
                    });
                }
            }, [selectedDate, dailyData]);
            
            // Property management functions
            const addProperty = (propertyData) => {
                const newProperty = {
                    id: Math.max(...properties.map(p => p.id), 0) + 1,
                    ...propertyData
                };
                setProperties([...properties, newProperty]);
                
                // Always create transaction for every property, default status is "Inactive"
                const commission = propertyData.status === 'Closed' ? propertyData.price * 0.025 : 0;
                const newTransaction = {
                    id: Math.max(...transactions.map(t => t.id), 0) + 1,
                    amount: propertyData.price,
                    commission: commission,
                    status: 'Inactive', // Default status is always Inactive
                    property: propertyData.address,
                    date: new Date().toISOString().split('T')[0]
                };
                setTransactions([...transactions, newTransaction]);
            };
            
            const deleteProperty = (propertyId) => {
                setProperties(properties.filter(p => p.id !== propertyId));
            };
            
            // Function to update transaction status and recalculate commission
            const updateTransactionStatus = (transactionId, newStatus) => {
                setTransactions(transactions.map(transaction => {
                    if (transaction.id === transactionId) {
                        const newCommission = newStatus === 'Closed' ? transaction.amount * 0.025 : 0;
                        
                        // Also update the corresponding property status
                        setProperties(properties.map(property => {
                            if (property.address === transaction.property) {
                                return {
                                    ...property,
                                    status: newStatus
                                };
                            }
                            return property;
                        }));
                        
                        return {
                            ...transaction,
                            status: newStatus,
                            commission: newCommission
                        };
                    }
                    return transaction;
                }));
            };
            
            const addExpense = (expenseData) => {
                const newExpense = {
                    id: Math.max(...expenses.map(e => e.id), 0) + 1,
                    ...expenseData
                };
                setExpenses([...expenses, newExpense]);
            };
            
            const updateExpense = (expenseId, updatedData) => {
                setExpenses(prev => prev.map(expense => 
                    expense.id === expenseId 
                        ? { ...expense, ...updatedData }
                        : expense
                ));
                // Update the modal data if it's currently showing
                setSelectedTransactionExpenses(prev => prev.map(expense =>
                    expense.id === expenseId
                        ? { ...expense, ...updatedData }
                        : expense
                ));
            };
            
            // Calculate effective hourly wage based on closed transactions and hours worked
            const calculateEffectiveHourlyWage = () => {
                const closedTransactions = transactions.filter(t => t.status === 'Closed');
                const totalCommission = closedTransactions.reduce((sum, t) => sum + t.commission, 0);
                
                // Get expenses for closed transactions only
                const closedTransactionExpenses = expenses.filter(expense => {
                    if (!expense.propertyId) return false;
                    const property = properties.find(p => p.id === expense.propertyId);
                    return property && property.status === 'Closed';
                });
                
                const totalHoursWorked = closedTransactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0);
                
                if (totalHoursWorked === 0) return 0;
                
                return totalCommission / totalHoursWorked;
            };
            
            // Helper function to get week start date (Monday)
            const getWeekStart = (date) => {
                const d = new Date(date);
                const day = d.getDay();
                const diff = d.getDate() - day + (day === 0 ? -6 : 1); // Adjust when day is Sunday
                return new Date(d.setDate(diff)).toISOString().split('T')[0];
            };
            
            // Calculate weekly totals for goals
            const getWeeklyTotal = (field, targetDate = selectedDate) => {
                const weekStart = getWeekStart(targetDate);
                const weekData = Object.entries(dailyData).filter(([date]) => {
                    const entryWeekStart = getWeekStart(date);
                    return entryWeekStart === weekStart;
                });
                
                return weekData.reduce((sum, [_, data]) => sum + (data[field] || 0), 0);
            };
            
            // Calculate weekly progress percentage
            const getWeeklyProgress = (field, weeklyGoal, targetDate = selectedDate) => {
                const total = getWeeklyTotal(field, targetDate);
                return weeklyGoal > 0 ? (total / weeklyGoal) * 100 : 0;
            };
            
            // Get current week expenses
            const getCurrentWeekExpenses = () => {
                const weekStart = getWeekStart(selectedDate);
                return expenses.filter(expense => {
                    const expenseWeekStart = getWeekStart(expense.date);
                    return expenseWeekStart === weekStart;
                });
            };
            
            // Get current month expenses
            const getCurrentMonthExpenses = () => {
                const currentMonth = selectedDate.substring(0, 7); // YYYY-MM format
                return expenses.filter(expense => {
                    const expenseMonth = expense.date.substring(0, 7);
                    return expenseMonth === currentMonth;
                });
            };
            
            // Generate report functions
            const generateExpenseReport = () => {
                const totalExpenses = expenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                const totalHours = expenses.reduce((sum, e) => sum + (e.hoursWorked || 0), 0);
                
                const categorySummary = expenses.reduce((acc, expense) => {
                    const category = expense.category || 'Other';
                    if (!acc[category]) {
                        acc[category] = { amount: 0, count: 0, hours: 0 };
                    }
                    acc[category].amount += expense.amount || 0;
                    acc[category].count += 1;
                    acc[category].hours += expense.hoursWorked || 0;
                    return acc;
                }, {});
                
                return {
                    title: 'Expense Report',
                    totalExpenses,
                    totalHours,
                    categorySummary,
                    expenses: expenses.sort((a, b) => new Date(b.date) - new Date(a.date))
                };
            };
            
            const generateWeeklyReport = () => {
                const weekExpenses = getCurrentWeekExpenses();
                const weekStart = getWeekStart(selectedDate);
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekEnd.getDate() + 6);
                
                const weeklyData = Object.entries(dailyData).filter(([date]) => {
                    const entryWeekStart = getWeekStart(date);
                    return entryWeekStart === weekStart;
                });
                
                const weeklyTotals = {
                    hoursWorked: getWeeklyTotal('hoursWorked'),
                    callsMade: getWeeklyTotal('callsMade'),
                    callsAnswered: getWeeklyTotal('callsAnswered'),
                    appointmentsSet: getWeeklyTotal('appointmentsSet'),
                    offersWritten: getWeeklyTotal('offersWritten'),
                    buyerContracts: getWeeklyTotal('buyerContracts'),
                    listingsObtained: getWeeklyTotal('listingsObtained')
                };
                
                return {
                    title: 'Weekly Report',
                    weekStart,
                    weekEnd: weekEnd.toISOString().split('T')[0],
                    expenses: weekExpenses,
                    dailyData: weeklyData,
                    totals: weeklyTotals,
                    goals
                };
            };
            
            const generateDailyReport = () => {
                const dayData = dailyData[selectedDate] || {};
                const dayExpenses = expenses.filter(e => e.date === selectedDate);
                
                return {
                    title: 'Daily Report',
                    date: selectedDate,
                    data: dayData,
                    expenses: dayExpenses,
                    goals
                };
            };
            
            const saveDailyData = (data) => {
                setDailyData(prev => ({
                    ...prev,
                    [data.date]: data
                }));
                setCalls({ made: data.callsMade || 0, answered: data.callsAnswered || 0 });
                // Also update dailyInputs to reflect saved data
                setDailyInputs({
                    hoursWorked: data.hoursWorked || 0,
                    callsMade: data.callsMade || 0,
                    callsAnswered: data.callsAnswered || 0,
                    appointmentsSet: data.appointmentsSet || 0,
                    offersWritten: data.offersWritten || 0,
                    buyerContracts: data.buyerContracts || 0,
                    listingsObtained: data.listingsObtained || 0
                });
            };
            
            // GCI Calculator function
            const calculateDealsNeeded = (avgPrice, commissionRate, desiredGCI, manualCommissionPerDeal = null) => {
                if (desiredGCI > 0) {
                    let commissionPerDeal = manualCommissionPerDeal;
                    if (!commissionPerDeal && avgPrice > 0 && commissionRate > 0) {
                        commissionPerDeal = (avgPrice * commissionRate) / 100;
                    }
                    if (commissionPerDeal > 0) {
                        return Math.ceil(desiredGCI / commissionPerDeal);
                    }
                }
                return 0;
            };
            
            // Mileage Calculator function
            const calculateMileageCost = () => {
                const mileage = parseFloat(document.getElementById('mileageInput')?.value) || 0;
                const gasPrice = parseFloat(document.getElementById('gasPriceInput')?.value) || 0;
                const mpg = parseFloat(document.getElementById('mpgInput')?.value) || 20;
                
                if (mileage > 0 && gasPrice > 0 && mpg > 0) {
                    const gallonsUsed = mileage / mpg;
                    const totalCost = gallonsUsed * gasPrice;
                    const calculatedCostElement = document.getElementById('calculatedCost');
                    if (calculatedCostElement) {
                        calculatedCostElement.value = `$${totalCost.toFixed(2)}`;
                    }
                }
            };
            
            // Function to toggle mileage calculator
            const toggleMileageCalculator = (category) => {
                const calculator = document.getElementById('mileageCalculator');
                if (calculator) {
                    calculator.style.display = category === 'Travel' ? 'block' : 'none';
                }
            };
            
            // Theme toggle function
            const toggleTheme = () => {
                const currentIndex = themes.findIndex(t => t.name === currentTheme);
                const nextIndex = (currentIndex + 1) % themes.length;
                const newTheme = themes[nextIndex].name;
                setCurrentTheme(newTheme);
            };
            
            // Set initial theme
            React.useEffect(() => {
                document.body.className = currentTheme === 'light' ? '' : `${currentTheme}-theme`;
            }, [currentTheme]);
            
            const totalCommission = transactions.reduce((sum, t) => sum + (t.commission || 0), 0);
            const closedDeals = transactions.filter(t => t.status === 'Closed');
            
            return (
                <div className="container">
                    {/* Theme Toggle Button */}
                    <button 
                        className="theme-toggle" 
                        onClick={toggleTheme}
                        title={`Current: ${themes.find(t => t.name === currentTheme)?.label} - Click to cycle themes`}
                    >
                        {themes.find(t => t.name === currentTheme)?.icon || 'ï¿½'}
                    </button>
                    
                    <h1>Real Estate KPI Dashboard</h1>
                    <div className="timestamp">
                        <span>Last Updated: {new Date().toLocaleString()}</span>
                    </div>
                    
                    {/* Navigation Tabs */}
                    <div className="tabs">
                        <div 
                            className={`tab ${activeTab === 'goals' ? 'active' : ''}`}
                            onClick={() => setActiveTab('goals')}
                        >
                            Goals
                        </div>
                        <div 
                            className={`tab ${activeTab === 'properties' ? 'active' : ''}`}
                            onClick={() => setActiveTab('properties')}
                        >
                            Properties
                        </div>
                        <div 
                            className={`tab ${activeTab === 'transactions' ? 'active' : ''}`}
                            onClick={() => setActiveTab('transactions')}
                        >
                            Transactions
                        </div>
                        <div 
                            className={`tab ${activeTab === 'expenses' ? 'active' : ''}`}
                            onClick={() => setActiveTab('expenses')}
                        >
                            Expenses
                        </div>
                        <div 
                            className={`tab ${activeTab === 'reports' ? 'active' : ''}`}
                            onClick={() => setActiveTab('reports')}
                        >
                            Reports
                        </div>
                        <div 
                            className={`tab ${activeTab === 'gci' ? 'active' : ''}`}
                            onClick={() => setActiveTab('gci')}
                        >
                            GCI Calculator
                        </div>
                        <div 
                            className={`tab ${activeTab === 'performance' ? 'active' : ''}`}
                            onClick={() => setActiveTab('performance')}
                        >
                            Performance
                        </div>
                    </div>
                    
                    {/* Goals Tab */}
                    {activeTab === 'goals' && (
                        <div className="tab-content">
                            <h2>ðŸŽ¯ Daily KPI Tracking</h2>
                            
                            {/* Goals Setting Section */}
                            <div style={{
                                marginBottom: '30px',
                                padding: '20px',
                                background: '#f8f9fa',
                                borderRadius: '12px',
                                border: '2px solid #dee2e6'
                            }}>
                                <h3>ðŸŽ¯ Set Your Daily Goals</h3>
                                {goalsLocked && originalLockedGoals && JSON.stringify(goals) !== JSON.stringify({ ...originalLockedGoals, lockedDate: originalLockedGoals.lockedDate }) && (
                                    <div style={{
                                        background: '#f8d7da',
                                        border: '1px solid #f5c6cb',
                                        borderRadius: '6px',
                                        padding: '10px',
                                        marginTop: '10px',
                                        marginBottom: '15px',
                                        color: '#721c24',
                                        fontSize: '14px',
                                        fontWeight: '500'
                                    }}>
                                        âš ï¸ <strong>Goals Modified</strong> - Current goals differ from original locked goals (set on {new Date(originalLockedGoals.lockedDate).toLocaleDateString()}). Original goals are preserved for integrity.
                                    </div>
                                )}
                                {goalsLocked && originalLockedGoals && JSON.stringify(goals) === JSON.stringify({ ...originalLockedGoals, lockedDate: originalLockedGoals.lockedDate }) && (
                                    <div style={{
                                        background: '#d4edda',
                                        border: '1px solid #c3e6cb',
                                        borderRadius: '6px',
                                        padding: '10px',
                                        marginTop: '10px',
                                        marginBottom: '15px',
                                        color: '#155724',
                                        fontSize: '14px',
                                        fontWeight: '500'
                                    }}>
                                        ðŸ”’ <strong>Goals are locked</strong> - Matches original goals set on {new Date(originalLockedGoals.lockedDate).toLocaleDateString()}.
                                    </div>
                                )}
                                {goalsLocked && !originalLockedGoals && (
                                    <div style={{
                                        background: '#d4edda',
                                        border: '1px solid #c3e6cb',
                                        borderRadius: '6px',
                                        padding: '10px',
                                        marginTop: '10px',
                                        marginBottom: '15px',
                                        color: '#155724',
                                        fontSize: '14px',
                                        fontWeight: '500'
                                    }}>
                                        ðŸ”’ <strong>Goals are locked</strong> - Your goals are protected from accidental changes.
                                    </div>
                                )}
                                {!goalsLocked && (
                                    <div style={{
                                        background: '#fff3cd',
                                        border: '1px solid #ffeaa7',
                                        borderRadius: '6px',
                                        padding: '10px',
                                        marginTop: '10px',
                                        marginBottom: '15px',
                                        color: '#856404',
                                        fontSize: '14px',
                                        fontWeight: '500'
                                    }}>
                                        ðŸ”“ <strong>Goals are unlocked</strong> - You can modify your goals. Click "Lock Goals" when you're ready to start tracking.
                                    </div>
                                )}
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',
                                    gap: '15px',
                                    marginTop: '15px'
                                }}>
                                    <div>
                                        <label style={{display: 'block', fontWeight: 'bold', marginBottom: '5px'}}>
                                            â° Hours Worked Goal:
                                        </label>
                                        <input
                                            type="number"
                                            value={goals.hoursWorked}
                                            onChange={(e) => setGoals({...goals, hoursWorked: parseFloat(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                            style={{
                                                width: '100%',
                                                padding: '8px',
                                                borderRadius: '6px',
                                                border: '2px solid #ddd',
                                                fontSize: '14px',
                                                background: goalsLocked ? '#f8f9fa' : 'white',
                                                cursor: goalsLocked ? 'not-allowed' : 'text'
                                            }}
                                            step="0.5"
                                            min="0"
                                            max="24"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{display: 'block', fontWeight: 'bold', marginBottom: '5px'}}>
                                            ðŸ“ž Daily Calls Goal:
                                        </label>
                                        <input
                                            type="number"
                                            value={goals.dailyCalls}
                                            onChange={(e) => setGoals({...goals, dailyCalls: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                            style={{
                                                width: '100%',
                                                padding: '8px',
                                                borderRadius: '6px',
                                                border: '2px solid #ddd',
                                                fontSize: '14px',
                                                background: goalsLocked ? '#f8f9fa' : 'white',
                                                cursor: goalsLocked ? 'not-allowed' : 'text'
                                            }}
                                            min="0"
                                            max="200"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{display: 'block', fontWeight: 'bold', marginBottom: '5px'}}>
                                            ðŸ“… Weekly Appointments Goal:
                                        </label>
                                        <input
                                            type="number"
                                            value={goals.weeklyAppointments}
                                            onChange={(e) => setGoals({...goals, weeklyAppointments: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                            style={{
                                                width: '100%',
                                                padding: '8px',
                                                borderRadius: '6px',
                                                border: '2px solid #ddd',
                                                fontSize: '14px',
                                                background: goalsLocked ? '#f8f9fa' : 'white',
                                                cursor: goalsLocked ? 'not-allowed' : 'text'
                                            }}
                                            min="0"
                                            max="50"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{display: 'block', fontWeight: 'bold', marginBottom: '5px'}}>
                                            ðŸ“ Weekly Offers Goal:
                                        </label>
                                        <input
                                            type="number"
                                            value={goals.weeklyOffers}
                                            onChange={(e) => setGoals({...goals, weeklyOffers: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                            style={{
                                                width: '100%',
                                                padding: '8px',
                                                borderRadius: '6px',
                                                border: '2px solid #ddd',
                                                fontSize: '14px',
                                                background: goalsLocked ? '#f8f9fa' : 'white',
                                                cursor: goalsLocked ? 'not-allowed' : 'text'
                                            }}
                                            min="0"
                                            max="30"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{display: 'block', fontWeight: 'bold', marginBottom: '5px'}}>
                                            ðŸ  Weekly Buyer Contracts Goal:
                                        </label>
                                        <input
                                            type="number"
                                            value={goals.weeklyBuyerContracts}
                                            onChange={(e) => setGoals({...goals, weeklyBuyerContracts: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                            style={{
                                                width: '100%',
                                                padding: '8px',
                                                borderRadius: '6px',
                                                border: '2px solid #ddd',
                                                fontSize: '14px',
                                                background: goalsLocked ? '#f8f9fa' : 'white',
                                                cursor: goalsLocked ? 'not-allowed' : 'text'
                                            }}
                                            min="0"
                                            max="20"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label style={{display: 'block', fontWeight: 'bold', marginBottom: '5px'}}>
                                            ðŸ“‹ Weekly Listings Goal:
                                        </label>
                                        <input
                                            type="number"
                                            value={goals.weeklyListings}
                                            onChange={(e) => setGoals({...goals, weeklyListings: parseInt(e.target.value) || 0})}
                                            disabled={goalsLocked}
                                            style={{
                                                width: '100%',
                                                padding: '8px',
                                                borderRadius: '6px',
                                                border: '2px solid #ddd',
                                                fontSize: '14px',
                                                background: goalsLocked ? '#f8f9fa' : 'white',
                                                cursor: goalsLocked ? 'not-allowed' : 'text'
                                            }}
                                            min="0"
                                            max="15"
                                        />
                                    </div>
                                </div>
                                
                                <div style={{
                                    display: 'flex',
                                    gap: '10px',
                                    justifyContent: 'center',
                                    marginTop: '15px'
                                }}>
                                    <button 
                                        className="btn"
                                        onClick={() => {
                                            localStorage.setItem('kpiGoals', JSON.stringify(goals));
                                            alert('Goals saved successfully!');
                                        }}
                                        disabled={goalsLocked}
                                        style={{
                                            background: goalsLocked ? '#6c757d' : '#007bff',
                                            color: 'white',
                                            border: 'none',
                                            padding: '10px 20px',
                                            borderRadius: '6px',
                                            cursor: goalsLocked ? 'not-allowed' : 'pointer',
                                            opacity: goalsLocked ? 0.6 : 1
                                        }}
                                    >
                                        ðŸ’¾ Save Goals
                                    </button>
                                    
                                    <button 
                                        className="btn"
                                        onClick={() => {
                                            setGoals({
                                                hoursWorked: 0,
                                                dailyCalls: 0,
                                                weeklyAppointments: 0,
                                                weeklyOffers: 0,
                                                weeklyBuyerContracts: 0,
                                                weeklyListings: 0
                                            });
                                        }}
                                        disabled={goalsLocked}
                                        style={{
                                            background: goalsLocked ? '#6c757d' : '#6c757d',
                                            color: 'white',
                                            border: 'none',
                                            padding: '10px 20px',
                                            borderRadius: '6px',
                                            cursor: goalsLocked ? 'not-allowed' : 'pointer',
                                            opacity: goalsLocked ? 0.6 : 1
                                        }}
                                    >
                                        ðŸ”„ Reset to Defaults
                                    </button>
                                    
                                    <button 
                                        className="btn"
                                        onClick={() => {
                                            if (goalsLocked) {
                                                if (confirm('Are you sure you want to unlock your goals? This will allow you to modify them, but the original locked goals will still be preserved for integrity.')) {
                                                    setGoalsLocked(false);
                                                    localStorage.setItem('kpiGoalsLocked', 'false');
                                                }
                                            } else {
                                                if (confirm('Are you sure you want to lock your goals? This will prevent further modifications and save the original goals for integrity tracking.')) {
                                                    // Save goals when locking
                                                    localStorage.setItem('kpiGoals', JSON.stringify(goals));
                                                    localStorage.setItem('kpiGoalsLocked', 'true');
                                                    
                                                    // Store original goals for integrity (only if not already stored)
                                                    if (!originalLockedGoals) {
                                                        const originalGoals = { ...goals, lockedDate: new Date().toISOString() };
                                                        setOriginalLockedGoals(originalGoals);
                                                        localStorage.setItem('kpiOriginalGoals', JSON.stringify(originalGoals));
                                                    }
                                                    
                                                    setGoalsLocked(true);
                                                }
                                            }
                                        }}
                                        style={{
                                            background: goalsLocked ? '#28a745' : '#dc3545',
                                            color: 'white',
                                            border: 'none',
                                            padding: '10px 20px',
                                            borderRadius: '6px',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        {goalsLocked ? 'ðŸ”“ Unlock Goals' : 'ðŸ”’ Lock Goals'}
                                    </button>
                                </div>
                            </div>
                            
                            <h3>ðŸ“Š Today's Activity Input</h3>
                            
                            <div className="kpi-cards-grid">
                                <KPICard
                                    label="Hours Worked"
                                    value={dailyInputs.hoursWorked}
                                    goal={goals.hoursWorked}
                                    onChange={(val) => setDailyInputs({...dailyInputs, hoursWorked: val})}
                                    icon="â°"
                                />
                                
                                <KPICard
                                    label="Calls Made"
                                    value={dailyInputs.callsMade}
                                    goal={goals.dailyCalls}
                                    onChange={(val) => setDailyInputs({...dailyInputs, callsMade: val})}
                                    icon="ðŸ“ž"
                                />
                                
                                <KPICard
                                    label="Calls Answered"
                                    value={dailyInputs.callsAnswered}
                                    goal={goals.dailyCalls > 0 ? Math.round(goals.dailyCalls * 0.3) : 0}
                                    onChange={(val) => setDailyInputs({...dailyInputs, callsAnswered: val})}
                                    icon="âœ…"
                                />
                                
                                <KPICard
                                    label="Appointments Set (Weekly)"
                                    value={getWeeklyTotal('appointmentsSet')}
                                    goal={goals.weeklyAppointments}
                                    onChange={(val) => setDailyInputs({...dailyInputs, appointmentsSet: val})}
                                    icon="ðŸ“…"
                                    isWeekly={true}
                                    dailyValue={dailyInputs.appointmentsSet}
                                />
                                
                                <KPICard
                                    label="Offers Written (Weekly)"
                                    value={getWeeklyTotal('offersWritten')}
                                    goal={goals.weeklyOffers}
                                    onChange={(val) => setDailyInputs({...dailyInputs, offersWritten: val})}
                                    icon="ðŸ“"
                                    isWeekly={true}
                                    dailyValue={dailyInputs.offersWritten}
                                />
                                
                                <KPICard
                                    label="Buyer Contracts (Weekly)"
                                    value={getWeeklyTotal('buyerContracts')}
                                    goal={goals.weeklyBuyerContracts}
                                    onChange={(val) => setDailyInputs({...dailyInputs, buyerContracts: val})}
                                    icon="ðŸ "
                                    isWeekly={true}
                                    dailyValue={dailyInputs.buyerContracts}
                                />
                                
                                <KPICard
                                    label="Listings Obtained (Weekly)"
                                    value={getWeeklyTotal('listingsObtained')}
                                    goal={goals.weeklyListings}
                                    onChange={(val) => setDailyInputs({...dailyInputs, listingsObtained: val})}
                                    icon="ðŸ“‹"
                                    isWeekly={true}
                                    dailyValue={dailyInputs.listingsObtained}
                                />
                            </div>
                            
                            <div style={{
                                display: 'flex',
                                gap: '10px',
                                justifyContent: 'center',
                                marginTop: '30px'
                            }}>
                                <button 
                                    className="btn"
                                    onClick={() => {
                                        const dataToSave = {
                                            date: selectedDate,
                                            ...dailyInputs
                                        };
                                        saveDailyData(dataToSave);
                                        alert('Daily data saved successfully!');
                                    }}
                                    style={{
                                        background: '#28a745',
                                        fontSize: '16px',
                                        padding: '12px 24px'
                                    }}
                                >
                                    ðŸ’¾ Save Today's Progress
                                </button>
                                
                                <input
                                    type="date"
                                    value={selectedDate}
                                    onChange={(e) => setSelectedDate(e.target.value)}
                                    style={{
                                        padding: '12px',
                                        borderRadius: '8px',
                                        border: '2px solid #ddd',
                                        fontSize: '14px'
                                    }}
                                />
                            </div>
                            
                            <div style={{
                                marginTop: '30px',
                                padding: '20px',
                                background: '#f8f9fa',
                                borderRadius: '12px',
                                textAlign: 'center'
                            }}>
                                <h3>ðŸ“Š Quick Stats</h3>
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))',
                                    gap: '15px',
                                    marginTop: '15px'
                                }}>
                                    <div>
                                        <strong>Call Efficiency</strong><br/>
                                        <span style={{fontSize: '18px', color: '#007bff'}}>
                                            {dailyInputs.callsMade > 0 ? Math.round((dailyInputs.callsAnswered / dailyInputs.callsMade) * 100) : 0}%
                                        </span>
                                        <div style={{fontSize: '11px', color: '#666'}}>Calls answered vs made</div>
                                    </div>
                                    <div>
                                        <strong>Listing Pipeline</strong><br/>
                                        <span style={{fontSize: '18px', color: '#28a745'}}>
                                            {(() => {
                                                const listingAppointments = transactions.filter(t => t.type === 'Listing' && t.status !== 'Inactive').length;
                                                const listingsTaken = transactions.filter(t => t.type === 'Listing' && ['Active', 'Under Contract', 'Closed'].includes(t.status)).length;
                                                const listingsSold = transactions.filter(t => t.type === 'Listing' && t.status === 'Closed').length;
                                                
                                                const apptToTaken = listingAppointments > 0 ? Math.round((listingsTaken / listingAppointments) * 100) : 0;
                                                const takenToSold = listingsTaken > 0 ? Math.round((listingsSold / listingsTaken) * 100) : 0;
                                                
                                                return `${apptToTaken}%â†’${takenToSold}%`;
                                            })()}
                                        </span>
                                        <div style={{fontSize: '11px', color: '#666'}}>Apptâ†’Takenâ†’Sold</div>
                                    </div>
                                    <div>
                                        <strong>Buyer Pipeline</strong><br/>
                                        <span style={{fontSize: '18px', color: '#17a2b8'}}>
                                            {(() => {
                                                const buyerAppointments = transactions.filter(t => t.type === 'Buyer' && t.status !== 'Inactive').length;
                                                const buyersSigned = transactions.filter(t => t.type === 'Buyer' && ['Under Contract', 'Closed'].includes(t.status)).length;
                                                const buyersSold = transactions.filter(t => t.type === 'Buyer' && t.status === 'Closed').length;
                                                
                                                const apptToSigned = buyerAppointments > 0 ? Math.round((buyersSigned / buyerAppointments) * 100) : 0;
                                                const signedToSold = buyersSigned > 0 ? Math.round((buyersSold / buyersSigned) * 100) : 0;
                                                
                                                return `${apptToSigned}%â†’${signedToSold}%`;
                                            })()}
                                        </span>
                                        <div style={{fontSize: '11px', color: '#666'}}>Apptâ†’Signedâ†’Sold</div>
                                    </div>
                                    <div>
                                        <strong>Overall Score</strong><br/>
                                        <span style={{fontSize: '18px', color: '#ffc107'}}>
                                            {Math.round(
                                                ((goals.hoursWorked > 0 ? dailyInputs.hoursWorked / goals.hoursWorked : 0) * 25) +
                                                ((goals.dailyCalls > 0 ? dailyInputs.callsMade / goals.dailyCalls : 0) * 25) +
                                                ((goals.weeklyAppointments > 0 ? dailyInputs.appointmentsSet / (goals.weeklyAppointments / 5) : 0) * 20) +
                                                ((goals.weeklyOffers > 0 ? dailyInputs.offersWritten / (goals.weeklyOffers / 5) : 0) * 15) +
                                                ((goals.weeklyBuyerContracts > 0 ? dailyInputs.buyerContracts / (goals.weeklyBuyerContracts / 5) : 0) * 10) +
                                                ((goals.weeklyListings > 0 ? dailyInputs.listingsObtained / (goals.weeklyListings / 5) : 0) * 5)
                                            )}%
                                        </span>
                                        <div style={{fontSize: '11px', color: '#666'}}>Weighted performance score</div>
                                    </div>
                                </div>
                            </div>
                            
                            {/* Data Summary for Selected Date */}
                            {dailyData[selectedDate] && (
                                <div style={{marginTop: '20px', padding: '15px', background: '#e8f5e8', borderRadius: '8px'}}>
                                    <h4>ðŸ“‹ Summary for {selectedDate}:</h4>
                                    <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '10px', marginTop: '10px'}}>
                                        <div><strong>Hours:</strong> {dailyData[selectedDate].hoursWorked}</div>
                                        <div><strong>Calls Made:</strong> {dailyData[selectedDate].callsMade}</div>
                                        <div><strong>Calls Answered:</strong> {dailyData[selectedDate].callsAnswered}</div>
                                        <div><strong>Appointments:</strong> {dailyData[selectedDate].appointmentsSet}</div>
                                        <div><strong>Offers:</strong> {dailyData[selectedDate].offersWritten}</div>
                                        <div><strong>Buyer Contracts:</strong> {dailyData[selectedDate].buyerContracts}</div>
                                        <div><strong>Listings:</strong> {dailyData[selectedDate].listingsObtained}</div>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                    
                    {/* Properties Tab */}
                    {activeTab === 'properties' && (
                        <div className="tab-content">
                            <h2>ðŸ  Property Management</h2>
                            
                            <div className="form-section">
                                <h3>Add New Property</h3>
                                <form onSubmit={(e) => {
                                    e.preventDefault();
                                    const formData = new FormData(e.target);
                                    const propertyData = {
                                        address: formData.get('address'),
                                        client: formData.get('client'),
                                        type: formData.get('type'),
                                        price: parseFloat(formData.get('price')),
                                        status: formData.get('status') || 'Active',
                                        statusNote: formData.get('statusNote') || ''
                                    };
                                    addProperty(propertyData);
                                    e.target.reset();
                                    alert('Property added successfully!');
                                }}>
                                    <div className="form-group">
                                        <label>Property Address</label>
                                        <input type="text" name="address" placeholder="Enter property address" required />
                                    </div>
                                    <div className="form-group">
                                        <label>Client Name</label>
                                        <input type="text" name="client" placeholder="Enter client name" required />
                                    </div>
                                    <div className="form-group">
                                        <label>Client Type</label>
                                        <select name="type" required>
                                            <option value="">Select type</option>
                                            <option value="Seller">Seller</option>
                                            <option value="Buyer">Buyer</option>
                                            <option value="Rental">Rental</option>
                                        </select>
                                    </div>
                                    <div className="form-group" style={{position: 'relative'}}>
                                        <label>Price</label>
                                        <span style={{
                                            position: 'absolute',
                                            left: '8px',
                                            top: '70%',
                                            transform: 'translateY(-50%)',
                                            color: '#666',
                                            pointerEvents: 'none',
                                            fontSize: '16px'
                                        }}>$</span>
                                        <input 
                                            type="number" 
                                            name="price" 
                                            placeholder="Enter price (USD)" 
                                            style={{paddingLeft: '25px'}}
                                            required 
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>Status</label>
                                        <select name="status">
                                            <option value="Active">Active</option>
                                            <option value="Inactive">Inactive</option>
                                            <option value="Pending">Pending</option>
                                            <option value="Under Contract">Under Contract</option>
                                            <option value="In Progress">In Progress</option>
                                            <option value="Withdrawn">Withdrawn</option>
                                            <option value="Expired">Expired</option>
                                            <option value="Terminated">Terminated</option>
                                            <option value="Closed">Closed</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Status Note</label>
                                        <input type="text" name="statusNote" placeholder="Enter status note (optional)" />
                                    </div>
                                    <button type="submit" className="btn">Add Property</button>
                                </form>
                            </div>
                        </div>
                    )}
                    
                    {/* Transactions Tab */}
                    {activeTab === 'transactions' && (
                        <div className="tab-content">
                            <h2>ï¿½ Recent Transactions</h2>
                            
                            {/* Transaction History Section */}
                            
                            {/* Property Stats Dashboard */}
                            <div className="grid" style={{marginBottom: '30px'}}>
                                <div className="tile">
                                    <h4>Total Properties</h4>
                                    <p style={{fontSize: '28px', margin: '10px 0'}}>{properties.length}</p>
                                    <small>Properties in portfolio</small>
                                </div>
                                <div className="tile">
                                    <h4>Active Listings</h4>
                                    <p style={{fontSize: '28px', margin: '10px 0', color: '#28a745'}}>{properties.filter(p => p.status === 'Active').length}</p>
                                    <small>Currently active</small>
                                </div>
                                <div className="tile">
                                    <h4>Under Contract</h4>
                                    <p style={{fontSize: '28px', margin: '10px 0', color: '#ffc107'}}>{properties.filter(p => p.status === 'Under Contract' || p.status === 'Pending').length}</p>
                                    <small>In process</small>
                                </div>
                                <div className="tile">
                                    <h4>Closed</h4>
                                    <p style={{fontSize: '28px', margin: '10px 0', color: '#007bff'}}>{properties.filter(p => p.status === 'Closed').length}</p>
                                    <small>Successfully closed</small>
                                </div>
                                <div className="tile">
                                    <h4>Average Price</h4>
                                    <p style={{fontSize: '24px', margin: '10px 0', color: '#17a2b8'}}>
                                        ${properties.length > 0 ? Math.round(properties.reduce((sum, p) => sum + (p.price || 0), 0) / properties.length).toLocaleString() : '0'}
                                    </p>
                                    <small>Average property value</small>
                                </div>
                                <div className="tile">
                                    <h4>Total Value</h4>
                                    <p style={{fontSize: '24px', margin: '10px 0', color: '#6f42c1'}}>
                                        ${properties.reduce((sum, p) => sum + (p.price || 0), 0).toLocaleString()}
                                    </p>
                                    <small>Total portfolio value</small>
                                </div>
                                <div className="tile">
                                    <h4>Commissions Earned</h4>
                                    <p style={{fontSize: '24px', margin: '10px 0', color: '#28a745'}}>
                                        ${transactions.reduce((sum, t) => sum + (t.commission || 0), 0).toLocaleString()}
                                    </p>
                                    <small>Total earned commissions</small>
                                </div>
                            </div>
                            
                            {/* Property Search and Filter */}
                            <div style={{
                                background: 'rgba(248,249,250,0.95)',
                                backdropFilter: 'blur(10px)',
                                padding: '20px',
                                    borderRadius: '12px',
                                    marginTop: '30px',
                                    marginBottom: '20px',
                                    border: '1px solid rgba(255,255,255,0.2)',
                                    boxShadow: '0 4px 20px rgba(0,0,0,0.1)'
                                }}>
                                    <h3 style={{
                                        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                                        WebkitBackgroundClip: 'text',
                                        WebkitTextFillColor: 'transparent',
                                        backgroundClip: 'text',
                                        marginBottom: '15px'
                                    }}>ðŸ” Search & Filter Properties</h3>
                                    <div style={{
                                        display: 'grid',
                                        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                                        gap: '15px'
                                    }}>
                                        <div>
                                            <label style={{display: 'block', fontWeight: 'bold', marginBottom: '5px'}}>
                                                Search Address/Client:
                                            </label>
                                            <input
                                                type="text"
                                                placeholder="Search properties..."
                                                style={{
                                                    width: '100%',
                                                    padding: '8px',
                                                    borderRadius: '6px',
                                                    border: '2px solid #ddd'
                                                }}
                                                onChange={(e) => setPropertySearchTerm(e.target.value)}
                                            />
                                        </div>
                                        <div>
                                            <label style={{display: 'block', fontWeight: 'bold', marginBottom: '5px'}}>
                                                Filter by Status:
                                            </label>
                                            <select
                                                style={{
                                                    width: '100%',
                                                    padding: '8px',
                                                    borderRadius: '6px',
                                                    border: '2px solid #ddd'
                                                }}
                                                onChange={(e) => setPropertyStatusFilter(e.target.value)}
                                            >
                                                <option value="">All Statuses</option>
                                                <option value="Active">Active</option>
                                                <option value="Under Contract">Under Contract</option>
                                                <option value="Pending">Pending</option>
                                                <option value="Closed">Closed</option>
                                                <option value="Inactive">Inactive</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style={{display: 'block', fontWeight: 'bold', marginBottom: '5px'}}>
                                                Filter by Type:
                                            </label>
                                            <select
                                                style={{
                                                    width: '100%',
                                                    padding: '8px',
                                                    borderRadius: '6px',
                                                    border: '2px solid #ddd'
                                                }}
                                                onChange={(e) => setPropertyTypeFilter(e.target.value)}
                                            >
                                                <option value="">All Types</option>
                                                <option value="Seller">Seller</option>
                                                <option value="Buyer">Buyer</option>
                                                <option value="Rental">Rental</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                {/* Properties List */}
                                <div style={{marginBottom: '20px'}}>
                                    <h3 style={{
                                        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                                        WebkitBackgroundClip: 'text',
                                        WebkitTextFillColor: 'transparent',
                                        backgroundClip: 'text'
                                    }}>ðŸ“‹ Property List ({properties.filter(p => {
                                        const searchMatch = !propertySearchTerm || 
                                            p.address?.toLowerCase().includes(propertySearchTerm.toLowerCase()) ||
                                            p.client?.toLowerCase().includes(propertySearchTerm.toLowerCase());
                                        const statusMatch = !propertyStatusFilter || p.status === propertyStatusFilter;
                                        const typeMatch = !propertyTypeFilter || p.type === propertyTypeFilter;
                                        return searchMatch && statusMatch && typeMatch;
                                    }).length})</h3>
                                    
                                    {properties.filter(p => {
                                        const searchMatch = !propertySearchTerm || 
                                            p.address?.toLowerCase().includes(propertySearchTerm.toLowerCase()) ||
                                            p.client?.toLowerCase().includes(propertySearchTerm.toLowerCase());
                                        const statusMatch = !propertyStatusFilter || p.status === propertyStatusFilter;
                                        const typeMatch = !propertyTypeFilter || p.type === propertyTypeFilter;
                                        return searchMatch && statusMatch && typeMatch;
                                    }).length === 0 ? (
                                        <div style={{
                                            textAlign: 'center',
                                            padding: '40px',
                                            background: 'rgba(248,249,250,0.95)',
                                            backdropFilter: 'blur(10px)',
                                            borderRadius: '12px',
                                            color: '#6c757d',
                                            border: '1px solid rgba(255,255,255,0.2)',
                                            boxShadow: '0 4px 20px rgba(0,0,0,0.1)'
                                        }}>
                                            <h4>No properties found</h4>
                                            <p>Try adjusting your search criteria or add a new property in the Properties tab.</p>
                                        </div>
                                    ) : (
                                        <div style={{
                                            display: 'grid',
                                            gap: '15px'
                                        }}>
                                            {properties.filter(p => {
                                                const searchMatch = !propertySearchTerm || 
                                                    p.address?.toLowerCase().includes(propertySearchTerm.toLowerCase()) ||
                                                    p.client?.toLowerCase().includes(propertySearchTerm.toLowerCase());
                                                const statusMatch = !propertyStatusFilter || p.status === propertyStatusFilter;
                                                const typeMatch = !propertyTypeFilter || p.type === propertyTypeFilter;
                                                return searchMatch && statusMatch && typeMatch;
                                            }).map(property => (
                                                <div key={property.id} style={{
                                                    background: 'rgba(255,255,255,0.95)',
                                                    backdropFilter: 'blur(10px)',
                                                    padding: '20px',
                                                    borderRadius: '12px',
                                                    border: '1px solid rgba(255,255,255,0.2)',
                                                    boxShadow: '0 4px 20px rgba(0,0,0,0.1)'
                                                }}>
                                                    <div style={{
                                                        display: 'grid',
                                                        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                                                        gap: '15px',
                                                        alignItems: 'center'
                                                    }}>
                                                        <div>
                                                            <strong style={{fontSize: '16px'}}>{property.address}</strong>
                                                            <br />
                                                            <span style={{color: '#6c757d'}}>Client: {property.client}</span>
                                                        </div>
                                                        <div>
                                                            <span style={{
                                                                background: property.status === 'Active' ? '#d4edda' : 
                                                                          property.status === 'Closed' ? '#d1ecf1' :
                                                                          property.status === 'Under Contract' ? '#fff3cd' : '#f8d7da',
                                                                color: property.status === 'Active' ? '#155724' : 
                                                                       property.status === 'Closed' ? '#0c5460' :
                                                                       property.status === 'Under Contract' ? '#856404' : '#721c24',
                                                                padding: '4px 12px',
                                                                borderRadius: '20px',
                                                                fontSize: '12px',
                                                                fontWeight: 'bold'
                                                            }}>
                                                                {property.status}
                                                            </span>
                                                        </div>
                                                        <div>
                                                            <strong>${property.price?.toLocaleString()}</strong>
                                                            <br />
                                                            <span style={{color: '#6c757d'}}>{property.type}</span>
                                                        </div>
                                                        <div>
                                                            <button
                                                                style={{
                                                                    background: '#dc3545',
                                                                    color: 'white',
                                                                    border: 'none',
                                                                    padding: '6px 12px',
                                                                    borderRadius: '6px',
                                                                    cursor: 'pointer',
                                                                    fontSize: '12px'
                                                                }}
                                                                onClick={() => {
                                                                    if (confirm('Are you sure you want to remove this property?')) {
                                                                        deleteProperty(property.id);
                                                                    }
                                                                }}
                                                            >
                                                                Remove
                                                            </button>
                                                        </div>
                                                    </div>
                                                    {property.statusNote && (
                                                        <div style={{
                                                            marginTop: '10px',
                                                            padding: '10px',
                                                            background: 'rgba(248,249,250,0.8)',
                                                            backdropFilter: 'blur(5px)',
                                                            borderRadius: '6px',
                                                            fontSize: '14px',
                                                            color: '#6c757d'
                                                        }}>
                                                            <strong>Note:</strong> {property.statusNote}
                                                        </div>
                                                    )}
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                                
                                {/* Expense Modal */}
                                {showExpenseModal && (
                                    <div className="expense-modal" onClick={() => {
                                        setShowExpenseModal(false);
                                        setEditingExpense(null);
                                        setIsEditMode(false);
                                    }}>
                                        <div className="expense-modal-content" onClick={(e) => e.stopPropagation()}>
                                            <div style={{
                                                display: 'flex',
                                                justifyContent: 'space-between',
                                                alignItems: 'center',
                                                marginBottom: '20px',
                                                borderBottom: '1px solid #ddd',
                                                paddingBottom: '10px'
                                            }}>
                                                <h3 style={{margin: 0}}>Expense Details</h3>
                                                <button 
                                                    onClick={() => {
                                                        setShowExpenseModal(false);
                                                        setEditingExpense(null);
                                                        setIsEditMode(false);
                                                    }}
                                                    style={{
                                                        background: '#dc3545',
                                                        color: 'white',
                                                        border: 'none',
                                                        borderRadius: '4px',
                                                        padding: '5px 10px',
                                                        cursor: 'pointer'
                                                    }}
                                                >
                                                    Ã—
                                                </button>
                                            </div>
                                            <div>
                                                {selectedTransactionExpenses.map(expense => (
                                                    <div key={expense.id} style={{
                                                        padding: '10px',
                                                        marginBottom: '10px',
                                                        border: '1px solid #ddd',
                                                        borderRadius: '4px',
                                                        backgroundColor: '#f8f9fa'
                                                    }}>
                                                        {editingExpense?.id === expense.id ? (
                                                            // Edit Form
                                                            <div className="expense-edit-form">
                                                                <div className="edit-form-row">
                                                                    <div className="edit-form-field">
                                                                        <label>Category:</label>
                                                                        <select
                                                                            value={editingExpense.category}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, category: e.target.value})}
                                                                        >
                                                                            <option value="Travel">Travel</option>
                                                                            <option value="Staging">Staging</option>
                                                                            <option value="Meals">Meals</option>
                                                                            <option value="Professional Photography/Drone">Professional Photography/Drone</option>
                                                                            <option value="Junk Removal">Junk Removal</option>
                                                                            <option value="Repairs">Repairs</option>
                                                                            <option value="Marketing">Marketing</option>
                                                                            <option value="Office">Office</option>
                                                                            <option value="Professional Development">Professional Development</option>
                                                                            <option value="Other">Other</option>
                                                                        </select>
                                                                    </div>
                                                                    <div className="edit-form-field">
                                                                        <label>Amount ($):</label>
                                                                        <input
                                                                            type="number"
                                                                            value={editingExpense.amount}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, amount: parseFloat(e.target.value) || 0})}
                                                                            step="0.01"
                                                                        />
                                                                    </div>
                                                                    <div className="edit-form-field">
                                                                        <label>Hours Worked:</label>
                                                                        <input
                                                                            type="number"
                                                                            value={editingExpense.hoursWorked || 0}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, hoursWorked: parseFloat(e.target.value) || 0})}
                                                                            step="0.25"
                                                                            placeholder="0"
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <div className="edit-form-row">
                                                                    <div className="edit-form-field">
                                                                        <label>Description:</label>
                                                                        <textarea
                                                                            value={editingExpense.description}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, description: e.target.value})}
                                                                            rows="2"
                                                                            placeholder="Expense description"
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <div className="edit-form-row">
                                                                    <div className="edit-form-field">
                                                                        <label>Vendor:</label>
                                                                        <input
                                                                            type="text"
                                                                            value={editingExpense.vendor || ''}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, vendor: e.target.value})}
                                                                            placeholder="Vendor name"
                                                                        />
                                                                    </div>
                                                                    <div className="edit-form-field">
                                                                        <label>Date:</label>
                                                                        <input
                                                                            type="date"
                                                                            value={editingExpense.date}
                                                                            onChange={(e) => setEditingExpense({...editingExpense, date: e.target.value})}
                                                                        />
                                                                    </div>
                                                                </div>
                                                                <div className="edit-buttons">
                                                                    <button
                                                                        className="edit-btn cancel"
                                                                        onClick={() => {
                                                                            setEditingExpense(null);
                                                                            setIsEditMode(false);
                                                                        }}
                                                                    >
                                                                        Cancel
                                                                    </button>
                                                                    <button
                                                                        className="edit-btn save"
                                                                        onClick={() => {
                                                                            updateExpense(editingExpense.id, editingExpense);
                                                                            setEditingExpense(null);
                                                                            setIsEditMode(false);
                                                                        }}
                                                                    >
                                                                        Save Changes
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        ) : (
                                                            // View Mode
                                                            <>
                                                                <div className="expense-item-header">
                                                                    <div style={{display: 'flex', justifyContent: 'space-between', width: '100%'}}>
                                                                        <strong>{expense.category}</strong>
                                                                        <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}>
                                                                            <strong style={{color: '#007bff'}}>${expense.amount.toLocaleString()}</strong>
                                                                            <button
                                                                                className="edit-expense-btn"
                                                                                onClick={() => {
                                                                                    setEditingExpense({...expense});
                                                                                    setIsEditMode(true);
                                                                                }}
                                                                            >
                                                                                Edit
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div style={{color: '#666', fontSize: '14px', marginBottom: '3px'}}>
                                                                    {expense.description}
                                                                </div>
                                                                {expense.vendor && (
                                                                    <div style={{color: '#666', fontSize: '12px', marginBottom: '3px'}}>
                                                                        Vendor: {expense.vendor}
                                                                    </div>
                                                                )}
                                                                {expense.hoursWorked && expense.hoursWorked > 0 && (
                                                                    <div style={{color: '#666', fontSize: '12px', marginBottom: '3px'}}>
                                                                        Hours Worked: {expense.hoursWorked} hrs
                                                                        {hourlyWage > 0 && (
                                                                            <span style={{color: '#28a745', marginLeft: '10px'}}>
                                                                                (Labor Value: ${(expense.hoursWorked * hourlyWage).toFixed(2)})
                                                                            </span>
                                                                        )}
                                                                    </div>
                                                                )}
                                                                <div style={{color: '#666', fontSize: '12px'}}>
                                                                    Date: {expense.date}
                                                                </div>
                                                            </>
                                                        )}
                                                    </div>
                                                ))}
                                                <div style={{
                                                    marginTop: '15px',
                                                    padding: '10px',
                                                    backgroundColor: '#e8f5e8',
                                                    borderRadius: '4px',
                                                    textAlign: 'center'
                                                }}>
                                                    <strong>Direct Expenses: ${selectedTransactionExpenses.reduce((sum, exp) => sum + exp.amount, 0).toLocaleString()}</strong>
                                                    {selectedTransactionExpenses.some(exp => exp.hoursWorked && exp.hoursWorked > 0) && (
                                                        <div style={{marginTop: '5px', fontSize: '14px'}}>
                                                            Total Hours: {selectedTransactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0)} hrs
                                                            {hourlyWage > 0 && (
                                                                <span style={{color: '#28a745', marginLeft: '10px'}}>
                                                                    (Labor Value: ${(selectedTransactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0) * hourlyWage).toFixed(2)})
                                                                </span>
                                                            )}
                                                        </div>
                                                    )}
                                                    <div style={{marginTop: '8px', fontSize: '16px', fontWeight: 'bold', color: '#155724'}}>
                                                        <strong>Total Expenses (including labor): ${(selectedTransactionExpenses.reduce((sum, exp) => sum + exp.amount, 0) + (selectedTransactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0) * hourlyWage)).toLocaleString()}</strong>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}
                    
                    {/* Expenses Tab */}
                    {activeTab === 'expenses' && (
                        <div className="tab-content">
                            <h2>Expense Tracking</h2>
                            
                            {/* Information note */}
                            <div style={{
                                background: '#e8f4f8',
                                border: '1px solid #bee5eb',
                                borderRadius: '8px',
                                padding: '15px',
                                marginBottom: '20px',
                                color: '#0c5460'
                            }} className="info-note">
                                <strong>ðŸ’¡ Tip:</strong> View individual property expenses in the <strong>Transactions</strong> tab by clicking the "View" button on each transaction card.
                            </div>
                            
                            <div className="grid">
                                <div className="tile">
                                    <h4>Total Expenses</h4>
                                    <p>${expenses.reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>All expenses combined</small>
                                </div>
                                
                                <div className="tile hourly-wage-tile">
                                    <h4>Hourly Wage</h4>
                                    <p>${hourlyWage}</p>
                                    <small>
                                        <input 
                                            type="number" 
                                            value={hourlyWage} 
                                            onChange={(e) => setHourlyWage(parseFloat(e.target.value) || 0)}
                                            style={{
                                                width: '80px', 
                                                padding: '2px 5px', 
                                                border: '1px solid #ccc', 
                                                borderRadius: '3px',
                                                fontSize: '11px',
                                                textAlign: 'center'
                                            }}
                                            placeholder="Rate"
                                        />
                                        <br/>Click to edit rate
                                    </small>
                                </div>
                                
                                <div className="tile labor-value-tile">
                                    <h4>Labor Value</h4>
                                    <p>
                                        {(() => {
                                            const totalExpenseHours = expenses.reduce((sum, expense) => sum + (expense.hoursWorked || 0), 0);
                                            return `$${(totalExpenseHours * hourlyWage).toLocaleString()}`;
                                        })()}
                                    </p>
                                    <small>
                                        Expense hours: {expenses.reduce((sum, expense) => sum + (expense.hoursWorked || 0), 0)}<br/>
                                        @ ${hourlyWage}/hour
                                    </small>
                                </div>
                                
                                <div className="tile roi-tile">
                                    <h4>Effective Hourly Wage</h4>
                                    <p>
                                        {(() => {
                                            const effectiveWage = calculateEffectiveHourlyWage();
                                            return effectiveWage > 0 ? `$${effectiveWage.toFixed(2)}` : '$0.00';
                                        })()}
                                    </p>
                                    <small>
                                        {(() => {
                                            const closedTransactions = transactions.filter(t => t.status === 'Closed');
                                            const totalCommission = closedTransactions.reduce((sum, t) => sum + t.commission, 0);
                                            const closedTransactionExpenses = expenses.filter(expense => {
                                                if (!expense.propertyId) return false;
                                                const property = properties.find(p => p.id === expense.propertyId);
                                                return property && property.status === 'Closed';
                                            });
                                            const totalHours = closedTransactionExpenses.reduce((sum, exp) => sum + (exp.hoursWorked || 0), 0);
                                            
                                            return totalHours > 0 
                                                ? `${totalHours}hrs / $${totalCommission.toLocaleString()}`
                                                : 'No hours logged on closed deals';
                                        })()}
                                    </small>
                                </div>
                                
                                <div className="tile">
                                    <h4>This Week's Expenses</h4>
                                    <p>
                                        {(() => {
                                            const weekExpenses = getCurrentWeekExpenses();
                                            const total = weekExpenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                                            return `$${total.toLocaleString()}`;
                                        })()}
                                    </p>
                                    <small>
                                        {(() => {
                                            const weekExpenses = getCurrentWeekExpenses();
                                            const totalHours = weekExpenses.reduce((sum, e) => sum + (e.hoursWorked || 0), 0);
                                            return `${weekExpenses.length} expense(s) | ${totalHours}hrs`;
                                        })()}
                                    </small>
                                </div>
                                
                                <div className="tile">
                                    <h4>This Month's Expenses</h4>
                                    <p>
                                        {(() => {
                                            const monthExpenses = getCurrentMonthExpenses();
                                            const total = monthExpenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                                            return `$${total.toLocaleString()}`;
                                        })()}
                                    </p>
                                    <small>
                                        {(() => {
                                            const monthExpenses = getCurrentMonthExpenses();
                                            const totalHours = monthExpenses.reduce((sum, e) => sum + (e.hoursWorked || 0), 0);
                                            return `${monthExpenses.length} expense(s) | ${totalHours}hrs`;
                                        })()}
                                    </small>
                                </div>
                                
                                <div className="tile">
                                    <h4>Travel</h4>
                                    <p>${expenses.filter(e => e.category === 'Travel').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Travel').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Staging</h4>
                                    <p>${expenses.filter(e => e.category === 'Staging').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Staging').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Meals</h4>
                                    <p>${expenses.filter(e => e.category === 'Meals').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Meals').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Photography/Drone</h4>
                                    <p>${expenses.filter(e => e.category === 'Professional Photography/Drone').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Professional Photography/Drone').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Junk Removal</h4>
                                    <p>${expenses.filter(e => e.category === 'Junk Removal').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Junk Removal').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Repairs</h4>
                                    <p>${expenses.filter(e => e.category === 'Repairs').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Repairs').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Marketing</h4>
                                    <p>${expenses.filter(e => e.category === 'Marketing').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Marketing').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Office</h4>
                                    <p>${expenses.filter(e => e.category === 'Office').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Office').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Professional Dev</h4>
                                    <p>${expenses.filter(e => e.category === 'Professional Development').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Professional Development').length} expense(s)</small>
                                </div>
                                <div className="tile">
                                    <h4>Other</h4>
                                    <p>${expenses.filter(e => e.category === 'Other').reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}</p>
                                    <small>{expenses.filter(e => e.category === 'Other').length} expense(s)</small>
                                </div>
                                <div className="tile roi-tile">
                                    <h4>ROI Calculation</h4>
                                    <p>
                                        {(() => {
                                            const totalRevenue = totalCommission;
                                            const totalExpenses = expenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const laborCost = totalHours * hourlyWage;
                                            const totalCosts = totalExpenses + laborCost;
                                            const roi = totalCosts > 0 ? ((totalRevenue - totalCosts) / totalCosts) * 100 : 0;
                                            return `${roi.toFixed(1)}%`;
                                        })()}
                                    </p>
                                    <small>
                                        Revenue: ${totalCommission.toLocaleString()}<br/>
                                        Expenses: ${expenses.reduce((sum, e) => sum + (e.amount || 0), 0).toLocaleString()}<br/>
                                        Labor Cost: ${(() => {
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            return (totalHours * hourlyWage).toLocaleString();
                                        })()}<br/>
                                        Net Profit: ${(() => {
                                            const totalExpenses = expenses.reduce((sum, e) => sum + (e.amount || 0), 0);
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const laborCost = totalHours * hourlyWage;
                                            return (totalCommission - totalExpenses - laborCost).toLocaleString();
                                        })()}
                                    </small>
                                </div>
                            </div>
                            
                            <div className="form-section">
                                <h3>Add New Expense</h3>
                                <form onSubmit={(e) => {
                                    e.preventDefault();
                                    const formData = new FormData(e.target);
                                    const expenseData = {
                                        date: formData.get('date'),
                                        propertyId: selectedPropertyForExpense?.id || null,
                                        propertyAddress: selectedPropertyForExpense?.address || 'General',
                                        category: formData.get('category'),
                                        amount: parseFloat(formData.get('amount')),
                                        hoursWorked: parseFloat(formData.get('hoursWorked')) || 0,
                                        description: formData.get('description'),
                                        vendor: formData.get('vendor') || ''
                                    };
                                    addExpense(expenseData);
                                    e.target.reset();
                                    setSelectedPropertyForExpense(null);
                                    alert('Expense added successfully!');
                                }}>
                                    <div className="form-group">
                                        <label>Date</label>
                                        <input type="date" name="date" defaultValue={new Date().toISOString().split('T')[0]} required />
                                    </div>
                                    <div className="form-group">
                                        <label>Property (Optional)</label>
                                        <div className="property-house-tiles">
                                            <div 
                                                className={`property-house-tile ${!selectedPropertyForExpense ? 'selected' : ''}`}
                                                onClick={() => setSelectedPropertyForExpense(null)}
                                            >
                                                <div className="property-type">General</div>
                                                <div className="house-icon">ðŸ¢</div>
                                                <div className="address">General</div>
                                                <div className="client">No specific property</div>
                                            </div>
                                            {properties.map(property => (
                                                <div 
                                                    key={property.id}
                                                    className={`property-house-tile ${selectedPropertyForExpense?.id === property.id ? 'selected' : ''}`}
                                                    onClick={() => setSelectedPropertyForExpense(property)}
                                                >
                                                    <div className="property-type">Listing</div>
                                                    <div className="house-icon">ðŸ¡</div>
                                                    <div className="address">{property.address}</div>
                                                    <div className="client">{property.client}</div>
                                                </div>
                                            ))}
                                        </div>
                                        {selectedPropertyForExpense && (
                                            <small style={{color: '#007bff', marginTop: '5px', display: 'block'}}>
                                                Selected: {selectedPropertyForExpense.address}
                                            </small>
                                        )}
                                    </div>
                                    <div className="form-group">
                                        <label>Category</label>
                                        <select name="category" required onChange={(e) => toggleMileageCalculator(e.target.value)}>
                                            <option value="">Select category</option>
                                            <option value="Travel">Travel</option>
                                            <option value="Staging">Staging</option>
                                            <option value="Meals">Meals</option>
                                            <option value="Professional Photography/Drone">Professional Photography/Drone</option>
                                            <option value="Junk Removal">Junk Removal</option>
                                            <option value="Repairs">Repairs</option>
                                            <option value="Marketing">Marketing</option>
                                            <option value="Office">Office</option>
                                            <option value="Professional Development">Professional Development</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Amount</label>
                                        <input type="number" name="amount" placeholder="Enter amount" step="0.01" required />
                                    </div>
                                    <div className="form-group">
                                        <label>Hours Worked (Optional)</label>
                                        <input 
                                            type="number" 
                                            name="hoursWorked" 
                                            placeholder="Enter hours worked" 
                                            step="0.25" 
                                            min="0"
                                            style={{width: '100%'}}
                                        />
                                        <small style={{color: '#666', fontSize: '12px', display: 'block', marginTop: '5px'}}>
                                            Track hours for labor value calculation (${hourlyWage}/hour)
                                        </small>
                                    </div>
                                    
                                    {/* Mileage Calculator - Only show for Travel category */}
                                    <div id="mileageCalculator" style={{display: 'none', border: '1px solid #ddd', borderRadius: '8px', padding: '15px', marginBottom: '15px', backgroundColor: '#f8f9fa'}}>
                                        <h4 style={{margin: '0 0 15px 0', color: '#495057'}}>Mileage Calculator</h4>
                                        <div className="form-group">
                                            <label>Mileage (miles)</label>
                                            <input 
                                                type="number" 
                                                id="mileageInput" 
                                                placeholder="Enter mileage" 
                                                step="0.1"
                                                onChange={() => calculateMileageCost()}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>Gas Price (per gallon)</label>
                                            <input 
                                                type="number" 
                                                id="gasPriceInput" 
                                                placeholder="Enter current gas price" 
                                                step="0.01"
                                                onChange={() => calculateMileageCost()}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>Miles Per Gallon (MPG)</label>
                                            <input 
                                                type="number" 
                                                id="mpgInput" 
                                                placeholder="20" 
                                                defaultValue="20"
                                                step="0.1"
                                                onChange={() => calculateMileageCost()}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>Calculated Mileage Cost</label>
                                            <input 
                                                type="text" 
                                                id="calculatedCost" 
                                                placeholder="Auto-calculated" 
                                                disabled 
                                                style={{backgroundColor: '#e9ecef'}}
                                            />
                                        </div>
                                        <button 
                                            type="button" 
                                            className="btn" 
                                            style={{backgroundColor: '#17a2b8', marginTop: '10px'}}
                                            onClick={() => {
                                                const calculatedAmount = document.getElementById('calculatedCost').value;
                                                if (calculatedAmount && calculatedAmount !== 'Auto-calculated') {
                                                    document.querySelector('input[name="amount"]').value = calculatedAmount.replace('$', '');
                                                    alert('Calculated mileage cost applied to amount field!');
                                                }
                                            }}
                                        >
                                            Use Calculated Amount
                                        </button>
                                    </div>
                                    <div className="form-group">
                                        <label>Vendor/Company</label>
                                        <input type="text" name="vendor" placeholder="Enter vendor or company name" />
                                    </div>
                                    <div className="form-group">
                                        <label>Description</label>
                                        <input type="text" name="description" placeholder="Enter description" />
                                    </div>
                                    <button type="submit" className="btn">Add Expense</button>
                                </form>
                            </div>
                        </div>
                    )}
                    
                    {/* Reports Tab */}
                    {activeTab === 'reports' && (
                        <div className="tab-content">
                            <h2>Reports & Analytics</h2>
                            
                            <div className="grid">
                                <div className="tile" onClick={() => {
                                    setCurrentReport(generateExpenseReport());
                                    setShowReportModal(true);
                                }} style={{cursor: 'pointer'}}>
                                    <h4>ðŸ“Š Expense Report</h4>
                                    <p>Detailed Analysis</p>
                                    <small>Complete expense breakdown by category</small>
                                </div>
                                
                                <div className="tile" onClick={() => {
                                    setCurrentReport(generateWeeklyReport());
                                    setShowReportModal(true);
                                }} style={{cursor: 'pointer'}}>
                                    <h4>ðŸ“… Weekly Report</h4>
                                    <p>7-Day Summary</p>
                                    <small>Activities, goals, and performance</small>
                                </div>
                                
                                <div className="tile" onClick={() => {
                                    setCurrentReport(generateDailyReport());
                                    setShowReportModal(true);
                                }} style={{cursor: 'pointer'}}>
                                    <h4>ðŸ“‹ Daily Report</h4>
                                    <p>Today's Activities</p>
                                    <small>Daily performance and tasks</small>
                                </div>
                            </div>
                            
                            <div style={{marginTop: '30px', padding: '20px', background: '#f8f9fa', borderRadius: '8px'}}>
                                <h3>Report Features</h3>
                                <ul style={{marginBottom: 0}}>
                                    <li><strong>Print Ready:</strong> All reports are formatted for printing</li>
                                    <li><strong>Export Options:</strong> Save as PDF using browser print function</li>
                                    <li><strong>Real-time Data:</strong> Reports reflect current data state</li>
                                    <li><strong>Comprehensive:</strong> Includes expenses, goals, and performance metrics</li>
                                </ul>
                            </div>
                        </div>
                    )}
                    
                    {/* GCI Calculator Tab */}
                    {activeTab === 'gci' && (
                        <div className="tab-content">
                            <h2>GCI Calculator & Deal Planning</h2>
                            <div className="grid">
                                <div className="tile">
                                    <h4>Desired Annual GCI</h4>
                                    <p>${gciCalculator.desiredGCI.toLocaleString()}</p>
                                    <small>Target for this year</small>
                                </div>
                                <div className="tile">
                                    <h4>Current GCI</h4>
                                    <p>${totalCommission.toLocaleString()}</p>
                                    <small>Year-to-date commission</small>
                                </div>
                                <div className="tile">
                                    <h4>Remaining Goal</h4>
                                    <p>${Math.max(0, gciCalculator.desiredGCI - totalCommission).toLocaleString()}</p>
                                    <small>Still needed</small>
                                </div>
                                <div className="tile">
                                    <h4>Progress</h4>
                                    <p>{Math.round((totalCommission / gciCalculator.desiredGCI) * 100)}%</p>
                                    <small>Toward annual goal</small>
                                </div>
                            </div>
                            
                            <div className="form-section">
                                <h3>Deal Calculator</h3>
                                <form onSubmit={(e) => {
                                    e.preventDefault();
                                    const formData = new FormData(e.target);
                                    const avgPrice = parseFloat(formData.get('averageSalePrice')) || gciCalculator.averageSalePrice;
                                    const commissionRate = parseFloat(formData.get('commissionRate')) || gciCalculator.commissionRate;
                                    const avgCommissionPerDeal = parseFloat(formData.get('averageCommissionPerDeal')) || null;
                                    const desiredGCI = parseFloat(formData.get('desiredGCI')) || gciCalculator.desiredGCI;
                                    
                                    // Use manual commission per deal if provided, otherwise calculate from price and rate
                                    const finalCommissionPerDeal = avgCommissionPerDeal || (avgPrice * commissionRate) / 100;
                                    const dealsNeeded = calculateDealsNeeded(avgPrice, commissionRate, desiredGCI, avgCommissionPerDeal);
                                    
                                    setGciCalculator({
                                        averageSalePrice: avgPrice,
                                        commissionRate: commissionRate,
                                        averageCommissionPerDeal: finalCommissionPerDeal,
                                        desiredGCI: desiredGCI,
                                        dealsNeeded: dealsNeeded
                                    });
                                }}>
                                    <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px'}}>
                                        <div>
                                            <div className="form-group">
                                                <label>Average Sale Price</label>
                                                <input 
                                                    type="number" 
                                                    name="averageSalePrice"
                                                    value={gciCalculator.averageSalePrice}
                                                    placeholder="Enter average sale price" 
                                                    onChange={(e) => {
                                                        // Auto-calculate when price changes
                                                        const form = e.target.form;
                                                        const avgPrice = parseFloat(e.target.value) || 0;
                                                        const commissionRate = parseFloat(form.commissionRate.value) || gciCalculator.commissionRate;
                                                        const avgCommissionPerDeal = parseFloat(form.averageCommissionPerDeal.value) || null;
                                                        const desiredGCI = parseFloat(form.desiredGCI.value) || gciCalculator.desiredGCI;
                                                        
                                                        // Always update the average sale price
                                                        let newState = {
                                                            ...gciCalculator,
                                                            averageSalePrice: avgPrice
                                                        };
                                                        
                                                        // Calculate deals needed if not using manual commission per deal
                                                        if (!avgCommissionPerDeal && avgPrice && commissionRate && desiredGCI) {
                                                            const dealsNeeded = calculateDealsNeeded(avgPrice, commissionRate, desiredGCI, null);
                                                            newState.dealsNeeded = dealsNeeded;
                                                        }
                                                        
                                                        setGciCalculator(newState);
                                                    }}
                                                    required
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label>Commission Rate (%)</label>
                                                <input 
                                                    type="number" 
                                                    name="commissionRate"
                                                    defaultValue={gciCalculator.commissionRate}
                                                    placeholder="Enter commission rate" 
                                                    step="0.1"
                                                    onChange={(e) => {
                                                        // Auto-calculate when rate changes
                                                        const form = e.target.form;
                                                        const commissionRate = parseFloat(e.target.value) || 0;
                                                        const avgPrice = parseFloat(form.averageSalePrice.value) || gciCalculator.averageSalePrice;
                                                        const avgCommissionPerDeal = parseFloat(form.averageCommissionPerDeal.value) || null;
                                                        const desiredGCI = parseFloat(form.desiredGCI.value) || gciCalculator.desiredGCI;
                                                        
                                                        if (!avgCommissionPerDeal && avgPrice && commissionRate && desiredGCI) {
                                                            const dealsNeeded = calculateDealsNeeded(avgPrice, commissionRate, desiredGCI, null);
                                                            setGciCalculator(prev => ({
                                                                ...prev,
                                                                commissionRate: commissionRate,
                                                                dealsNeeded: dealsNeeded
                                                            }));
                                                        }
                                                    }}
                                                    required
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label>Average Commission Per Deal (Override)</label>
                                                <input 
                                                    type="number" 
                                                    name="averageCommissionPerDeal"
                                                    defaultValue={gciCalculator.averageCommissionPerDeal}
                                                    placeholder="Optional: Manual commission per deal" 
                                                    step="0.01"
                                                    onChange={(e) => {
                                                        // Auto-calculate when manual commission changes
                                                        const form = e.target.form;
                                                        const avgCommissionPerDeal = parseFloat(e.target.value) || null;
                                                        const desiredGCI = parseFloat(form.desiredGCI.value) || gciCalculator.desiredGCI;
                                                        
                                                        if (avgCommissionPerDeal && desiredGCI) {
                                                            const dealsNeeded = calculateDealsNeeded(0, 0, desiredGCI, avgCommissionPerDeal);
                                                            setGciCalculator(prev => ({
                                                                ...prev,
                                                                averageCommissionPerDeal: avgCommissionPerDeal,
                                                                dealsNeeded: dealsNeeded
                                                            }));
                                                        } else if (!avgCommissionPerDeal) {
                                                            // Recalculate using price and rate if manual override is cleared
                                                            const avgPrice = parseFloat(form.averageSalePrice.value) || gciCalculator.averageSalePrice;
                                                            const commissionRate = parseFloat(form.commissionRate.value) || gciCalculator.commissionRate;
                                                            if (avgPrice && commissionRate && desiredGCI) {
                                                                const dealsNeeded = calculateDealsNeeded(avgPrice, commissionRate, desiredGCI, null);
                                                                setGciCalculator(prev => ({
                                                                    ...prev,
                                                                    averageCommissionPerDeal: (avgPrice * commissionRate) / 100,
                                                                    dealsNeeded: dealsNeeded
                                                                }));
                                                            }
                                                        }
                                                    }}
                                                />
                                                <small style={{color: '#666'}}>Leave blank to auto-calculate from price Ã— rate</small>
                                            </div>
                                            <div className="form-group">
                                                <label>Desired Annual GCI</label>
                                                <input 
                                                    type="number" 
                                                    name="desiredGCI"
                                                    defaultValue={gciCalculator.desiredGCI}
                                                    placeholder="Enter desired GCI" 
                                                    onChange={(e) => {
                                                        // Auto-calculate when GCI goal changes
                                                        const form = e.target.form;
                                                        const desiredGCI = parseFloat(e.target.value) || 0;
                                                        const avgCommissionPerDeal = parseFloat(form.averageCommissionPerDeal.value) || null;
                                                        
                                                        if (desiredGCI) {
                                                            let dealsNeeded = 0;
                                                            if (avgCommissionPerDeal) {
                                                                dealsNeeded = calculateDealsNeeded(0, 0, desiredGCI, avgCommissionPerDeal);
                                                            } else {
                                                                const avgPrice = parseFloat(form.averageSalePrice.value) || gciCalculator.averageSalePrice;
                                                                const commissionRate = parseFloat(form.commissionRate.value) || gciCalculator.commissionRate;
                                                                dealsNeeded = calculateDealsNeeded(avgPrice, commissionRate, desiredGCI, null);
                                                            }
                                                            setGciCalculator(prev => ({
                                                                ...prev,
                                                                desiredGCI: desiredGCI,
                                                                dealsNeeded: dealsNeeded
                                                            }));
                                                        }
                                                    }}
                                                    required
                                                />
                                            </div>
                                            <button type="submit" className="btn">Calculate Deals Needed</button>
                                        </div>
                                        
                                        <div style={{padding: '20px', backgroundColor: '#f8f9fa', borderRadius: '8px'}} className={currentTheme === 'dark' ? 'dark-calculation-results' : ''}>
                                            <h4>Calculation Results</h4>
                                            <div style={{marginTop: '15px'}}>
                                                <div style={{marginBottom: '10px'}}>
                                                    <strong>Commission per Deal:</strong><br/>
                                                    <span style={{fontSize: '1.2em', color: '#007bff'}}>
                                                        ${(gciCalculator.averageCommissionPerDeal || ((gciCalculator.averageSalePrice * gciCalculator.commissionRate) / 100)).toLocaleString()}
                                                    </span>
                                                    <br/>
                                                    <small style={{color: '#666'}}>
                                                        {gciCalculator.averageCommissionPerDeal ? 'Manual override' : 'Calculated from price Ã— rate'}
                                                    </small>
                                                </div>
                                                <div style={{marginBottom: '10px'}}>
                                                    <strong>Deals Needed:</strong><br/>
                                                    <span style={{fontSize: '1.5em', color: '#28a745', fontWeight: 'bold'}}>
                                                        {gciCalculator.dealsNeeded} deals
                                                    </span>
                                                </div>
                                                <div style={{marginBottom: '10px'}}>
                                                    <strong>Deals per Month:</strong><br/>
                                                    <span style={{fontSize: '1.2em', color: '#17a2b8'}}>
                                                        {Math.ceil(gciCalculator.dealsNeeded / 12)} deals/month
                                                    </span>
                                                </div>
                                                <div>
                                                    <strong>Deals per Quarter:</strong><br/>
                                                    <span style={{fontSize: '1.2em', color: '#6f42c1'}}>
                                                        {Math.ceil(gciCalculator.dealsNeeded / 4)} deals/quarter
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            
                            <div className="form-section">
                                <h3>GCI Progress Tracking</h3>
                                <div className="progress-bar">
                                    <div className="progress-fill" style={{width: `${Math.min((totalCommission / gciCalculator.desiredGCI) * 100, 100)}%`}}></div>
                                </div>
                                <p style={{textAlign: 'center', marginTop: '10px'}}>
                                    {Math.round((totalCommission / gciCalculator.desiredGCI) * 100)}% Complete - ${totalCommission.toLocaleString()} of ${gciCalculator.desiredGCI.toLocaleString()} goal
                                </p>
                                
                                <div style={{marginTop: '20px', display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '15px'}}>
                                    <div style={{textAlign: 'center', padding: '15px', backgroundColor: '#e3f2fd', borderRadius: '8px'}}>
                                        <h5>Deals Closed</h5>
                                        <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#1976d2'}}>
                                            {closedDeals.length}
                                        </div>
                                        <small>of {gciCalculator.dealsNeeded} needed</small>
                                    </div>
                                    <div style={{textAlign: 'center', padding: '15px', backgroundColor: '#f3e5f5', borderRadius: '8px'}}>
                                        <h5>Deals Remaining</h5>
                                        <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#7b1fa2'}}>
                                            {Math.max(0, gciCalculator.dealsNeeded - closedDeals.length)}
                                        </div>
                                        <small>to reach goal</small>
                                    </div>
                                    <div style={{textAlign: 'center', padding: '15px', backgroundColor: '#e8f5e8', borderRadius: '8px'}}>
                                        <h5>Monthly Pace</h5>
                                        <div style={{fontSize: '1.5em', fontWeight: 'bold', color: '#388e3c'}}>
                                            {Math.ceil(Math.max(0, gciCalculator.dealsNeeded - closedDeals.length) / Math.max(1, 12 - new Date().getMonth()))}
                                        </div>
                                        <small>deals/month needed</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Performance Tab */}
                    {activeTab === 'performance' && (
                        <div className="tab-content">
                            <h2>Performance Analytics & Efficiency</h2>
                            
                            {/* Overall Efficiency Score */}
                            <div style={{marginBottom: '30px', textAlign: 'center', padding: '30px', backgroundColor: '#f8f9fa', borderRadius: '12px', border: '2px solid #e9ecef'}}>
                                <h3 style={{margin: '0 0 20px 0', color: '#495057'}}>Overall Efficiency Score</h3>
                                <div style={{fontSize: '4em', fontWeight: 'bold', margin: '0 0 15px 0', color: (() => {
                                    const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                    const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                    const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                    const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                    const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                    const daysWithData = Object.keys(dailyData).length;
                                    
                                    if (daysWithData === 0) return '#6c757d';
                                    
                                    // Calculate efficiency metrics
                                    const callEfficiency = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                    const appointmentConversion = totalCallsAnswered > 0 ? (totalAppointments / totalCallsAnswered) * 100 : 0;
                                    const productivityRate = totalHours > 0 ? (totalCallsMade + totalAppointments + totalOffers) / totalHours : 0;
                                    const goalAchievement = (() => {
                                        if (!goalsLocked || daysWithData === 0) return 0;
                                        
                                        // Count how many goals are actually set (> 0)
                                        const activeGoals = [];
                                        if (goals.hoursWorked > 0) activeGoals.push('hoursWorked');
                                        if (goals.dailyCalls > 0) activeGoals.push('dailyCalls');
                                        if (goals.appointmentsSet > 0) activeGoals.push('appointmentsSet');
                                        if (goals.offersWritten > 0) activeGoals.push('offersWritten');
                                        
                                        // If no goals are set, return 100% achievement
                                        if (activeGoals.length === 0) return 100;
                                        
                                        let totalScore = 0;
                                        let scoredDays = 0;
                                        const scorePerGoal = 100 / activeGoals.length; // Distribute points among active goals
                                        
                                        Object.values(dailyData).forEach(day => {
                                            let dayScore = 0;
                                            let maxDayScore = 0;
                                            
                                            activeGoals.forEach(goalType => {
                                                if (day[goalType] !== undefined) {
                                                    const goalValue = goalType === 'appointmentsSet' ? goals.appointmentsSet : 
                                                                    goalType === 'dailyCalls' ? goals.dailyCalls :
                                                                    goalType === 'hoursWorked' ? goals.hoursWorked :
                                                                    goals.offersWritten;
                                                    
                                                    dayScore += Math.min(day[goalType] / goalValue, 1) * scorePerGoal;
                                                    maxDayScore += scorePerGoal;
                                                }
                                            });
                                            
                                            if (maxDayScore > 0) {
                                                totalScore += (dayScore / maxDayScore) * 100;
                                                scoredDays++;
                                            }
                                        });
                                        return scoredDays > 0 ? totalScore / scoredDays : 100;
                                    })();
                                    
                                    // Overall efficiency calculation (excluding appointment conversion)
                                    // Focus on calls made, productivity, and goal achievement only
                                    const overallEfficiency = (Math.min(productivityRate * 10, 100) * 0.4 + goalAchievement * 0.6);
                                    
                                    if (overallEfficiency >= 80) return '#28a745';
                                    if (overallEfficiency >= 60) return '#ffc107';
                                    return '#dc3545';
                                })()}}>
                                    {(() => {
                                        const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                        const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                        const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                        const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                        const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                        const daysWithData = Object.keys(dailyData).length;
                                        
                                        if (daysWithData === 0) return '0%';
                                        
                                        const callEfficiency = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                        const appointmentConversion = totalCallsAnswered > 0 ? (totalAppointments / totalCallsAnswered) * 100 : 0;
                                        const productivityRate = totalHours > 0 ? (totalCallsMade + totalAppointments + totalOffers) / totalHours : 0;
                                        const goalAchievement = (() => {
                                            if (!goalsLocked || daysWithData === 0) return 0;
                                            
                                            // Count how many goals are actually set (> 0)
                                            const activeGoals = [];
                                            if (goals.hoursWorked > 0) activeGoals.push('hoursWorked');
                                            if (goals.dailyCalls > 0) activeGoals.push('dailyCalls');
                                            if (goals.appointmentsSet > 0) activeGoals.push('appointmentsSet');
                                            if (goals.offersWritten > 0) activeGoals.push('offersWritten');
                                            
                                            // If no goals are set, return 100% achievement
                                            if (activeGoals.length === 0) return 100;
                                            
                                            let totalScore = 0;
                                            let scoredDays = 0;
                                            const scorePerGoal = 100 / activeGoals.length; // Distribute points among active goals
                                            
                                            Object.values(dailyData).forEach(day => {
                                                let dayScore = 0;
                                                let maxDayScore = 0;
                                                
                                                activeGoals.forEach(goalType => {
                                                    if (day[goalType] !== undefined) {
                                                        const goalValue = goalType === 'appointmentsSet' ? goals.appointmentsSet : 
                                                                        goalType === 'dailyCalls' ? goals.dailyCalls :
                                                                        goalType === 'hoursWorked' ? goals.hoursWorked :
                                                                        goals.offersWritten;
                                                        
                                                        dayScore += Math.min(day[goalType] / goalValue, 1) * scorePerGoal;
                                                        maxDayScore += scorePerGoal;
                                                    }
                                                });
                                                
                                                if (maxDayScore > 0) {
                                                    totalScore += (dayScore / maxDayScore) * 100;
                                                    scoredDays++;
                                                }
                                            });
                                            return scoredDays > 0 ? totalScore / scoredDays : 100;
                                        })();
                                        
                                        // Overall efficiency calculation (excluding appointment conversion)
                                        // Focus on calls made, productivity, and goal achievement only
                                        const overallEfficiency = (Math.min(productivityRate * 10, 100) * 0.4 + goalAchievement * 0.6);
                                        return `${Math.round(overallEfficiency)}%`;
                                    })()}
                                </div>
                                <div style={{fontSize: '1.1em', color: '#6c757d', marginBottom: '20px'}}>
                                    Based on productivity and goal achievement
                                </div>
                                <div style={{display: 'flex', justifyContent: 'center', gap: '30px', fontSize: '0.9em'}}>
                                    <div><strong>Excellent:</strong> 80%+</div>
                                    <div><strong>Good:</strong> 60-79%</div>
                                    <div><strong>Needs Improvement:</strong> &lt;60%</div>
                                </div>
                            </div>

                            {/* Daily Efficiency Score */}
                            <div style={{marginBottom: '30px'}}>
                                <h3 style={{textAlign: 'center', margin: '0 0 20px 0', color: '#495057'}}>ðŸ“Š Daily Efficiency Scores</h3>
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))',
                                    gap: '15px',
                                    marginBottom: '20px'
                                }}>
                                    {Object.entries(dailyData)
                                        .sort(([a], [b]) => new Date(b) - new Date(a))
                                        .slice(0, 7) // Show last 7 days
                                        .map(([date, data]) => {
                                            // Calculate daily efficiency score
                                            const callsMade = data.callsMade || 0;
                                            const callsAnswered = data.callsAnswered || 0;
                                            const appointments = data.appointmentsSet || 0;
                                            const offers = data.offersWritten || 0;
                                            const hours = data.hoursWorked || 0;
                                            
                                            // Call efficiency (0-30 points)
                                            const callEfficiency = callsMade > 0 ? (callsAnswered / callsMade) * 100 : 0;
                                            const callPoints = Math.min(callEfficiency, 30);
                                            
                                            // Productivity rate (0-35 points)
                                            const productivityRate = hours > 0 ? (callsMade + appointments + offers) / hours : 0;
                                            const productivityPoints = Math.min(productivityRate * 4, 35);
                                            
                                            // Goal achievement (0-35 points)
                                            let goalPoints = 0;
                                            if (goalsLocked) {
                                                const activeGoals = [];
                                                if (goals.hoursWorked > 0) activeGoals.push({type: 'hoursWorked', target: goals.hoursWorked, actual: hours});
                                                if (goals.dailyCalls > 0) activeGoals.push({type: 'dailyCalls', target: goals.dailyCalls, actual: callsMade});
                                                if (goals.appointmentsSet > 0) activeGoals.push({type: 'appointmentsSet', target: goals.appointmentsSet, actual: appointments});
                                                if (goals.offersWritten > 0) activeGoals.push({type: 'offersWritten', target: goals.offersWritten, actual: offers});
                                                
                                                if (activeGoals.length > 0) {
                                                    const pointsPerGoal = 35 / activeGoals.length;
                                                    goalPoints = activeGoals.reduce((sum, goal) => {
                                                        const achievementRate = Math.min(goal.actual / goal.target, 1);
                                                        return sum + (achievementRate * pointsPerGoal);
                                                    }, 0);
                                                } else {
                                                    goalPoints = 35; // Full points if no goals set
                                                }
                                            }
                                            
                                            const dailyScore = callPoints + productivityPoints + goalPoints;
                                            const scoreColor = dailyScore >= 80 ? '#28a745' : 
                                                            dailyScore >= 60 ? '#ffc107' : '#dc3545';
                                            
                                            return (
                                                <div key={date} style={{
                                                    background: 'rgba(255,255,255,0.95)',
                                                    backdropFilter: 'blur(10px)',
                                                    border: '1px solid rgba(255,255,255,0.2)',
                                                    borderRadius: '12px',
                                                    padding: '15px',
                                                    textAlign: 'center',
                                                    boxShadow: '0 4px 20px rgba(0,0,0,0.08)',
                                                    transition: 'all 0.3s ease',
                                                    position: 'relative',
                                                    overflow: 'hidden'
                                                }}>
                                                    {/* Score gradient bar */}
                                                    <div style={{
                                                        position: 'absolute',
                                                        top: 0,
                                                        left: 0,
                                                        right: 0,
                                                        height: '4px',
                                                        background: `linear-gradient(90deg, ${scoreColor}, ${scoreColor}aa)`
                                                    }}></div>
                                                    
                                                    <div style={{fontSize: '12px', fontWeight: 'bold', color: '#666', marginBottom: '8px'}}>
                                                        {new Date(date).toLocaleDateString('en-US', {weekday: 'short', month: 'short', day: 'numeric'})}
                                                    </div>
                                                    <div style={{fontSize: '32px', fontWeight: 'bold', color: scoreColor, marginBottom: '8px'}}>
                                                        {Math.round(dailyScore)}
                                                    </div>
                                                    <div style={{fontSize: '11px', color: '#888'}}>
                                                        <div>ðŸ“ž {Math.round(callPoints)}pts</div>
                                                        <div>âš¡ {Math.round(productivityPoints)}pts</div>
                                                        <div>ðŸŽ¯ {Math.round(goalPoints)}pts</div>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                </div>
                                <div style={{textAlign: 'center', fontSize: '0.85em', color: '#666'}}>
                                    <strong>Scoring:</strong> Call Efficiency (30pts) + Productivity Rate (35pts) + Goal Achievement (35pts) = 100pts total
                                </div>
                            </div>

                            {/* Key Efficiency Metrics */}
                            <div className="grid">
                                <div className="tile">
                                    <h4>Call Efficiency</h4>
                                    <p style={{color: (() => {
                                        const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                        const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                        const rate = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                        return rate >= 30 ? '#28a745' : rate >= 20 ? '#ffc107' : '#dc3545';
                                    })()}}>
                                        {(() => {
                                            const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                            const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                            return totalCallsMade > 0 ? `${Math.round((totalCallsAnswered / totalCallsMade) * 100)}%` : '0%';
                                        })()}
                                    </p>
                                    <small>
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0)} answered / 
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0)} made
                                        <br/>Industry benchmark: 20-30%
                                    </small>
                                </div>
                                
                                <div className="tile">
                                    <h4>Appointment Conversion</h4>
                                    <p style={{color: (() => {
                                        const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                        const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                        const rate = totalCallsAnswered > 0 ? (totalAppointments / totalCallsAnswered) * 100 : 0;
                                        return rate >= 25 ? '#28a745' : rate >= 15 ? '#ffc107' : '#dc3545';
                                    })()}}>
                                        {(() => {
                                            const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                            const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                            return totalCallsAnswered > 0 ? `${Math.round((totalAppointments / totalCallsAnswered) * 100)}%` : '0%';
                                        })()}
                                    </p>
                                    <small>
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0)} appointments / 
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0)} answered calls
                                        <br/>Industry benchmark: 15-25%
                                    </small>
                                </div>
                                
                                <div className="tile">
                                    <h4>Hourly Productivity</h4>
                                    <p style={{color: (() => {
                                        const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                        const totalActivities = Object.values(dailyData).reduce((sum, day) => 
                                            sum + (day.callsMade || 0) + (day.appointmentsSet || 0) + (day.offersWritten || 0), 0);
                                        const rate = totalHours > 0 ? totalActivities / totalHours : 0;
                                        return rate >= 8 ? '#28a745' : rate >= 5 ? '#ffc107' : '#dc3545';
                                    })()}}>
                                        {(() => {
                                            const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                            const totalActivities = Object.values(dailyData).reduce((sum, day) => 
                                                sum + (day.callsMade || 0) + (day.appointmentsSet || 0) + (day.offersWritten || 0), 0);
                                            return totalHours > 0 ? `${Math.round(totalActivities / totalHours * 10) / 10}` : '0';
                                        })()} activities/hr
                                    </p>
                                    <small>
                                        Total productive activities per hour
                                        <br/>Target: 5-8 activities/hour
                                    </small>
                                </div>
                                
                                <div className="tile">
                                    <h4>Deal Pipeline Health</h4>
                                    <p style={{color: (() => {
                                        const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                        const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                        const ratio = totalAppointments > 0 ? (totalOffers / totalAppointments) * 100 : 0;
                                        return ratio >= 50 ? '#28a745' : ratio >= 30 ? '#ffc107' : '#dc3545';
                                    })()}}>
                                        {(() => {
                                            const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                            const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                            return totalAppointments > 0 ? `${Math.round((totalOffers / totalAppointments) * 100)}%` : '0%';
                                        })()}
                                    </p>
                                    <small>
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0)} offers / 
                                        {Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0)} appointments
                                        <br/>Target: 30-50% offer ratio
                                    </small>
                                </div>
                            </div>

                            {/* Improvement Suggestions */}
                            <div className="form-section">
                                <h3>ðŸŽ¯ Performance Improvement Suggestions</h3>
                                <div style={{display: 'grid', gap: '20px'}}>
                                    {(() => {
                                        const suggestions = [];
                                        const totalCallsMade = Object.values(dailyData).reduce((sum, day) => sum + (day.callsMade || 0), 0);
                                        const totalCallsAnswered = Object.values(dailyData).reduce((sum, day) => sum + (day.callsAnswered || 0), 0);
                                        const totalAppointments = Object.values(dailyData).reduce((sum, day) => sum + (day.appointmentsSet || 0), 0);
                                        const totalOffers = Object.values(dailyData).reduce((sum, day) => sum + (day.offersWritten || 0), 0);
                                        const totalHours = Object.values(dailyData).reduce((sum, day) => sum + (day.hoursWorked || 0), 0);
                                        const daysWithData = Object.keys(dailyData).length;

                                        // Call efficiency suggestions
                                        const callEfficiency = totalCallsMade > 0 ? (totalCallsAnswered / totalCallsMade) * 100 : 0;
                                        if (callEfficiency < 20) {
                                            suggestions.push({
                                                icon: 'ðŸ“ž',
                                                priority: 'High',
                                                title: 'Improve Call Connection Rate',
                                                description: `Your call efficiency is ${Math.round(callEfficiency)}%, below the 20-30% industry standard.`,
                                                actions: [
                                                    'Call during optimal hours (9-11 AM, 2-4 PM)',
                                                    'Use local phone numbers for better answer rates',
                                                    'Research prospects before calling for better timing',
                                                    'Consider using voice drops for initial contact'
                                                ]
                                            });
                                        }

                                        // Appointment conversion suggestions
                                        const appointmentConversion = totalCallsAnswered > 0 ? (totalAppointments / totalCallsAnswered) * 100 : 0;
                                        if (appointmentConversion < 15) {
                                            suggestions.push({
                                                icon: 'ðŸ“…',
                                                priority: 'High',
                                                title: 'Boost Appointment Setting Skills',
                                                description: `Your appointment conversion is ${Math.round(appointmentConversion)}%, below the 15-25% benchmark.`,
                                                actions: [
                                                    'Use assumptive closing: "What works better, Tuesday or Wednesday?"',
                                                    'Create urgency with market conditions',
                                                    'Offer virtual appointments as alternatives',
                                                    'Practice objection handling scripts'
                                                ]
                                            });
                                        }

                                        // Productivity suggestions
                                        const productivityRate = totalHours > 0 ? (totalCallsMade + totalAppointments + totalOffers) / totalHours : 0;
                                        if (productivityRate < 5) {
                                            suggestions.push({
                                                icon: 'âš¡',
                                                priority: 'Medium',
                                                title: 'Increase Hourly Productivity',
                                                description: `You're averaging ${Math.round(productivityRate * 10) / 10} activities per hour. Target 5-8 activities/hour.`,
                                                actions: [
                                                    'Use CRM automation for lead management',
                                                    'Batch similar activities together',
                                                    'Set hourly activity goals',
                                                    'Eliminate non-productive activities during work hours'
                                                ]
                                            });
                                        }

                                        // Goal achievement suggestions
                                        if (goalsLocked && daysWithData > 0) {
                                            const missedGoalDays = Object.values(dailyData).filter(day => 
                                                (day.callsMade || 0) < (goals.dailyCalls || 0) ||
                                                (day.hoursWorked || 0) < (goals.hoursWorked || 8)
                                            ).length;
                                            
                                            if (missedGoalDays > daysWithData * 0.3) {
                                                suggestions.push({
                                                    icon: 'ðŸŽ¯',
                                                    priority: 'Medium',
                                                    title: 'Improve Goal Consistency',
                                                    description: `You've missed daily goals on ${Math.round((missedGoalDays / daysWithData) * 100)}% of tracked days.`,
                                                    actions: [
                                                        'Break daily goals into hourly targets',
                                                        'Set calendar reminders for activity check-ins',
                                                        'Review and adjust goals if consistently unmet',
                                                        'Track progress throughout the day, not just at end'
                                                    ]
                                                });
                                            }
                                        }

                                        // Deal pipeline suggestions
                                        const offerRatio = totalAppointments > 0 ? (totalOffers / totalAppointments) * 100 : 0;
                                        if (offerRatio < 30 && totalAppointments > 5) {
                                            suggestions.push({
                                                icon: 'ðŸ“',
                                                priority: 'Medium',
                                                title: 'Strengthen Deal Pipeline',
                                                description: `Only ${Math.round(offerRatio)}% of appointments result in offers. Target 30-50%.`,
                                                actions: [
                                                    'Improve pre-qualification during appointment setting',
                                                    'Use consultation scripts to uncover motivation',
                                                    'Follow up with appointment no-shows',
                                                    'Practice presentation and closing techniques'
                                                ]
                                            });
                                        }

                                        // If no major issues, provide optimization suggestions
                                        if (suggestions.length === 0) {
                                            suggestions.push({
                                                icon: 'ðŸš€',
                                                priority: 'Optimization',
                                                title: 'Excellent Performance - Optimization Tips',
                                                description: 'Your metrics are strong! Here are ways to reach the next level:',
                                                actions: [
                                                    'Implement A/B testing on scripts and timing',
                                                    'Focus on higher-value prospects and areas',
                                                    'Mentor newer agents to build your network',
                                                    'Develop specialized expertise in luxury or investment properties'
                                                ]
                                            });
                                        }

                                        return suggestions.map((suggestion, index) => (
                                            <div key={index} style={{
                                                padding: '20px',
                                                backgroundColor: suggestion.priority === 'High' ? '#fff5f5' : 
                                                                 suggestion.priority === 'Medium' ? '#fffaf0' : '#f0f9ff',
                                                border: `2px solid ${suggestion.priority === 'High' ? '#feb2b2' : 
                                                                     suggestion.priority === 'Medium' ? '#fbd38d' : '#93c5fd'}`,
                                                borderRadius: '8px'
                                            }}>
                                                <div style={{display: 'flex', alignItems: 'center', marginBottom: '10px'}}>
                                                    <span style={{fontSize: '1.5em', marginRight: '10px'}}>{suggestion.icon}</span>
                                                    <div>
                                                        <span style={{
                                                            fontSize: '0.8em',
                                                            padding: '2px 8px',
                                                            borderRadius: '12px',
                                                            backgroundColor: suggestion.priority === 'High' ? '#dc3545' : 
                                                                           suggestion.priority === 'Medium' ? '#ffc107' : '#28a745',
                                                            color: 'white',
                                                            marginRight: '10px'
                                                        }}>
                                                            {suggestion.priority.toUpperCase()}
                                                        </span>
                                                        <strong>{suggestion.title}</strong>
                                                    </div>
                                                </div>
                                                <p style={{margin: '0 0 15px 0', color: '#666'}}>{suggestion.description}</p>
                                                <div style={{fontSize: '0.9em'}}>
                                                    <strong>Action Steps:</strong>
                                                    <ul style={{margin: '5px 0 0 20px', paddingLeft: '0'}}>
                                                        {suggestion.actions.map((action, i) => (
                                                            <li key={i} style={{marginBottom: '5px'}}>{action}</li>
                                                        ))}
                                                    </ul>
                                                </div>
                                            </div>
                                        ));
                                    })()}
                                </div>
                            </div>

                            {!goalsLocked && (
                                <div style={{marginTop: '20px', padding: '15px', background: '#fff3cd', border: '1px solid #ffeaa7', borderRadius: '8px'}}>
                                    <h4 style={{color: '#856404'}}>ðŸ”“ Lock Your Goals for Enhanced Analytics</h4>
                                    <p style={{color: '#856404', margin: '10px 0 0 0'}}>
                                        Lock your goals in the Goals tab to unlock advanced performance comparisons and personalized improvement suggestions.
                                    </p>
                                </div>
                            )}
                            
                            {Object.keys(dailyData).length === 0 && (
                                <div style={{marginTop: '20px', padding: '15px', background: '#d1ecf1', border: '1px solid #b8daff', borderRadius: '8px'}}>
                                    <h4 style={{color: '#0c5460'}}>ðŸ“Š Start Tracking for Insights</h4>
                                    <p style={{color: '#0c5460', margin: '10px 0 0 0'}}>
                                        Enter your daily activities in the Goals tab to see comprehensive performance analytics and personalized improvement suggestions here.
                                    </p>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
